<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>JSON-LD 1.0</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />

<!--  
  === NOTA BENE ===
  For the three scripts below, if your spec resides on dev.w3 you can check them
  out in the same tree and use relative links so that they'll work offline,
   -->



<style>
.diff { font-weight:bold; color:#0a3; }
ol.algorithm.update { margin-left: 2em; }
ol.algorithm.update>li { list-style-type: none; }
ol.algorithm.update>li>span.list-number {
  display:block;
  float: left; 
  margin-left: -3.5em;
}
</style>
<style type="text/css">
/*****************************************************************
 * ReSpec CSS
 * Robin Berjon (robin at berjon dot com)
 * v0.05 - 2009-07-31
 *****************************************************************/


/* --- INLINES --- */
em.rfc2119 { 
    text-transform:     lowercase;
    font-variant:       small-caps;
    font-style:         normal;
    color:              #900;
}

h1 acronym, h2 acronym, h3 acronym, h4 acronym, h5 acronym, h6 acronym, a acronym,
h1 abbr, h2 abbr, h3 abbr, h4 abbr, h5 abbr, h6 abbr, a abbr {
    border: none;
}

dfn {
    font-weight:    bold;
}

a.internalDFN {
    color:  inherit;
    border-bottom:  1px solid #99c;
    text-decoration:    none;
}

a.externalDFN {
    color:  inherit;
    border-bottom:  1px dotted #ccc;
    text-decoration:    none;
}

a.bibref {
    text-decoration:    none;
}

code {
    color:  #ff4500;
}


/* --- WEB IDL --- */
pre.idl {
    border-top: 1px solid #90b8de;
    border-bottom: 1px solid #90b8de;
    padding:    1em;
    line-height:    120%;
}

pre.idl::before {
    content:    "WebIDL";
    display:    block;
    width:      150px;
    background: #90b8de;
    color:  #fff;
    font-family:    initial;
    padding:    3px;
    font-weight:    bold;
    margin: -1em 0 1em -1em;
}

.idlType {
    color:  #ff4500;
    font-weight:    bold;
    text-decoration:    none;
}

/*.idlModule*/
/*.idlModuleID*/
/*.idlInterface*/
.idlInterfaceID {
    font-weight:    bold;
    color:  #005a9c;
}

.idlSuperclass {
    font-style: italic;
    color:  #005a9c;
}

/*.idlAttribute*/
.idlAttrType, .idlFieldType {
    color:  #005a9c;
}
.idlAttrName, .idlFieldName {
    color:  #ff4500;
}
.idlAttrName a, .idlFieldName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
}

/*.idlMethod*/
.idlMethType {
    color:  #005a9c;
}
.idlMethName {
    color:  #ff4500;
}
.idlMethName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
}

/*.idlParam*/
.idlParamType {
    color:  #005a9c;
}
.idlParamName {
    font-style: italic;
}

.extAttr {
    color:  #666;
}

/*.idlConst*/
.idlConstType {
    color:  #005a9c;
}
.idlConstName {
    color:  #ff4500;
}
.idlConstName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
}

/*.idlException*/
.idlExceptionID {
    font-weight:    bold;
    color:  #c00;
}

.idlTypedefID, .idlTypedefType {
    color:  #005a9c;
}

.idlRaises, .idlRaises a.idlType, .idlRaises a.idlType code, .excName a, .excName a code {
    color:  #c00;
    font-weight:    normal;
}

.excName a {
    font-family:    monospace;
}

.idlRaises a.idlType, .excName a.idlType {
    border-bottom:  1px dotted #c00;
}

.excGetSetTrue, .excGetSetFalse, .prmNullTrue, .prmNullFalse, .prmOptTrue, .prmOptFalse {
    width:  45px;
    text-align: center;
}
.excGetSetTrue, .prmNullTrue, .prmOptTrue { color:  #0c0; }
.excGetSetFalse, .prmNullFalse, .prmOptFalse { color:  #c00; }

.idlImplements a {
    font-weight:    bold;
}

dl.attributes, dl.methods, dl.constants, dl.fields {
    margin-left:    2em;
}

.attributes dt, .methods dt, .constants dt, .fields dt {
    font-weight:    normal;
}

.attributes dt code, .methods dt code, .constants dt code, .fields dt code {
    font-weight:    bold;
    color:  #000;
    font-family:    monospace;
}

.attributes dt code, .fields dt code {
    background:  #ffffd2;
}

.attributes dt .idlAttrType code, .fields dt .idlFieldType code {
    color:  #005a9c;
    background:  transparent;
    font-family:    inherit;
    font-weight:    normal;
    font-style: italic;
}

.methods dt code {
    background:  #d9e6f8;
}

.constants dt code {
    background:  #ddffd2;
}

.attributes dd, .methods dd, .constants dd, .fields dd {
    margin-bottom:  1em;
}

table.parameters, table.exceptions {
    border-spacing: 0;
    border-collapse:    collapse;
    margin: 0.5em 0;
    width:  100%;
}
table.parameters { border-bottom:  1px solid #90b8de; }
table.exceptions { border-bottom:  1px solid #deb890; }

.parameters th, .exceptions th {
    color:  #fff;
    padding:    3px 5px;
    text-align: left;
    font-family:    initial;
    font-weight:    normal;
    text-shadow:    #666 1px 1px 0;
}
.parameters th { background: #90b8de; }
.exceptions th { background: #deb890; }

.parameters td, .exceptions td {
    padding:    3px 10px;
    border-top: 1px solid #ddd;
    vertical-align: top;
}

.parameters tr:first-child td, .exceptions tr:first-child td {
    border-top: none;
}

.parameters td.prmName, .exceptions td.excName, .exceptions td.excCodeName {
    width:  100px;
}

.parameters td.prmType {
    width:  120px;
}

table.exceptions table {
    border-spacing: 0;
    border-collapse:    collapse;
    width:  100%;
}

/* --- TOC --- */
.toc a {
    text-decoration:    none;
}

a .secno {
    color:  #000;
}

/* --- TABLE --- */
table.simple {
    border-spacing: 0;
    border-collapse:    collapse;
    border-bottom:  3px solid #005a9c;
}

.simple th {
    background: #005a9c;
    color:  #fff;
    padding:    3px 5px;
    text-align: left;
}

.simple th[scope="row"] {
    background: inherit;
    color:  inherit;
    border-top: 1px solid #ddd;
}

.simple td {
    padding:    3px 10px;
    border-top: 1px solid #ddd;
}

.simple tr:nth-child(even) {
    background: #f0f6ff;
}

/* --- DL --- */
.section dd > p:first-child {
    margin-top: 0;
}

.section dd > p:last-child {
    margin-bottom: 0;
}

.section dd {
    margin-bottom:  1em;
}

.section dl.attrs dd, .section dl.eldef dd {
    margin-bottom:  0;
}

/* --- EXAMPLES --- */
pre.example {
    border-top: 1px solid #ff4500;
    border-bottom: 1px solid #ff4500;
    padding:    1em;
    margin-top: 1em;
}

pre.example::before {
    content:    "Example";
    display:    block;
    width:      150px;
    background: #ff4500;
    color:  #fff;
    font-family:    initial;
    padding:    3px;
    font-weight:    bold;
    margin: -1em 0 1em -1em;
}

/* --- EDITORIAL NOTES --- */
.issue {
    padding:    1em;
    margin: 1em 0em 0em;
    border: 1px solid #f00;
    background: #ffc;
}

.issue::before {
    content:    "Issue";
    display:    block;
    width:  150px;
    margin: -1.5em 0 0.5em 0;
    font-weight:    bold;
    border: 1px solid #f00;
    background: #fff;
    padding:    3px 1em;
}

.note {
    margin: 1em 0em 0em;
    padding:    1em;
    border: 2px solid #cff6d9;
    background: #e2fff0;
}

.note::before {
    content:    "Note";
    display:    block;
    width:  150px;
    margin: -1.5em 0 0.5em 0;
    font-weight:    bold;
    border: 1px solid #cff6d9;
    background: #fff;
    padding:    3px 1em;
}

/* --- Best Practices --- */
div.practice {
    border: solid #bebebe 1px;
    margin: 2em 1em 1em 2em;
}

span.practicelab {
    margin: 1.5em 0.5em 1em 1em;
    font-weight: bold;
    font-style: italic;
}

span.practicelab   { background: #dfffff; }

span.practicelab {
    position: relative;
    padding: 0 0.5em;
    top: -1.5em;
}

p.practicedesc {
    margin: 1.5em 0.5em 1em 1em;
}

@media screen {
    p.practicedesc {
        position: relative;
        top: -2em;
        padding: 0;
        margin: 1.5em 0.5em -1em 1em;
}

/* --- SYNTAX HIGHLIGHTING --- */
pre.sh_sourceCode {
  background-color: white;
  color: black;
  font-style: normal;
  font-weight: normal;
}

pre.sh_sourceCode .sh_keyword { color: #005a9c; font-weight: bold; }           /* language keywords */
pre.sh_sourceCode .sh_type { color: #666; }                            /* basic types */
pre.sh_sourceCode .sh_usertype { color: teal; }                             /* user defined types */
pre.sh_sourceCode .sh_string { color: red; font-family: monospace; }        /* strings and chars */
pre.sh_sourceCode .sh_regexp { color: orange; font-family: monospace; }     /* regular expressions */
pre.sh_sourceCode .sh_specialchar { color: 	#ffc0cb; font-family: monospace; }  /* e.g., \n, \t, \\ */
pre.sh_sourceCode .sh_comment { color: #A52A2A; font-style: italic; }         /* comments */
pre.sh_sourceCode .sh_number { color: purple; }                             /* literal numbers */
pre.sh_sourceCode .sh_preproc { color: #00008B; font-weight: bold; }       /* e.g., #include, import */
pre.sh_sourceCode .sh_symbol { color: blue; }                            /* e.g., *, + */
pre.sh_sourceCode .sh_function { color: black; font-weight: bold; }         /* function calls and declarations */
pre.sh_sourceCode .sh_cbracket { color: red; }                              /* block brackets (e.g., {, }) */
pre.sh_sourceCode .sh_todo { font-weight: bold; background-color: #00FFFF; }   /* TODO and FIXME */

/* Predefined variables and functions (for instance glsl) */
pre.sh_sourceCode .sh_predef_var { color: #00008B; }
pre.sh_sourceCode .sh_predef_func { color: #00008B; font-weight: bold; }

/* for OOP */
pre.sh_sourceCode .sh_classname { color: teal; }

/* line numbers (not yet implemented) */
pre.sh_sourceCode .sh_linenum { display: none; }

/* Internet related */
pre.sh_sourceCode .sh_url { color: blue; text-decoration: underline; font-family: monospace; }

/* for ChangeLog and Log files */
pre.sh_sourceCode .sh_date { color: blue; font-weight: bold; }
pre.sh_sourceCode .sh_time, pre.sh_sourceCode .sh_file { color: #00008B; font-weight: bold; }
pre.sh_sourceCode .sh_ip, pre.sh_sourceCode .sh_name { color: #006400; }

/* for Prolog, Perl... */
pre.sh_sourceCode .sh_variable { color: #006400; }

/* for LaTeX */
pre.sh_sourceCode .sh_italics { color: #006400; font-style: italic; }
pre.sh_sourceCode .sh_bold { color: #006400; font-weight: bold; }
pre.sh_sourceCode .sh_underline { color: #006400; text-decoration: underline; }
pre.sh_sourceCode .sh_fixed { color: green; font-family: monospace; }
pre.sh_sourceCode .sh_argument { color: #006400; }
pre.sh_sourceCode .sh_optionalargument { color: purple; }
pre.sh_sourceCode .sh_math { color: orange; }
pre.sh_sourceCode .sh_bibtex { color: blue; }

/* for diffs */
pre.sh_sourceCode .sh_oldfile { color: orange; }
pre.sh_sourceCode .sh_newfile { color: #006400; }
pre.sh_sourceCode .sh_difflines { color: blue; }

/* for css */
pre.sh_sourceCode .sh_selector { color: purple; }
pre.sh_sourceCode .sh_property { color: blue; }
pre.sh_sourceCode .sh_value { color: #006400; font-style: italic; }

/* other */
pre.sh_sourceCode .sh_section { color: black; font-weight: bold; }
pre.sh_sourceCode .sh_paren { color: red; }
pre.sh_sourceCode .sh_attribute { color: #006400; }

</style><style type="text/css">ol.algorithm { counter-reset:numsection; list-style-type: none; }
ol.algorithm li { margin: 0.5em 0; }
ol.algorithm li:before { font-weight: bold; counter-increment: numsection; content: counters(numsection, ".") ") "; }

</style><link href="http://www.w3.org/StyleSheets/TR/w3c-unofficial" rel="stylesheet" type="text/css" charset="utf-8" /><style type='text/css'>
.diff-old-a {
  font-size: smaller;
  color: red;
}

.diff-new { background-color: yellow; }
.diff-chg { background-color: lime; }
.diff-new:before,
.diff-new:after
    { content: "\2191" }
.diff-chg:before, .diff-chg:after
    { content: "\2195" }
.diff-old { text-decoration: line-through; background-color: #FBB; }
.diff-old:before,
.diff-old:after
    { content: "\2193" }
:focus { border: thin red solid}
</style>
</head>


<body style="display: inherit; ">
<div class="head">
<p>
</p>
<h1 class="title" id="title">
JSON-LD
1.0
</h1>
<h2 id="subtitle">
A
Context-based
JSON
Serialization
for
Linking
Data
</h2>
<h2 id="unofficial-draft-17-august-2011">
Unofficial
Draft
<del class="diff-old">08
</del>
<ins class="diff-chg">17
</ins>
August
2011
</h2>
<dl>
<dt>
Editors:
</dt>
<dd>
<a href="http://manu.sporny.org/">
Manu
Sporny
</a>,
<a href="http://digitalbazaar.com/">
Digital
Bazaar
</a>
</dd>
<dd>
<a href="http://greggkellogg.net/">
Gregg
Kellogg
</a>,
Kellogg
Associates
</dd>
<dd>
<a href="http://digitalbazaar.com/">
<ins class="diff-new">Dave
Longley
</ins></a>,<a href="http://digitalbazaar.com/"><ins class="diff-new">
Digital
Bazaar
</ins></a></dd>
<dt>
Authors:
</dt>
<dd>
<a href="http://digitalbazaar.com/">
Manu
Sporny
</a>,
<a href="http://digitalbazaar.com/">
Digital
Bazaar
</a>
</dd>
<dd>
<a href="http://greggkellogg.net/">
Gregg
Kellogg
</a>,
Kellogg
Associates
</dd>
<dd>
<a href="http://digitalbazaar.com/">
Dave
Longley
</a>,
<a href="http://digitalbazaar.com/">
Digital
Bazaar
</a>
</dd>
<dd>
<a href="http://webbackplane.com/">
Mark
Birbeck
</a>,
<a href="http://webbackplane.com/">
Backplane
Ltd.
</a>
</dd>
</dl>
<p>
This
document
is
also
available
in
this
non-normative
format:
<a href="diff-20110808.html">
diff
to
previous
version
</a>.
</p>
<p class="copyright">
This
document
is
licensed
under
a
<a class="subfoot" href="http://creativecommons.org/licenses/by/3.0/" rel="license">
Creative
Commons
Attribution
3.0
License
</a>.
</p>
<hr />
</div>
<div id="abstract" class="introductory section">
<h2>
Abstract
</h2>
<p>
JSON
[
<cite>
<a class="bibref" rel="biblioentry" href="#bib-RFC4627">
RFC4627
</a>
</cite>
]
has
proven
to
be
a
highly
useful
object
serialization
and
messaging
format.
In
an
attempt
to
harmonize
the
representation
of
Linked
Data
in
JSON,
this
specification
outlines
a
common
JSON
representation
format
for
expressing
directed
graphs;
mixing
both
Linked
Data
and
non-Linked
Data
in
a
single
document.
</p>
</div>
<div id="sotd" class="introductory section">
<h2>
Status
of
This
Document
</h2>
<p>
This
document
is
merely
a
public
working
draft
of
a
potential
specification.
It
has
no
official
standing
of
any
kind
and
does
not
represent
the
support
or
consensus
of
any
standards
organisation.
</p>
<p>
This
document
is
an
experimental
work
in
progress.
</p>
</div>
<div id="toc" class="section">
<h2 class="introductory">
Table
of
Contents
</h2>
<ul class="toc">
<li class="tocline">
<a href="#introduction" class="tocxref">
<span class="secno">
1.
</span>
Introduction
</a>
<ul class="toc">
<li class="tocline">
<a href="#how-to-read-this-document" class="tocxref">
<span class="secno">
1.1
</span>
How
to
Read
this
Document
</a>
</li>
<li class="tocline">
<a href="#contributing" class="tocxref">
<span class="secno">
1.2
</span>
Contributing
</a>
</li>
</ul>
</li>
<li class="tocline">
<a href="#design" class="tocxref">
<span class="secno">
2.
</span>
Design
</a>
<ul class="toc">
<li class="tocline">
<a href="#goals-and-rationale" class="tocxref">
<span class="secno">
2.1
</span>
Goals
and
Rationale
</a>
</li>
<li class="tocline">
<a href="#linked-data" class="tocxref">
<span class="secno">
2.2
</span>
Linked
Data
</a>
</li>
<li class="tocline">
<a href="#linking-data" class="tocxref">
<span class="secno">
2.3
</span>
Linking
Data
</a>
</li>
<li class="tocline">
<a href="#the-context" class="tocxref">
<span class="secno">
2.4
</span>
The
Context
</a>
<ul class="toc">
<li class="tocline">
<a href="#inside-a-context" class="tocxref">
<span class="secno">
2.4.1
</span>
Inside
a
Context
</a>
</li>
</ul>
</li>
<li class="tocline">
<a href="#from-json-to-json-ld" class="tocxref">
<span class="secno">
2.5
</span>
From
JSON
to
JSON-LD
</a>
</li>
</ul>
</li>
<li class="tocline">
<a href="#basic-concepts" class="tocxref">
<span class="secno">
3.
</span>
Basic
Concepts
</a>
<ul class="toc">
<li class="tocline">
<a href="#iris" class="tocxref">
<span class="secno">
3.1
</span>
IRIs
</a>
</li>
<li class="tocline">
<a href="#identifying-the-subject" class="tocxref">
<span class="secno">
3.2
</span>
Identifying
the
Subject
</a>
</li>
<li class="tocline">
<a href="#specifying-the-type" class="tocxref">
<span class="secno">
3.3
</span>
Specifying
the
Type
</a>
</li>
<li class="tocline">
<a href="#strings" class="tocxref">
<span class="secno">
3.4
</span>
Strings
</a>
</li>
<li class="tocline">
<a href="#string-internationalization" class="tocxref">
<span class="secno">
3.5
</span>
String
Internationalization
</a>
</li>
<li class="tocline">
<a href="#datatypes" class="tocxref">
<span class="secno">
3.6
</span>
Datatypes
</a>
</li>
<li class="tocline">
<a href="#multiple-objects-for-a-single-property" class="tocxref">
<span class="secno">
3.7
</span>
Multiple
Objects
for
a
Single
Property
</a>
</li>
<li class="tocline">
<a href="#multiple-typed-literals-for-a-single-property" class="tocxref">
<span class="secno">
3.8
</span>
Multiple
Typed
Literals
for
a
Single
Property
</a>
</li>
<li class="tocline">
<a href="#expansion" class="tocxref">
<span class="secno">
3.9
</span>
Expansion
</a>
</li>
<li class="tocline">
<a href="#compaction" class="tocxref">
<span class="secno">
3.10
</span>
Compaction
</a>
</li>
<li class="tocline">
<a href="#framing" class="tocxref">
<span class="secno">
3.11
</span>
Framing
</a>
</li>
</ul>
</li>
<li class="tocline">
<a href="#advanced-concepts" class="tocxref">
<span class="secno">
4.
</span>
Advanced
Concepts
</a>
<ul class="toc">
<li class="tocline">
<a href="#curies" class="tocxref">
<span class="secno">
4.1
</span>
<ins class="diff-new">CURIEs
</ins></a></li><li class="tocline"><a href="#automatic-typing" class="tocxref"><span class="secno"><ins class="diff-new">
4.2
</ins></span>
Automatic
Typing
</a>
</li>
<li class="tocline">
<a href="#type-coercion" class="tocxref">
<span class="secno">
<del class="diff-old">4.2
</del>
<ins class="diff-chg">4.3
</ins>
</span>
Type
Coercion
</a>
</li>
<li class="tocline">
<a href="#chaining" class="tocxref">
<span class="secno">
<del class="diff-old">4.3
</del>
<ins class="diff-chg">4.4
</ins>
</span>
Chaining
</a>
</li>
<li class="tocline">
<a href="#identifying-unlabeled-nodes" class="tocxref">
<span class="secno">
<del class="diff-old">4.4
</del>
<ins class="diff-chg">4.5
</ins>
</span>
Identifying
Unlabeled
Nodes
</a>
</li>
<li class="tocline">
<a href="#overriding-keywords" class="tocxref">
<span class="secno">
<del class="diff-old">4.5
</del>
<ins class="diff-chg">4.6
</ins>
</span>
Overriding
Keywords
</a>
</li>
<li class="tocline">
<a href="#normalization" class="tocxref">
<span class="secno">
<del class="diff-old">4.6
</del>
<ins class="diff-chg">4.7
</ins>
</span>
Normalization
</a>
</li>
</ul>
</li>
<li class="tocline">
<a href="#the-application-programming-interface" class="tocxref">
<span class="secno">
5.
</span>
<ins class="diff-new">The
Application
Programming
Interface
</ins></a><ul class="toc"><li class="tocline"><a href="#jsonldprocessor" class="tocxref"><span class="secno"><ins class="diff-new">
5.1
</ins></span><ins class="diff-new">
JSONLDProcessor
</ins></a><ul class="toc"><li class="tocline"><a href="#methods" class="tocxref"><span class="secno"><ins class="diff-new">
5.1.1
</ins></span><ins class="diff-new">
Methods
</ins></a></li></ul></li><li class="tocline"><a href="#jsonldprocessorcallback" class="tocxref"><span class="secno"><ins class="diff-new">
5.2
</ins></span><ins class="diff-new">
JSONLDProcessorCallback
</ins></a><ul class="toc"><li class="tocline"><a href="#methods-1" class="tocxref"><span class="secno"><ins class="diff-new">
5.2.1
</ins></span><ins class="diff-new">
Methods
</ins></a></li></ul></li><li class="tocline"><a href="#jsonldtriplecallback" class="tocxref"><span class="secno"><ins class="diff-new">
5.3
</ins></span><ins class="diff-new">
JSONLDTripleCallback
</ins></a><ul class="toc"><li class="tocline"><a href="#methods-2" class="tocxref"><span class="secno"><ins class="diff-new">
5.3.1
</ins></span><ins class="diff-new">
Methods
</ins></a></li></ul></li></ul></li><li class="tocline"><a href="#algorithms" class="tocxref"><span class="secno"><ins class="diff-new">
6.
</ins></span>
Algorithms
</a>
<ul class="toc">
<li class="tocline">
<a href="#syntax-tokens-and-keywords" class="tocxref">
<span class="secno">
<del class="diff-old">5.1
</del>
<ins class="diff-chg">6.1
</ins>
</span>
Syntax
Tokens
and
Keywords
</a>
</li>
<li class="tocline">
<a href="#algorithm-terms" class="tocxref">
<span class="secno">
<del class="diff-old">5.2
</del>
<ins class="diff-chg">6.2
</ins>
</span>
Algorithm
Terms
</a>
</li>
<li class="tocline">
<a href="#context-1" class="tocxref">
<span class="secno">
<del class="diff-old">5.3
</del>
<ins class="diff-chg">6.3
</ins>
</span>
Context
</a>
<ul class="toc">
<li class="tocline">
<a href="#coerce" class="tocxref">
<span class="secno">
<del class="diff-old">5.3.1
</del>
<ins class="diff-chg">6.3.1
</ins>
</span>
Coerce
</a>
</li>
<li class="tocline">
<a href="#initial-context" class="tocxref">
<span class="secno">
<del class="diff-old">5.3.2
</del>
<ins class="diff-chg">6.3.2
</ins>
</span>
Initial
Context
</a>
</li>
</ul>
</li>
<li class="tocline">
<a href="#iri-expansion" class="tocxref">
<span class="secno">
<del class="diff-old">5.4
</del>
<ins class="diff-chg">6.4
</ins>
</span>
IRI
Expansion
</a>
</li>
<li class="tocline">
<a href="#iri-compaction" class="tocxref">
<span class="secno">
<del class="diff-old">5.5
</del>
<ins class="diff-chg">6.5
</ins>
</span>
IRI
Compaction
</a>
</li>
<li class="tocline">
<a href="#value-expansion" class="tocxref">
<span class="secno">
<del class="diff-old">5.6
</del>
<ins class="diff-chg">6.6
</ins>
</span>
Value
Expansion
</a>
</li>
<li class="tocline">
<a href="#value-compaction" class="tocxref">
<span class="secno">
<del class="diff-old">5.7
</del>
<ins class="diff-chg">6.7
</ins>
</span>
Value
Compaction
</a>
</li>
<li class="tocline">
<a href="#expansion-1" class="tocxref">
<span class="secno">
<del class="diff-old">5.8
</del>
<ins class="diff-chg">6.8
</ins>
</span>
Expansion
</a>
<ul class="toc">
<li class="tocline">
<a href="#expansion-algorithm" class="tocxref">
<span class="secno">
<del class="diff-old">5.8.1
</del>
<ins class="diff-chg">6.8.1
</ins>
</span>
Expansion
Algorithm
</a>
</li>
</ul>
</li>
<li class="tocline">
<a href="#compaction-1" class="tocxref">
<span class="secno">
<del class="diff-old">5.9
</del>
<ins class="diff-chg">6.9
</ins>
</span>
Compaction
</a>
<ul class="toc">
<li class="tocline">
<a href="#compaction-algorithm" class="tocxref">
<span class="secno">
<del class="diff-old">5.9.1
</del>
<ins class="diff-chg">6.9.1
</ins>
</span>
Compaction
Algorithm
</a>
</li>
</ul>
</li>
<li class="tocline">
<a href="#framing-1" class="tocxref">
<span class="secno">
<del class="diff-old">5.10
</del>
<ins class="diff-chg">6.10
</ins>
</span>
Framing
</a>
<ul class="toc">
<li class="tocline">
<a href="#framing-algorithm-terms" class="tocxref">
<span class="secno">
<del class="diff-old">5.10.1
</del>
<ins class="diff-chg">6.10.1
</ins>
</span>
Framing
Algorithm
Terms
</a>
</li>
<li class="tocline">
<a href="#framing-algorithm" class="tocxref">
<span class="secno">
<del class="diff-old">5.10.2
</del>
<ins class="diff-chg">6.10.2
</ins>
</span>
Framing
Algorithm
</a>
</li>
</ul>
</li>
<li class="tocline">
<a href="#normalization-1" class="tocxref">
<span class="secno">
<del class="diff-old">5.11
</del>
<ins class="diff-chg">6.11
</ins>
</span>
Normalization
</a>
<ul class="toc">
<li class="tocline">
<a href="#normalization-algorithm-terms" class="tocxref">
<span class="secno">
<del class="diff-old">5.11.1
</del>
<ins class="diff-chg">6.11.1
</ins>
</span>
Normalization
Algorithm
Terms
</a>
</li>
<li class="tocline">
<a href="#normalization-state" class="tocxref">
<span class="secno">
<ins class="diff-new">6.11.2
</ins></span><ins class="diff-new">
Normalization
State
</ins></a></li><li class="tocline">
<a href="#normalization-algorithm" class="tocxref">
<span class="secno">
<del class="diff-old">5.11.2
</del>
<ins class="diff-chg">6.11.3
</ins>
</span>
Normalization
Algorithm
</a>
</li>
<li class="tocline">
<a href="#node-relabeling-algorithm" class="tocxref">
<span class="secno">
<del class="diff-old">5.11.3
</del>
<ins class="diff-chg">6.11.4
</ins>
</span>
Node
<ins class="diff-new">Relabeling
Algorithm
</ins></a></li><li class="tocline"><a href="#deterministic-labeling-algorithm" class="tocxref"><span class="secno"><ins class="diff-new">
6.11.5
</ins></span><ins class="diff-new">
Deterministic
</ins>
Labeling
Algorithm
</a>
</li>
<li class="tocline">
<a href="#shallow-comparison-algorithm" class="tocxref">
<span class="secno">
<del class="diff-old">5.11.4
</del>
<ins class="diff-chg">6.11.6
</ins>
</span>
Shallow
Comparison
Algorithm
</a>
</li>
<li class="tocline">
<a href="#object-comparison-algorithm" class="tocxref">
<span class="secno">
<del class="diff-old">5.11.5
</del>
<ins class="diff-chg">6.11.7
</ins>
</span>
Object
Comparison
Algorithm
</a>
</li>
<li class="tocline">
<a href="#deep-comparison-algorithm" class="tocxref">
<span class="secno">
<del class="diff-old">5.11.6
</del>
<ins class="diff-chg">6.11.8
</ins>
</span>
Deep
Comparison
Algorithm
</a>
</li>
<li class="tocline">
<a href="#node-serialization-algorithm" class="tocxref">
<span class="secno">
<del class="diff-old">5.11.7
</del>
<ins class="diff-chg">6.11.9
</ins>
</span>
Node
Serialization
Algorithm
</a>
</li>
<li class="tocline">
<a href="#serialization-label-generation-algorithm" class="tocxref">
<span class="secno">
<ins class="diff-new">6.11.10
</ins></span><ins class="diff-new">
Serialization
Label
Generation
Algorithm
</ins></a></li><li class="tocline">
<a href="#combinatorial-serialization-algorithm" class="tocxref">
<span class="secno">
<del class="diff-old">5.11.8
</del>
<ins class="diff-chg">6.11.11
</ins>
</span>
Combinatorial
Serialization
Algorithm
</a>
</li>
<li class="tocline">
<a href="#mapping-serialization-algorithm" class="tocxref">
<span class="secno">
<del class="diff-old">5.11.9
</del>
<ins class="diff-chg">6.11.12
</ins>
</span>
Mapping
Serialization
Algorithm
</a>
</li>
<li class="tocline">
<a href="#label-serialization-algorithm" class="tocxref">
<span class="secno">
<del class="diff-old">5.11.10
</del>
<ins class="diff-chg">6.11.13
</ins>
</span>
Label
<del class="diff-old">Generation
</del>
<ins class="diff-chg">Serialization
</ins>
Algorithm
</a>
</li>
</ul>
</li>
<li class="tocline">
<a href="#data-round-tripping" class="tocxref">
<span class="secno">
<del class="diff-old">5.12
</del>
<ins class="diff-chg">6.12
</ins>
</span>
Data
Round
Tripping
</a>
</li>
<li class="tocline">
<a href="#rdf-conversion" class="tocxref">
<span class="secno">
<del class="diff-old">5.13
</del>
<ins class="diff-chg">6.13
</ins>
</span>
RDF
Conversion
</a>
<ul class="toc">
<li class="tocline">
<a href="#overview" class="tocxref">
<span class="secno">
<del class="diff-old">5.13.1
</del>
<ins class="diff-chg">6.13.1
</ins>
</span>
Overview
</a>
</li>
<li class="tocline">
<a href="#rdf-conversion-algorithm-terms" class="tocxref">
<span class="secno">
<del class="diff-old">5.13.2
</del>
<ins class="diff-chg">6.13.2
</ins>
</span>
RDF
Conversion
Algorithm
Terms
</a>
</li>
<li class="tocline">
<a href="#rdf-conversion-algorithm" class="tocxref">
<span class="secno">
<del class="diff-old">5.13.3
</del>
<ins class="diff-chg">6.13.3
</ins>
</span>
RDF
Conversion
Algorithm
</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="tocline">
<a href="#experimental-concepts" class="tocxref">
<span class="secno">
<del class="diff-old">6.
</del>
<ins class="diff-chg">7.
</ins>
</span>
Experimental
Concepts
</a>
<ul class="toc">
<li class="tocline">
<a href="#disjoint-graphs" class="tocxref">
<span class="secno">
<del class="diff-old">6.1
</del>
<ins class="diff-chg">7.1
</ins>
</span>
Disjoint
Graphs
</a>
</li>
<li class="tocline">
<a href="#lists" class="tocxref">
<span class="secno">
<del class="diff-old">6.2
</del>
<ins class="diff-chg">7.2
</ins>
</span>
Lists
</a>
<ul class="toc">
<li class="tocline">
<a href="#expansion-2" class="tocxref">
<span class="secno">
<del class="diff-old">6.2.1
</del>
<ins class="diff-chg">7.2.1
</ins>
</span>
Expansion
</a>
</li>
<li class="tocline">
<a href="#normalization-2" class="tocxref">
<span class="secno">
<del class="diff-old">6.2.2
</del>
<ins class="diff-chg">7.2.2
</ins>
</span>
Normalization
</a>
</li>
<li class="tocline">
<a href="#rdf-conversion-1" class="tocxref">
<span class="secno">
<del class="diff-old">6.2.3
</del>
<ins class="diff-chg">7.2.3
</ins>
</span>
RDF
Conversion
</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="tocline">
<a href="#markup-examples" class="tocxref">
<span class="secno">
A.
</span>
Markup
Examples
</a>
<ul class="toc">
<li class="tocline">
<a href="#rdfa" class="tocxref">
<span class="secno">
A.1
</span>
RDFa
</a>
</li>
<li class="tocline">
<a href="#microformats" class="tocxref">
<span class="secno">
A.2
</span>
Microformats
</a>
</li>
<li class="tocline">
<a href="#microdata" class="tocxref">
<span class="secno">
A.3
</span>
Microdata
</a>
</li>
<li class="tocline">
<a href="#mashing-up-vocabularies" class="tocxref">
<span class="secno">
A.4
</span>
Mashing
Up
Vocabularies
</a>
</li>
<li class="tocline">
<a href="#acknowledgements" class="tocxref">
<span class="secno">
A.5
</span>
Acknowledgements
</a>
</li>
</ul>
</li>
<li class="tocline">
<a href="#references" class="tocxref">
<span class="secno">
B.
</span>
References
</a>
<ul class="toc">
<li class="tocline">
<a href="#normative-references" class="tocxref">
<span class="secno">
B.1
</span>
Normative
references
</a>
</li>
<li class="tocline">
<a href="#informative-references" class="tocxref">
<span class="secno">
B.2
</span>
Informative
references
</a>
</li>
</ul>
</li>
</ul>
</div>
<div id="introduction" class="section">
<h2>
<span class="secno">
1.
</span>
Introduction
</h2>
<p>
JSON,
as
specified
in
[
<cite>
<a class="bibref" rel="biblioentry" href="#bib-RFC4627">
RFC4627
</a>
</cite>
],
is
a
simple
language
for
representing
data
on
the
Web.
Linked
Data
is
a
technique
for
describing
content
across
different
documents
or
Web
sites.
Web
resources
are
described
using
<a class="tref internalDFN" title="IRI" href="#dfn-iri">
IRI
</a>
s,
and
typically
are
dereferencable
entities
that
may
be
used
to
find
more
information,
creating
a
"Web
of
Knowledge".
JSON-LD
is
intended
to
be
a
simple
publishing
method
for
expressing
not
only
Linked
Data
in
JSON,
but
for
adding
semantics
to
existing
JSON.
</p>
<p>
JSON-LD
is
designed
as
a
light-weight
syntax
that
can
be
used
to
express
Linked
Data.
It
is
primarily
intended
to
be
a
way
to
express
Linked
Data
in
Javascript
and
other
Web-based
programming
environments.
It
is
also
useful
when
building
interoperable
Web
Services
and
when
storing
Linked
Data
in
JSON-based
document
storage
engines.
It
is
practical
and
designed
to
be
as
simple
as
possible,
utilizing
the
large
number
of
JSON
parsers
and
existing
code
that
is
in
use
today.
It
is
designed
to
be
able
to
express
key-value
pairs,
RDF
data,
RDFa
[
<cite>
<a class="bibref" rel="biblioentry" href="#bib-RDFA-CORE">
RDFA-CORE
</a>
</cite>
]
data,
Microformats
[
<cite>
<a class="bibref" rel="biblioentry" href="#bib-MICROFORMATS">
MICROFORMATS
</a>
</cite>
]
data,
and
Microdata
[
<cite>
<a class="bibref" rel="biblioentry" href="#bib-MICRODATA">
MICRODATA
</a>
</cite>
].
That
is,
it
supports
every
major
Web-based
structured
data
model
in
use
today.
</p>
<p>
The
syntax
does
not
require
many
applications
to
change
their
JSON,
but
easily
add
meaning
by
adding
context
in
a
way
that
is
either
in-band
or
out-of-band.
The
syntax
is
designed
to
not
disturb
already
deployed
systems
running
on
JSON,
but
provide
a
smooth
migration
path
from
JSON
to
JSON
with
added
semantics.
Finally,
the
format
is
intended
to
be
fast
to
parse,
fast
to
generate,
stream-based
and
document-based
processing
compatible,
and
require
a
very
small
memory
footprint
in
order
to
operate.
</p>
<div id="how-to-read-this-document" class="section">
<h3>
<span class="secno">
1.1
</span>
How
to
Read
this
Document
</h3>
<p>
This
document
is
a
detailed
specification
for
a
serialization
of
JSON
for
Linked
data.
The
document
is
primarily
intended
for
the
following
audiences:
</p>
<ul>
<li>
Web
developers
that
want
to
understand
the
design
decisions
and
language
syntax
for
JSON-LD.
</li>
<li>
Software
developers
that
want
to
encode
Microformats,
RDFa,
or
Microdata
in
a
way
that
is
cross-language
compatible
via
JSON.
</li>
<li>
Software
developers
that
want
to
implement
processors
and
APIs
for
JSON-LD.
</li>
</ul>
<p>
To
understand
the
basics
in
this
specification
you
must
first
be
familiar
with
JSON,
which
is
detailed
in
[
<cite>
<a class="bibref" rel="biblioentry" href="#bib-RFC4627">
RFC4627
</a>
</cite>
].
To
understand
the
API
and
how
it
is
intended
to
operate
in
a
programming
environment,
it
is
useful
to
have
working
knowledge
of
the
JavaScript
programming
language
[
<cite>
<a class="bibref" rel="biblioentry" href="#bib-ECMA-262">
ECMA-262
</a>
</cite>
]
and
WebIDL
[
<cite>
<a class="bibref" rel="biblioentry" href="#bib-WEBIDL">
WEBIDL
</a>
</cite>
].
To
understand
how
JSON-LD
maps
to
RDF,
it
is
helpful
to
be
familiar
with
the
basic
RDF
concepts
[
<cite>
<a class="bibref" rel="biblioentry" href="#bib-RDF-CONCEPTS">
RDF-CONCEPTS
</a>
</cite>
].
</p>
<p>
Examples
may
contain
references
to
existing
vocabularies
and
use
abbreviations
in
<del class="diff-old">CURIEs
</del>
<a class="tref internalDFN" title="CURIE" href="#dfn-curie">
<ins class="diff-chg">CURIE
</ins></a><ins class="diff-chg">
s
</ins>
and
source
code.
The
following
is
a
list
of
all
vocabularies
and
their
abbreviations,
as
used
in
this
document:
</p>
<ul>
<li>
The
<a href="http://purl.org/dc/terms/">
Dublin
Core
</a>
vocabulary
(abbreviation:
<code>
dc
</code>,
e.g.,
<code>
dc:title
</code>
)
</li>
<li>
The
<a href="http://xmlns.com/foaf/0.1/">
Friend
of
a
Friend
</a>
vocabulary
(abbreviation:
<code>
foaf
</code>,
e.g.,
<code>
foaf:knows
</code>
)
</li>
<li>
The
<a href="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
RDF
</a>
vocabulary
(abbreviation:
<code>
rdf
</code>,
e.g.,
<code>
rdf:type
</code>
)
</li>
<li>
The
<a href="http://www.w3.org/2001/XMLSchema#">
XSD
</a>
vocabulary
(abbreviation:
<code>
xsd
</code>,
e.g.,
<code>
xsd:integer
</code>
)
</li>
</ul>
<p>
<ins class="diff-new">JSON
[
</ins><cite><a class="bibref" rel="biblioentry" href="#bib-RFC4627"><ins class="diff-new">
RFC4627
</ins></a></cite><ins class="diff-new">
]
defines
several
terms
which
are
used
throughout
this
document:
</ins></p><dl><dt><dfn title="JSON_Object" id="dfn-json_object"><ins class="diff-new">
JSON
Object
</ins></dfn></dt><dd><ins class="diff-new">
An
object
structure
is
represented
as
a
pair
of
curly
brackets
surrounding
zero
or
more
name/value
pairs
(or
members).
A
name
is
a
</ins><a class="tref internalDFN" title="string" href="#dfn-string"><ins class="diff-new">
string
</ins></a>.<ins class="diff-new">
A
single
colon
comes
after
each
name,
separating
the
name
from
the
value.
A
single
comma
separates
a
value
from
a
following
name.
The
names
within
an
object
</ins><em class="rfc2119" title="should"><ins class="diff-new">
should
</ins></em><ins class="diff-new">
be
unique.
</ins></dd><dt><dfn title="array" id="dfn-array"><ins class="diff-new">
array
</ins></dfn></dt><dd><ins class="diff-new">
An
</ins><em><ins class="diff-new">
array
</ins></em><ins class="diff-new">
is
an
ordered
collection
of
values.
An
array
begins
with
[
(left
bracket)
and
ends
with
]
(right
bracket).
Values
are
separated
by
,
(comma).
Within
JSON-LD,
array
order
is
not
preserved,
unless
specific
markup
is
provided
(see
</ins><a href="#lists"><ins class="diff-new">
Lists
</ins></a><ins class="diff-new">
).
This
is
because
the
basic
data
model
of
JSON-LD
</ins><a class="tref internalDFN" title="linked_data_graph" href="#dfn-linked_data_graph"><ins class="diff-new">
linked
data
graph
</ins></a>,<ins class="diff-new">
which
is
inherently
unordered.
</ins></dd><dt><dfn title="string" id="dfn-string"><ins class="diff-new">
string
</ins></dfn></dt><dd><ins class="diff-new">
A
string
is
a
sequence
of
zero
or
more
Unicode
characters,
wrapped
in
double
quotes,
using
backslash
escapes.
A
character
is
represented
as
a
single
character
string.
A
string
is
very
much
like
a
C
or
Java
string.
</ins></dd><dt><dfn title="number" id="dfn-number"><ins class="diff-new">
number
</ins></dfn></dt><dd><ins class="diff-new">
A
number
is
very
much
like
a
C
or
Java
number,
except
that
the
octal
and
hexadecimal
formats
are
not
used.
</ins></dd><dt><dfn title="true" id="dfn-true"><ins class="diff-new">
true
</ins></dfn><ins class="diff-new">
and
</ins><dfn title="false" id="dfn-false"><ins class="diff-new">
false
</ins></dfn></dt><dd><ins class="diff-new">
Boolean
values.
</ins></dd><dt><dfn title="null" id="dfn-null"><ins class="diff-new">
null
</ins></dfn></dt><dd><ins class="diff-new">
The
use
of
the
</ins><em><ins class="diff-new">
null
</ins></em><ins class="diff-new">
value
is
undefined
within
JSON-LD.
</ins></dd></dl><p></p>
</div>
<div id="contributing" class="section">
<h3>
<span class="secno">
1.2
</span>
Contributing
</h3>
<p>
There
are
a
number
of
ways
that
one
may
participate
in
the
development
of
this
specification:
</p>
<ul>
<li>
Technical
discussion
typically
occurs
on
the
public
mailing
list:
<a href="http://lists.w3.org/Archives/Public/public-linked-json/">
public-linked-json@w3.org
</a>
</li>
<li>
<a href="http://json-ld.org/minutes/">
Public
teleconferences
</a>
are
held
on
Tuesdays
at
1500UTC
on
the
second
and
fourth
week
of
each
month.
</li>
<li>
Specification
bugs
and
issues
should
be
reported
in
the
<a href="https://github.com/json-ld/json-ld.org/issues">
issue
tracker
</a>.
</li>
<li>
<a href="https://github.com/json-ld/json-ld.org/tree/master/spec">
Source
code
</a>
for
the
specification
can
be
found
on
Github.
</li>
<li>
The
<a href="http://webchat.freenode.net/?channels=#json-ld">
#json-ld
</a>
IRC
channel
is
available
for
real-time
discussion
on
irc.freenode.net.
</li>
</ul>
</div>
</div>
<div id="design" class="section">
<h2>
<span class="secno">
2.
</span>
Design
</h2>
<p>
The
following
section
outlines
the
design
goals
and
rationale
behind
the
JSON-LD
markup
language.
</p>
<div id="goals-and-rationale" class="section">
<h3>
<span class="secno">
2.1
</span>
Goals
and
Rationale
</h3>
<p>
A
number
of
design
considerations
were
explored
during
the
creation
of
this
markup
language:
</p>
<dl>
<dt>
Simplicity
</dt>
<dd>
Developers
need
only
know
JSON
and
three
keywords
to
use
the
basic
functionality
in
JSON-LD.
No
extra
processors
or
software
libraries
are
necessary
to
use
JSON-LD
in
its
most
basic
form.
The
language
attempts
to
ensure
that
developers
have
an
easy
learning
curve.
</dd>
<dt>
Compatibility
</dt>
<dd>
The
JSON-LD
markup
must
be
100%
compatible
with
JSON.
This
ensures
that
all
of
the
standard
JSON
libraries
work
seamlessly
with
JSON-LD
documents.
</dd>
<dt>
Expressiveness
</dt>
<dd>
The
syntax
must
be
able
to
express
directed
graphs,
which
have
been
proven
to
be
able
to
simply
express
almost
every
real
world
data
model.
</dd>
<dt>
Terseness
</dt>
<dd>
The
JSON-LD
syntax
must
be
very
terse
and
human
readable,
requiring
as
little
as
possible
from
the
developer.
</dd>
<dt>
<del class="diff-old">Pragmatism
Mixing
the
expression
of
pure
Linked
Data
with
data
that
is
not
linked
was
an
approach
that
was
driven
by
pragmatism.
JSON-LD
attempts
to
be
more
practical
than
theoretical
in
its
approach
to
Linked
Data.
</del>
Zero
Edits,
most
of
the
time
</dt>
<dd>
JSON-LD
provides
a
mechanism
that
allows
developers
to
specify
context
in
a
way
that
is
out-of-band.
This
allows
organizations
that
have
already
deployed
large
JSON-based
infrastructure
to
add
meaning
to
their
JSON
in
a
way
that
is
not
disruptive
to
their
day-to-day
operations
and
is
transparent
to
their
current
customers.
At
times,
mapping
JSON
to
a
graph
representation
can
become
difficult.
In
these
instances,
rather
than
having
JSON-LD
support
esoteric
markup,
we
chose
not
to
support
the
use
case
and
support
a
simplified
syntax
instead.
So,
while
Zero
Edits
was
a
goal,
it
was
not
always
possible
without
adding
great
complexity
to
the
language.
</dd>
<dt>
Streaming
</dt>
<dd>
The
format
supports
both
document-based
and
stream-based
processing.
</dd>
</dl>
</div>
<div id="linked-data" class="section">
<h3>
<span class="secno">
2.2
</span>
Linked
Data
</h3>
<p>
The
following
definition
for
<a class="tref internalDFN" title="Linked_Data" href="#dfn-linked_data">
Linked
Data
</a>
is
the
one
that
will
be
used
for
this
specification.
</p>
<ol>
<li>
<dfn title="Linked_Data" id="dfn-linked_data">
Linked
Data
</dfn>
is
a
set
of
documents,
each
containing
a
representation
of
a
linked
data
graph.
</li>
<li>
A
<dfn title="linked_data_graph" id="dfn-linked_data_graph">
linked
data
graph
</dfn>
is
<del class="diff-old">a
</del>
<ins class="diff-chg">an
unordered
</ins>
labeled
directed
graph,
where
nodes
are
<a class="tref internalDFN" title="subject" href="#dfn-subject">
subject
</a>
s
or
<a class="tref internalDFN" title="object" href="#dfn-object">
object
</a>
s,
and
edges
are
properties.
</li>
<li>
A
<dfn title="subject" id="dfn-subject">
subject
</dfn>
is
any
node
in
a
<a class="tref internalDFN" title="linked_data_graph" href="#dfn-linked_data_graph">
linked
data
graph
</a>
with
at
least
one
outgoing
edge.
</li>
<li>
A
<a class="tref internalDFN" title="subject" href="#dfn-subject">
subject
</a>
<em class="rfc2119" title="should">
should
</em>
be
labeled
with
<del class="diff-old">a
</del>
<ins class="diff-chg">an
</ins>
IRI.
</li>
<li>
A
<dfn title="property" id="dfn-property">
property
</dfn>
is
an
edge
of
the
<a class="tref internalDFN" title="linked_data_graph" href="#dfn-linked_data_graph">
linked
data
graph
<del class="diff-old">.
</del>
</a>.
</li>
<li>
A
<a class="tref internalDFN" title="property" href="#dfn-property">
property
</a>
<del class="diff-old">must
</del>
<em class="rfc2119" title="should">
<ins class="diff-chg">should
</ins>
</em>
be
labeled
with
an
IRI.
</li>
<li>
An
<dfn title="object" id="dfn-object">
object
</dfn>
is
a
node
in
a
<a class="tref internalDFN" title="linked_data_graph" href="#dfn-linked_data_graph">
linked
data
graph
</a>
with
at
least
one
incoming
edge.
</li>
<li>
An
<a class="tref internalDFN" title="object" href="#dfn-object">
object
</a>
<em class="rfc2119" title="may">
may
</em>
be
labeled
with
an
IRI.
</li>
<li>
An
IRI
that
is
a
label
in
a
<a class="tref internalDFN" title="linked_data_graph" href="#dfn-linked_data_graph">
linked
data
graph
</a>
<em class="rfc2119" title="should">
should
</em>
be
dereferencable
to
a
<a class="tref internalDFN" title="Linked_Data" href="#dfn-linked_data">
Linked
Data
</a>
document
describing
the
labeled
<a class="tref internalDFN" title="subject" href="#dfn-subject">
subject
</a>,
<a class="tref internalDFN" title="object" href="#dfn-object">
object
</a>
or
<a class="tref internalDFN" title="property" href="#dfn-property">
property
<del class="diff-old">.
</del>
</a>.
</li>
<li>
A
<dfn title="literal" id="dfn-literal">
literal
</dfn>
is
an
<a class="tref internalDFN" title="object" href="#dfn-object">
object
</a>
with
a
label
that
is
not
an
IRI
</li>
</ol>
<p>
Note
that
the
definition
for
<a class="tref internalDFN" title="Linked_Data" href="#dfn-linked_data">
Linked
Data
</a>
above
is
silent
on
the
topic
of
unlabeled
nodes.
Unlabeled
nodes
are
not
considered
<a class="tref internalDFN" title="Linked_Data" href="#dfn-linked_data">
Linked
Data
</a>.
However,
this
specification
allows
for
the
expression
of
unlabled
nodes,
as
most
graph-based
data
sets
on
the
Web
contain
a
number
of
associated
nodes
that
are
not
named
and
thus
are
not
directly
de-referenceable.
</p>
</div>
<div id="linking-data" class="section">
<h3>
<span class="secno">
2.3
</span>
Linking
Data
</h3>
<p>
An
Internationalized
Resource
Identifier
(
<dfn title="IRI" id="dfn-iri">
<abbr title="Internationalized Resource Identifier">
IRI
</abbr>
</dfn>
),
as
described
in
[
<cite>
<a class="bibref" rel="biblioentry" href="#bib-RFC3987">
RFC3987
</a>
</cite>
],
is
a
mechanism
for
representing
unique
identifiers
on
the
web.
In
<a class="tref internalDFN" title="Linked_Data" href="#dfn-linked_data">
Linked
Data
</a>,
an
IRI
is
commonly
used
for
expressing
a
<a class="tref internalDFN" title="subject" href="#dfn-subject">
subject
</a>,
a
<a class="tref internalDFN" title="property" href="#dfn-property">
property
</a>
or
an
<a class="tref internalDFN" title="object" href="#dfn-object">
object
</a>.
</p>
<p>
JSON-LD
defines
a
mechanism
to
map
JSON
values
to
IRIs.
This
does
not
mean
that
JSON-LD
requires
every
key
or
value
to
be
an
IRI,
but
rather
ensures
that
keys
and
values
can
be
mapped
to
IRIs
if
the
developer
so
desires
to
transform
their
data
into
Linked
Data.
There
are
a
few
techniques
that
can
ensure
that
developers
will
generate
good
Linked
Data
for
the
Web.
JSON-LD
formalizes
those
techniques.
</p>
<p>
We
will
be
using
the
following
JSON
markup
as
the
example
for
the
rest
of
this
section:
</p>
<pre class="example">
{
  "name": "Manu Sporny",
  "homepage": "http://manu.sporny.org/",
  "avatar": "http://twitter.com/account/profile_image/manusporny"
}
</pre>
</div>
<div id="the-context" class="section">
<h3>
<span class="secno">
2.4
</span>
The
Context
</h3>
<p>
In
JSON-LD,
a
context
is
used
to
allow
developers
to
map
<a class="tref internalDFN" title="term" href="#dfn-term">
term
</a>
s
to
<a class="tref internalDFN" title="IRI" href="#dfn-iri">
IRI
</a>
s.
A
<dfn title="term" id="dfn-term">
term
</dfn>
is
a
short
word
that
<em class="rfc2119" title="may">
may
</em>
be
expanded
to
an
<a class="tref internalDFN" title="IRI" href="#dfn-iri">
IRI
</a>.
The
semantic
web,
just
like
the
document-based
web,
uses
IRIs
for
unambiguous
identification.
The
idea
is
that
these
<a class="tref internalDFN" title="term" href="#dfn-term">
term
</a>
s
mean
something
that
may
be
of
use
to
other
developers.
For
example,
the
term
<code>
name
</code>
may
map
directly
to
the
IRI
<code>
http://xmlns.com/foaf/0.1/name
</code>.
This
allows
JSON-LD
documents
to
be
constructed
using
the
common
JSON
practice
of
simple
name/value
pairs
while
ensuring
that
the
data
is
useful
outside
of
the
database
or
page
in
which
it
resides.
</p>
<p>
These
Linked
Data
<a class="tref internalDFN" title="term" href="#dfn-term">
term
</a>
s
are
typically
collected
in
a
context
and
then
used
by
adding
a
single
line
to
the
JSON
markup
above:
</p>
<pre class="example">
{
  <span class="diff">"@context": "http://example.org/json-ld-contexts/person",</span>
  "name": "Manu Sporny",
  "homepage": "http://manu.sporny.org/",
  "avatar": "http://twitter.com/account/profile_image/manusporny"
}
</pre>
<p>
The
addition
above
transforms
the
previous
JSON
document
into
a
JSON
document
with
added
semantics
because
the
<code>
@context
</code>
specifies
how
the
<strong>
name
</strong>,
<strong>
homepage
</strong>,
and
<strong>
avatar
</strong>
terms
map
to
IRIs.
Mapping
those
keys
to
IRIs
gives
the
data
global
context.
If
two
developers
use
the
same
IRI
to
describe
a
property,
they
are
more
than
likely
expressing
the
same
concept.
This
allows
both
developers
to
re-use
each
others
data
without
having
to
agree
to
how
their
data
will
inter-operate
on
a
site-by-site
basis.
</p>
<p>
The
semantic
web
uses
a
special
type
of
document
called
a
<em>
Web
Vocabulary
</em>
to
define
<a class="tref internalDFN" title="term" href="#dfn-term">
term
</a>
s.
A
context
is
a
type
of
Web
vocabulary.
Typically,
these
Web
Vocabulary
documents
have
<a class="tref internalDFN" title="prefix" href="#dfn-prefix">
prefix
</a>
es
associated
with
them
and
contain
a
number
of
<a class="tref internalDFN" title="term" href="#dfn-term">
term
</a>
declarations.
A
<dfn title="prefix" id="dfn-prefix">
prefix
</dfn>,
like
a
<a class="tref internalDFN" title="term" href="#dfn-term">
term
</a>,
is
a
short
word
that
expands
to
a
Web
Vocabulary
IRI.
<a class="tref internalDFN" title="Prefix" href="#dfn-prefix">
Prefix
</a>
es
are
helpful
when
a
developer
wants
to
mix
multiple
vocabularies
together
in
a
context,
but
does
not
want
to
go
to
the
trouble
of
defining
every
single
term
in
every
single
vocabulary.
Some
Web
Vocabularies
may
have
10-20
terms
defined.
If
a
developer
wants
to
use
3-4
different
vocabularies,
the
number
of
terms
that
would
have
to
be
declared
in
a
single
context
would
become
quite
large.
To
reduce
the
number
of
different
terms
that
must
be
defined,
JSON-LD
also
allows
prefixes
to
be
used
to
compact
IRIs.
</p>
<p>
</p>
<p>
For
example,
the
IRI
<code>
http://xmlns.com/foaf/0.1/
</code>
specifies
a
Web
Vocabulary
which
may
be
represented
using
the
<code>
foaf
</code>
<a class="tref internalDFN" title="prefix" href="#dfn-prefix">
prefix
</a>.
The
<code>
foaf
</code>
Web
Vocabulary
contains
a
term
called
<strong>
name
</strong>.
If
you
join
the
<code>
foaf
</code>
<a class="tref internalDFN" title="prefix" href="#dfn-prefix">
prefix
</a>
with
the
<strong>
name
</strong>
suffix,
you
can
build
a
compact
IRI
that
will
expand
out
into
an
absolute
IRI
for
the
<code>
http://xmlns.com/foaf/0.1/name
</code>
vocabulary
term.
That
is,
the
compact
IRI,
or
short-form,
is
<code>
foaf:name
</code>
and
the
expanded-form
is
<code>
http://xmlns.com/foaf/0.1/name
</code>.
This
vocabulary
term
is
used
to
specify
a
person's
name.
</p>
<p>
Developers,
and
machines,
are
able
to
use
this
IRI
(plugging
it
directly
into
a
web
browser,
for
instance)
to
go
to
the
term
and
get
a
definition
of
what
the
term
means.
Much
like
we
can
use
WordNet
today
to
see
the
<a href="http://wordnetweb.princeton.edu/perl/webwn?s=definition">
definition
</a>
of
words
in
the
English
language.
Developers
and
machines
need
the
same
sort
of
dictionary
of
terms.
IRIs
provide
a
way
to
ensure
that
these
terms
are
unambiguous.
</p>
<p>
The
context
provides
a
collection
of
vocabulary
<a class="tref internalDFN" title="term" href="#dfn-term">
term
</a>
s
and
<a class="tref internalDFN" title="prefix" href="#dfn-prefix">
prefix
</a>
es
that
can
be
used
to
expand
JSON
keys
and
values
into
<a class="tref internalDFN" title="IRI" href="#dfn-iri">
IRI
</a>
s.
</p>
<div id="inside-a-context" class="section">
<h4>
<span class="secno">
2.4.1
</span>
Inside
a
Context
</h4>
<p>
In
the
previous
section,
the
developer
used
the
<code>
@context
</code>
keyword
to
pull
in
an
external
context.
That
context
document,
if
de-referenced,
would
look
something
like
this:
</p>
<pre class="example">
{
    "name": "http://xmlns.com/foaf/0.1/name",
    "homepage": "http://xmlns.com/foaf/0.1/homepage",
    "avatar": "http://xmlns.com/foaf/0.1/avatar"
}
</pre>
<p>
A
JSON-LD
context
document
is
a
simple
mapping
from
<a class="tref internalDFN" title="term" href="#dfn-term">
term
</a>
s
and
<a class="tref internalDFN" title="prefix" href="#dfn-prefix">
prefix
</a>
es
to
expanded
values
such
as
IRIs
or
keywords.
Contexts
may
also
contain
datatype
information
for
certain
<a class="tref internalDFN" title="term" href="#dfn-term">
term
</a>
s
as
well
as
other
processing
instructions
for
the
JSON-LD
processor.
</p>
<p>
Contexts
may
be
specified
in-line.
This
ensures
that
JSON-LD
documents
can
be
processed
when
a
JSON-LD
processor
does
not
have
access
to
the
Web.
</p>
<p>
JSON-LD
strives
to
ensure
that
developers
don't
have
to
change
the
JSON
that
is
going
into
and
being
returned
from
their
Web
applications.
This
means
that
developers
can
also
specify
a
context
for
JSON
data
in
an
out-of-band
fashion
via
the
API.
The
API
is
described
later
in
this
document.
A
JSON-LD
aware
Web
Service
<em class="rfc2119" title="may">
may
</em>
also
define
a
context
that
will
be
pre-loaded
for
all
calls
to
the
service.
This
allows
services
that
have
previously
been
publishing
and
receiving
JSON
data
to
accept
JSON-LD
data
without
requiring
client
software
to
change.
</p>
</div>
</div>
<div id="from-json-to-json-ld" class="section">
<h3>
<span class="secno">
2.5
</span>
From
JSON
to
JSON-LD
</h3>
<p>
If
a
set
of
terms
such
as,
<strong>
name
</strong>,
<strong>
homepage
</strong>,
and
<strong>
avatar
</strong>,
are
defined
in
a
context,
and
that
context
is
used
to
resolve
the
names
in
JSON
objects,
machines
are
able
to
automatically
expand
the
terms
to
something
meaningful
and
unambiguous,
like
this:
</p>
<pre class="example">
{
  "<span class="diff">http://xmlns.com/foaf/0.1/name</span>": "Manu Sporny",
  "<span class="diff">http://xmlns.com/foaf/0.1/homepage</span>": "http://manu.sporny.org"
  "<span class="diff">http://rdfs.org/sioc/ns#avatar</span>": "http://twitter.com/account/profile_image/manusporny"
}
</pre>
<p>
Doing
this
allows
JSON
to
be
unambiguously
machine-readable
without
requiring
developers
that
use
JSON
to
drastically
change
their
workflow.
</p>
</div>
</div>
<div id="basic-concepts" class="section">
<h2>
<span class="secno">
3.
</span>
Basic
Concepts
</h2>
<p>
JSON-LD
is
designed
to
ensure
that
Linked
Data
concepts
can
be
marked
up
in
a
way
that
is
simple
to
understand
and
author
by
Web
developers.
In
many
cases,
regular
JSON
markup
can
become
Linked
Data
with
the
simple
addition
of
a
context.
As
more
JSON-LD
features
are
used,
more
semantics
are
added
to
the
JSON
markup.
</p>
<div id="iris" class="section">
<h3>
<span class="secno">
3.1
</span>
IRIs
</h3>
<p>
Expressing
IRIs
are
fundamental
to
Linked
Data
as
that
is
how
most
<a class="tref internalDFN" title="subject" href="#dfn-subject">
subject
</a>
s
and
many
<a class="tref internalDFN" title="object" href="#dfn-object">
object
</a>
are
named.
IRIs
can
be
expressed
in
a
variety
of
different
ways
in
JSON-LD.
</p>
<ol>
<li>
In
general,
<a class="tref internalDFN" title="term" href="#dfn-term">
term
</a>
s
in
the
key
position
in
<del class="diff-old">an
associative
array
</del>
<ins class="diff-chg">a
</ins><a class="tref internalDFN" title="JSON_object" href="#dfn-json_object"><ins class="diff-chg">
JSON
object
</ins></a>
that
have
a
mapping
to
an
IRI
or
another
key
in
the
context
are
expanded
to
an
IRI
by
JSON-LD
processors.
There
are
special
rules
for
processing
keys
in
<code>
@context
</code>
and
when
dealing
with
keys
that
start
with
the
<code>
@subject
</code>
character.
</li>
<li>
An
IRI
is
generated
for
the
value
specified
using
<code>
@subject
</code>,
if
it
is
a
<del class="diff-old">string.
</del>
<a class="tref internalDFN" title="string" href="#dfn-string">
<ins class="diff-chg">string
</ins></a>.
</li>
<li>
An
IRI
is
generated
for
the
value
specified
using
<code>
@type
</code>.
</li>
<li>
An
IRI
is
generated
for
the
value
specified
using
the
<code>
@iri
</code>
keyword.
</li>
<li>
An
IRI
is
generated
when
there
are
<code>
@coerce
</code>
rules
in
effect
for
a
key
named
<code>
@iri
</code>.
</li>
</ol>
<p>
IRIs
can
be
expressed
directly
in
the
key
position
like
so:
</p>
<pre class="example">
{
...
  "<span class="diff">http://xmlns.com/foaf/0.1/name</span>": "Manu Sporny",
...
}
</pre>
<p>
In
the
example
above,
the
key
<code>
http://xmlns.com/foaf/0.1/name
</code>
is
interpreted
as
an
IRI,
as
opposed
to
being
interpreted
as
a
<del class="diff-old">string..
</del>
<ins class="diff-chg">string.
</ins>
</p>
<p>
Term
expansion
occurs
for
IRIs
if
a
term
is
defined
within
the
<a class="tref internalDFN" title="active_context" href="#dfn-active_context">
active
context
</a>:
</p>
<pre class="example">
{
  "<span class="diff">@context</span>": {"<span class="diff">name</span>": "<span class="diff">http://xmlns.com/foaf/0.1/name</span>"},
...
  "<span class="diff">name</span>": "Manu Sporny",
...
}
</pre>
<p>
<a class="tref internalDFN" title="Prefix" href="#dfn-prefix">
Prefix
</a>
es
are
expanded
when
used
in
keys:
</p>
<pre class="example">
{
<del class="diff-old">  ""},
</del>
<ins class="diff-chg">  "<span class="diff">@context</span>": {"<span class="diff">name</span>": "<span class="diff">http://xmlns.com/foaf/0.1/name</span>"},
</ins>
...
<del class="diff-old">  "": "Manu Sporny",
</del>
<ins class="diff-chg">  "<span class="diff">name</span>": "Manu Sporny",
</ins>
...
}
</pre>
<p>
<code>
<del class="diff-old">foaf:name
</del>
<ins class="diff-chg">name
</ins>
</code>
above
will
automatically
expand
out
to
the
IRI
<code>
http://xmlns.com/foaf/0.1/name
</code>.
</p>
<p>
An
IRI
is
generated
when
a
value
is
associated
with
a
key
using
the
<code>
@iri
</code>
keyword:
</p>
<pre class="example">
{
...
<del class="diff-old">  "foaf:homepage": { "": "http://manu.sporny.org" }
</del>
<ins class="diff-chg">  "homepage": { "<span class="diff">@iri</span>": "http://manu.sporny.org" }
</ins>
...
}
</pre>
<p>
If
type
coercion
rules
are
specified
in
the
<code>
@context
</code>
for
a
particular
vocabulary
term,
an
IRI
is
generated:
</p>
<pre class="example">
{<span class="diff">
  "@context": 
  {
    ...
    "@coerce": 
    {
<del class="diff-old">      "@iri": "foaf:homepage"
</del>
<ins class="diff-chg">      "@iri": "homepage"
</ins>
    }
  }</span>
...
<del class="diff-old">  "foaf:homepage": "http://manu.sporny.org/",
</del>
<ins class="diff-chg">  "homepage": "http://manu.sporny.org/",
</ins>
...
}
</pre>
<p>
Even
though
the
value
<code>
http://manu.sporny.org/
</code>
is
a
<del class="diff-old">string,
</del>
<a class="tref internalDFN" title="string" href="#dfn-string">
<ins class="diff-chg">string
</ins></a>,
the
type
coercion
rules
will
transform
the
value
into
an
IRI
when
processed
by
a
JSON-LD
Processor
</p>
</div>
<div id="identifying-the-subject" class="section">
<h3>
<span class="secno">
3.2
</span>
Identifying
the
Subject
</h3>
<p>
<a class="tref internalDFN" title="IRI" href="#dfn-iri">
<ins class="diff-new">IRI
</ins></a><ins class="diff-new">
s
are
a
fundamental
concept
of
Linked
Data,
and
nodes
should
have
a
de-referencable
identifier
used
to
name
and
locate
them.
For
nodes
to
be
truely
linked,
de-referencing
the
identifier
should
result
in
a
representation
of
that
node.
Associating
an
IRI
with
a
node
tells
an
application
that
the
returned
document
contains
a
description
of
of
the
identifier
requested.
</ins></p><p><ins class="diff-new">
JSON-LD
documents
may
also
contain
descriptions
of
other
nodes,
so
it
is
necessary
to
be
able
to
uniquely
identify
each
node
which
may
be
externally
referenced.
</ins></p><p>
A
<a class="tref internalDFN" title="subject" href="#dfn-subject">
subject
</a>
<ins class="diff-new">of
a
node
</ins>
is
declared
using
the
<code>
@subject
</code>
key.
The
subject
is
the
first
piece
of
information
needed
by
the
JSON-LD
processor
in
order
to
create
the
(subject,
property,
object)
tuple,
also
known
as
a
triple.
</p>
<pre class="example">
{
...
  "<span class="diff">@subject</span>": "<span class="diff">http://example.org/people#joebob</span>",
...
}
</pre>
<p>
The
example
above
would
set
the
subject
to
the
IRI
<code>
http://example.org/people#joebob
</code>.
</p>
</div>
<div id="specifying-the-type" class="section">
<h3>
<span class="secno">
3.3
</span>
Specifying
the
Type
</h3>
<p>
The
type
of
a
particular
subject
can
be
specified
using
the
<code>
@type
</code>
key.
Specifying
the
type
in
this
way
will
generate
a
triple
of
the
form
(subject,
type,
<del class="diff-old">type-url).
</del>
<ins class="diff-chg">type-uri).
</ins></p><p><ins class="diff-chg">
To
be
Linked
Data,
types
should
be
uniquely
identified
by
an
</ins><a class="tref internalDFN" title="IRI" href="#dfn-iri"><ins class="diff-chg">
IRI
</ins></a>.
</p>
<pre class="example">
{
...
  "@subject": "http://example.org/people#joebob",
  "<span class="diff">@type</span>": "<span class="diff">http://xmlns.com/foaf/0.1/Person</span>",
...
}
</pre>
<p>
The
example
above
would
generate
the
following
triple
if
the
JSON-LD
document
is
mapped
to
RDF
(in
N-Triples
notation):
</p>
<pre class="example">
&lt;http://example.org/people#joebob&gt; 
   &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt;
&lt;http://xmlns.com/foaf/0.1/Person&gt;
.
</pre>
</div>
<div id="strings" class="section">
<h3>
<span class="secno">
3.4
</span>
Strings
</h3>
<p>
Regular
text
strings,
also
<del class="diff-old">refered
</del>
<ins class="diff-chg">referred
</ins>
to
as
<dfn title="plain_literal" id="dfn-plain_literal">
plain
literal
</dfn>
s,
are
easily
expressed
using
regular
JSON
<del class="diff-old">strings.
</del>
<a class="tref internalDFN" title="string" href="#dfn-string">
<ins class="diff-chg">string
</ins></a><ins class="diff-chg">
s.
</ins>
</p>
<pre class="example">
{
...
<del class="diff-old">  "foaf:name": "",
</del>
<ins class="diff-chg">  "name": "<span class="diff">Mark Birbeck</span>",
</ins>
...
}
</pre>
</div>
<div id="string-internationalization" class="section">
<h3>
<span class="secno">
3.5
</span>
String
Internationalization
</h3>
<p>
JSON-LD
makes
an
assumption
that
strings
with
associated
language
encoding
information
are
not
very
common
when
used
in
JavaScript
and
Web
Services.
Thus,
it
takes
a
little
more
effort
to
express
strings
with
associated
language
information.
</p>
<pre class="example">
{
...
<del class="diff-old">  "foaf:name": 
</del>
<ins class="diff-chg">  "name": <span class="diff">
</ins>
  {
    "@literal": "花澄",
    "@language": "ja"
  }</span>
...
}
</pre>
<p>
The
example
above
would
generate
a
<a class="tref internalDFN" title="plain_literal" href="#dfn-plain_literal">
plain
literal
</a>
for
<em>
花澄
</em>
and
associate
the
<code>
ja
</code>
language
code
with
the
triple
that
is
generated.
Languages
<em class="rfc2119" title="must">
must
</em>
be
expressed
in
[
<cite>
<a class="bibref" rel="biblioentry" href="#bib-BCP47">
BCP47
</a>
</cite>
]
format.
</p>
</div>
<div id="datatypes" class="section">
<h3>
<span class="secno">
3.6
</span>
Datatypes
</h3>
<p>
A
value
with
an
associated
datatype,
also
known
as
a
<dfn title="typed_literal" id="dfn-typed_literal">
typed
literal
</dfn>,
is
indicated
by
associating
a
literal
with
an
IRI
which
indicates
the
typed
literal's
datatype.
Typed
literals
may
be
expressed
in
JSON-LD
in
three
ways:
</p>
<ol>
<li>
By
utilizing
the
<code>
@coerce
</code>
keyword.
</li>
<li>
By
utilizing
the
expanded
form
for
specifying
objects.
</li>
<li>
By
using
a
native
JSON
datatype.
</li>
</ol>
<p>
The
first
example
uses
the
<code>
@coerce
</code>
keyword
to
express
a
typed
literal:
</p>
<pre class="example">
{<span class="diff">
  "@context": 
  {
<del class="diff-old">    "dc":  "http://purl.org/dc/terms/",
    "xsd": "http://www.w3.org/2001/XMLSchema#"
</del>
<ins class="diff-chg">    "modified":  "http://purl.org/dc/terms/modified",
    "dateTime": "http://www.w3.org/2001/XMLSchema#dateTime"
</ins>
    "@coerce": 
    {
<del class="diff-old">      "xsd:dateTime": "dc:modified"
</del>
<ins class="diff-chg">      "dateTime": "modified"
</ins>
    }
  }</span>
...
<del class="diff-old">  "dc:modified": "2010-05-29T14:17:39+02:00",
</del>
<ins class="diff-chg">  "modified": "2010-05-29T14:17:39+02:00",
</ins>
...
}
</pre>
<p>
The
second
example
uses
the
expanded
form
for
specifying
objects:
</p>
<pre class="example">
{
...
<del class="diff-old">  "dc:modified": 
</del>
<ins class="diff-chg">  "modified": <span class="diff">
</ins>
  {
    "@literal": "2010-05-29T14:17:39+02:00",
<del class="diff-old">    "@datatype": "xsd:dateTime"
</del>
<ins class="diff-chg">    "@datatype": "dateTime"
</ins>
  }</span>
...
}
</pre>
<p>
Both
examples
above
would
generate
an
object
with
the
literal
value
of
<code>
2010-05-29T14:17:39+02:00
</code>
and
the
datatype
of
<code>
http://www.w3.org/2001/XMLSchema#dateTime
</code>.
</p>
<p>
The
third
example
uses
a
built-in
native
JSON
type,
a
<del class="diff-old">number,
</del>
<a class="tref internalDFN" title="number" href="#dfn-number">
<ins class="diff-chg">number
</ins></a>,
to
express
a
datatype:
</p>
<pre class="example">
{
...
  "@subject": "http://example.org/people#joebob",
<del class="diff-old">  "foaf:age": 
</del>
<ins class="diff-chg">  "age": <span class="diff">31</span>
</ins>
...
}
</pre>
<p>
The
example
above
would
generate
the
following
triple:
</p>
<pre class="example">
&lt;http://example.org/people#joebob&gt; 
   &lt;http://xmlns.com/foaf/0.1/age&gt; 
"31"^^&lt;http://www.w3.org/2001/XMLSchema#integer&gt;
.
</pre>
</div>
<div id="multiple-objects-for-a-single-property" class="section">
<h3>
<span class="secno">
3.7
</span>
Multiple
Objects
for
a
Single
Property
</h3>
<p>
A
JSON-LD
author
can
express
multiple
triples
in
a
compact
way
by
using
<del class="diff-old">arrays.
</del>
<a class="tref internalDFN" title="array" href="#dfn-array">
<ins class="diff-chg">array
</ins></a><ins class="diff-chg">
s.
</ins>
If
a
subject
has
multiple
values
for
the
same
property,
the
author
<em class="rfc2119" title="may">
may
</em>
express
each
property
as
an
<del class="diff-old">array.
</del>
<a class="tref internalDFN" title="array" href="#dfn-array">
<ins class="diff-chg">array
</ins></a>.
</p>
<p class="note">
In
JSON-LD,
Multiple
objects
on
a
property
are
not
ordered.
This
is
because
typically
graphs
are
not
inherently
ordered
data
structures.
To
see
more
on
creating
ordered
collections
in
JSON-LD,
see
<a href="#lists">
Lists
</a>.
</p>
<pre class="example">
{
...
  "@subject": "http://example.org/people#joebob",
<del class="diff-old">  "foaf:nick": ,
</del>
<ins class="diff-chg">  "nick": <span class="diff">["joe", "bob", "jaybee"]</span>,
</ins>
...
}
</pre>
<p>
The
markup
shown
above
would
generate
the
following
triples:
</p>
<pre class="example">
&lt;http://example.org/people#joebob&gt; 
   &lt;http://xmlns.com/foaf/0.1/nick&gt;
      "joe" .
&lt;http://example.org/people#joebob&gt; 
   &lt;http://xmlns.com/foaf/0.1/nick&gt;
      "bob" .
&lt;http://example.org/people#joebob&gt; 
   &lt;http://xmlns.com/foaf/0.1/nick&gt;
"jaybee"
.
</pre>
</div>
<div id="multiple-typed-literals-for-a-single-property" class="section">
<h3>
<span class="secno">
3.8
</span>
Multiple
Typed
Literals
for
a
Single
Property
</h3>
<p>
Multiple
<a class="tref internalDFN" title="typed_literal" href="#dfn-typed_literal">
typed
literal
</a>
s
may
also
be
expressed
using
the
expanded
form
for
objects:
</p>
<pre class="example">
{
...
  "@subject": "http://example.org/articles/8",
<del class="diff-old">  "dcterms:modified": 
</del>
<ins class="diff-chg">  "modified": <span class="diff">
</ins>
  [
    {
      "@literal": "2010-05-29T14:17:39+02:00",
<del class="diff-old">      "@datatype": "xsd:dateTime"
</del>
<ins class="diff-chg">      "@datatype": "dateTime"
</ins>
    },
    {
      "@literal": "2010-05-30T09:21:28-04:00",
<del class="diff-old">      "@datatype": "xsd:dateTime"
</del>
<ins class="diff-chg">      "@datatype": "dateTime"
</ins>
    }
  ]</span>
...
}
</pre>
<p>
The
markup
shown
above
would
generate
the
following
triples:
</p>
<pre class="example">
&lt;http://example.org/articles/8&gt; 
   &lt;http://purl.org/dc/terms/modified&gt;
      "2010-05-29T14:17:39+02:00"^^http://www.w3.org/2001/XMLSchema#dateTime .
&lt;http://example.org/articles/8&gt; 
   &lt;http://purl.org/dc/terms/modified&gt;
"2010-05-30T09:21:28-04:00"^^http://www.w3.org/2001/XMLSchema#dateTime
.
</pre>
</div>
<div id="expansion" class="section">
<h3>
<span class="secno">
3.9
</span>
Expansion
</h3>
<p>
Expansion
is
the
process
of
taking
a
JSON-LD
document
and
applying
a
context
such
that
all
IRI,
datatypes,
and
literal
values
are
expanded
so
that
the
context
is
no
longer
necessary.
JSON-LD
document
expansion
is
typically
used
when
re-mapping
JSON-LD
documents
to
application-specific
JSON
documents
or
as
a
part
of
the
<a href="#normalization">
Normalization
</a>
process.
</p>
<p>
For
example,
assume
the
following
JSON-LD
input
document:
</p>
<pre class="example">
{
   "name": "Manu Sporny",
   "homepage": "http://manu.sporny.org/",
   "@context": 
   {
      "name": "http://xmlns.com/foaf/0.1/name",
      "homepage": "http://xmlns.com/foaf/0.1/homepage",
      "@coerce": 
      {
         "@iri": "homepage"
      }
   }
}
</pre>
<p>
Running
the
JSON-LD
Expansion
algorithm
against
the
JSON-LD
input
document
provided
above
would
result
in
the
following
output:
</p>
<pre class="example">
{
   "http://xmlns.com/foaf/0.1/name": "Manu Sporny",
   "http://xmlns.com/foaf/0.1/homepage": 
   {
      "@iri": "http://manu.sporny.org/"
   }
}
</pre>
</div>
<div id="compaction" class="section">
<h3>
<span class="secno">
3.10
</span>
Compaction
</h3>
<p>
Compaction
is
the
process
of
taking
a
JSON-LD
document
and
applying
a
context
such
that
the
most
compact
form
of
the
document
is
generated.
JSON
is
typically
expressed
in
a
very
compact,
key-value
format.
That
is,
full
IRIs
are
rarely
used
as
keys.
At
times,
a
JSON-LD
document
may
be
received
that
is
not
in
its
most
compact
form.
JSON-LD,
via
the
API,
provides
a
way
to
compact
a
JSON-LD
document.
</p>
<p>
For
example,
assume
the
following
JSON-LD
input
document:
</p>
<pre class="example">
{
   "http://xmlns.com/foaf/0.1/name": "Manu Sporny",
   "http://xmlns.com/foaf/0.1/homepage": 
   {
      "@iri": "http://manu.sporny.org/"
   }
}
</pre>
<p>
Additionally,
assume
the
following
developer-supplied
JSON-LD
context:
</p>
<pre class="example">
{
   "name": "http://xmlns.com/foaf/0.1/name",
   "homepage": "http://xmlns.com/foaf/0.1/homepage",
   "@coerce": 
   {
      "@iri": ["homepage"]
   }
}
</pre>
<p>
Running
the
JSON-LD
Compaction
algorithm
given
the
context
supplied
above
against
the
JSON-LD
input
document
provided
above
would
result
in
the
following
output:
</p>
<pre class="example">
{
   "name": "Manu Sporny",
   "homepage": "http://manu.sporny.org/",
   "@context": 
   {
      "name": "http://xmlns.com/foaf/0.1/name",
      "homepage": "http://xmlns.com/foaf/0.1/homepage",
      "@coerce": 
      {
         "@iri": "homepage"
      }
   }
}
</pre>
<p>
The
compaction
algorithm
also
enables
the
developer
to
map
any
expanded
format
into
an
application-specific
compacted
format.
While
the
context
provided
above
mapped
<code>
http://xmlns.com/foaf/0.1/name
</code>
to
<strong>
name
</strong>,
it
could
have
also
mapped
it
to
any
arbitrary
string
provided
by
the
developer.
</p>
</div>
<div id="framing" class="section">
<h3>
<span class="secno">
3.11
</span>
Framing
</h3>
<p>
A
JSON-LD
document
is
a
representation
of
a
directed
graph.
A
single
directed
graph
can
have
many
different
serializations,
each
expressing
exactly
the
same
information.
Developers
typically
work
with
trees,
<del class="diff-old">also
called
associative
arrays,
when
dealing
with
JSON.
</del>
<ins class="diff-chg">represented
as
</ins><a class="tref internalDFN" title="JSON_object" href="#dfn-json_object"><ins class="diff-chg">
JSON
object
</ins></a><ins class="diff-chg">
s.
</ins>
While
mapping
a
graph
to
a
tree
can
be
done,
the
layout
of
the
end
result
must
be
specified
in
advance.
A
<dfn title="Frame" id="dfn-frame">
Frame
</dfn>
can
be
used
by
a
developer
on
a
JSON-LD
document
to
specify
a
deterministic
layout
for
a
graph.
</p>
<p>
Framing
is
the
process
of
taking
a
JSON-LD
document,
which
expresses
a
graph
of
information,
and
applying
a
specific
graph
layout
(called
a
<a class="tref internalDFN" title="Frame" href="#dfn-frame">
Frame
</a>
).
</p>
<p>
The
JSON-LD
document
below
expresses
a
library,
a
book
and
a
chapter:
</p>
<pre class="example">
{
<del class="diff-old">   "@coerce": {
    "dc":  "http://purl.org/dc/terms/",
    "ex":  "http://example.org/"
   },
   "@subject": 
   [{
      "@subject": "http://example.org/library",
      "@type": "ex:Library",
      "ex:contains": "http://example.org/library/the-republic"
   }, 
   {
      "@subject": "http://example.org/library/the-republic",
      "@type": "ex:Book",
      "dc:creator": "Plato",
      "dc:title": "The Republic",
      "ex:contains": "http://example.org/library/the-republic#introduction"
   }, 
   {
      "@subject": "http://example.org/library/the-republic#introduction",
      "@type": "ex:Chapter",
      "dc:description": "An introductory chapter on The Republic.",
      "dc:title": "The Introduction"
   }],
   "@context": 
   {
      "@coerce": 
      {
         "@iri": "ex:contains"
      },
      "dc": "http://purl.org/dc/elements/1.1/",
      "ex": "http://example.org/vocab#"
   }
</del>
<ins class="diff-chg">  "@coerce": {
    "Book":         "http://example.org/vocab#Book",
    "Chapter":      "http://example.org/vocab#Chapter",
    "contains":     "http://example.org/vocab#contains",
    "creator":      "http://purl.org/dc/terms/creator"
    "description":  "http://purl.org/dc/terms/description"
    "Library":      "http://example.org/vocab#Library",
    "title":        "http://purl.org/dc/terms/title",
    "@coerce": 
    {
      "@iri": "ex:contains"
    },
  },
  "@subject": 
  [{
    "@subject": "http://example.com/library",
    "@type": "Library",
    "contains": "http://example.org/library/the-republic"
  }, 
  {
    "@subject": "http://example.org/library/the-republic",
    "@type": "Book",
    "creator": "Plato",
    "title": "The Republic",
    "contains": "http://example.org/library/the-republic#introduction"
  }, 
  {
    "@subject": "http://example.org/library/the-republic#introduction",
    "@type": "Chapter",
    "description": "An introductory chapter on The Republic.",
    "title": "The Introduction"
  }]
</ins>
}
</pre>
<p>
Developers
typically
like
to
operate
on
items
in
a
hierarchical,
tree-based
fashion.
Ideally,
a
developer
would
want
the
data
above
sorted
into
top-level
libraries,
then
the
books
that
are
contained
in
each
library,
and
then
the
chapters
contained
in
each
book.
To
achieve
that
layout,
the
developer
can
define
the
following
<a class="tref internalDFN" title="frame" href="#dfn-frame">
frame
</a>:
</p>
<pre class="example">
{
<del class="diff-old">   "@context": {
      "dc": "http://purl.org/dc/elements/1.1/",
      "ex": "http://example.org/vocab#"
   },
   "@type": "ex:Library",
   "ex:contains": {
      "@type": "ex:Book",
      "ex:contains": {
         "@type": "ex:Chapter"
      }
   }
</del>
<ins class="diff-chg">  "@context": {
    "Book":         "http://example.org/vocab#Book",
    "Chapter":      "http://example.org/vocab#Chapter",
    "contains":     "http://example.org/vocab#contains",
    "creator":      "http://purl.org/dc/terms/creator"
    "description":  "http://purl.org/dc/terms/description"
    "Library":      "http://example.org/vocab#Library",
    "title":        "http://purl.org/dc/terms/title"
  },
  "@type": "Library",
  "contains": {
    "@type": "Book",
    "contains": {
      "@type": "Chapter"
    }
  }
</ins>
}
</pre>
<p>
When
the
framing
algorithm
is
run
against
the
previously
defined
JSON-LD
document,
paired
with
the
<a class="tref internalDFN" title="frame" href="#dfn-frame">
frame
</a>
above,
the
following
JSON-LD
document
is
the
end
result:
</p>
<pre class="example">
{
<del class="diff-old">   "@context": 
   {
      "ex": "http://example.org/vocab#",
      "dc":  "http://purl.org/dc/terms/",
   }
   "@subject": "http://example.org/library",
   "@type": "ex:Library",
   "ex:contains": 
   {
      "@subject": "http://example.org/library/the-republic",
      "@type": "ex:Book",
      "dc:creator": "Plato",
      "dc:title": "The Republic",
      "ex:contains": 
      {
         "@subject": "http://example.org/library/the-republic#introduction",
         "@type": "ex:Chapter",
         "dc:description": "An introductory chapter on The Republic.",
         "dc:title": "The Introduction"
      },
   },
</del>
<ins class="diff-chg">  "@context": {
    "Book":         "http://example.org/vocab#Book",
    "Chapter":      "http://example.org/vocab#Chapter",
    "contains":     "http://example.org/vocab#contains",
    "creator":      "http://purl.org/dc/terms/creator"
    "description":  "http://purl.org/dc/terms/description"
    "Library":      "http://example.org/vocab#Library",
    "title":        "http://purl.org/dc/terms/title"
  },
  "@subject": "http://example.org/library",
  "@type": "Library",
  "contains": {
</ins>    <span class="diff">"@subject": "http://example.org/library/the-republic",</span><ins class="diff-chg">
    "@type": "Book",
</ins>    <span class="diff">"creator": "Plato",</span>    <span class="diff">"title": "The Republic",</span><ins class="diff-chg">
    "contains": {
</ins>      <span class="diff">"@subject": "http://example.org/library/the-republic#introduction",</span><ins class="diff-chg">
      "@type": "Chapter",
</ins>      <span class="diff">"description": "An introductory chapter on The Republic.",</span>      <span class="diff">"title": "The Introduction"</span><ins class="diff-chg">
    },
  },
</ins>
}
</pre>
<p>
The
JSON-LD
framing
algorithm
allows
developers
to
query
by
example
and
force
a
specific
tree
layout
to
a
JSON-LD
document.
</p>
</div>
</div>
<div id="advanced-concepts" class="section">
<h2>
<span class="secno">
4.
</span>
Advanced
Concepts
</h2>
<p>
JSON-LD
has
a
number
of
features
that
provide
functionality
above
and
beyond
the
core
functionality
described
above.
The
following
sections
outline
the
features
that
are
specific
to
JSON-LD.
</p>
<div id="curies" class="section">
<h3>
<span class="secno">
4.1
</span>
<ins class="diff-new">CURIEs
</ins></h3><p><ins class="diff-new">
Concepts
in
Linked
Data
documents
may
draw
on
a
number
of
different
vocabularies.
The
@vocab
mechanism
is
useful
to
easily
associate
types
and
properties
with
a
specific
vocabulary,
but
when
many
vocabularies
are
used,
this
becomes
difficult.
Consider
the
following
example:
</ins></p>  <pre class="example"><ins class="diff-new">
{
  "@context": {
</ins>    <span class="diff">"dc": "http://purl.org/dc/elements/1.1/",</span>    <span class="diff">"ex": "http://example.org/vocab#"</span><ins class="diff-new">
  },
  "@subject": "http://example.org/library",
  "@type": <span class="diff">"ex:Library"</span>,
</ins>  <span class="diff">"ex:contains"</span>: {<ins class="diff-new">
    "@subject": "http://example.org/library/the-republic",
    "@type": <span class="diff">"ex:Book"</span>,
</ins>    <span class="diff">"dc:creator"</span>: "Plato",    <span class="diff">"dc:title"</span>: "The Republic",    <span class="diff">"ex:contains"</span>: {<ins class="diff-new">
      "@subject": "http://example.org/library/the-republic#introduction",
      "@type": <span class="diff">"ex:Chapter"</span>,
</ins>      <span class="diff">"dc:description"</span>: "An introductory chapter on The Republic.",      <span class="diff">"dc:title"</span>: "The Introduction"<ins class="diff-new">
    },
  },
}
</ins></pre><p><ins class="diff-new">
In
this
example,
two
different
vocabularies
are
identified
with
prefixes,
and
used
as
type
and
property
values
using
the
CURIE
notation.
</ins></p><p><ins class="diff-new">
A
</ins><dfn title="CURIE" id="dfn-curie"><ins class="diff-new">
CURIE
</ins></dfn><ins class="diff-new">
is
a
compact
way
of
describing
an
</ins><a class="tref internalDFN" title="IRI" href="#dfn-iri"><ins class="diff-new">
IRI
</ins></a>.<ins class="diff-new">
The
term
actually
comes
from
Compact
URI.
Generally,
a
CURIE
is
composed
of
a
</ins><em><ins class="diff-new">
prefix
</ins></em><ins class="diff-new">
and
a
</ins><em><ins class="diff-new">
suffix
</ins></em><ins class="diff-new">
separated
by
a
':'.
In
JSON-LD,
the
prefix
may
be
the
empty
string,
denoting
the
</ins><dfn title="default_prefix" id="dfn-default_prefix"><ins class="diff-new">
default
prefix
</ins></dfn>.</p><p><ins class="diff-new">
CURIEs
are
defined
more
formally
in
[
</ins><cite><a class="bibref" rel="biblioentry" href="#bib-RDFA-CORE"><ins class="diff-new">
RDFA-CORE
</ins></a></cite><ins class="diff-new">
]
</ins><cite><a href="http://www.w3.org/TR/rdfa-core/#s_curies"><ins class="diff-new">
section
6
"CURIE
Syntax
Definition"
</ins></a></cite>.</p></div><div id="automatic-typing" class="section"><h3><span class="secno"><ins class="diff-new">
4.2
</ins></span>
Automatic
Typing
</h3>
<p>
Since
JSON
is
capable
of
expressing
typed
information
such
as
doubles,
integers,
and
boolean
values.
As
demonstrated
below,
JSON-LD
utilizes
that
information
to
create
<a class="tref internalDFN" title="typed_literal" href="#dfn-typed_literal">
typed
literal
</a>
s:
</p>
<pre class="example">
{
...
  // The following two values are automatically converted to a type of xsd:double
  // and both values are equivalent to each other.
  "measure:cups": <span class="diff">5.3</span>,
  "measure:cups": <span class="diff">5.3e0</span>,
  // The following value is automatically converted to a type of xsd:double as well
  "space:astronomicUnits": <span class="diff">6.5e73</span>,
  // The following value should never be converted to a language-native type
  "measure:stones": <span class="diff">{ "@literal": "4.8", "@datatype": "xsd:decimal" }</span>,
  // This value is automatically converted to having a type of xsd:integer
  "chem:protons": <span class="diff">12</span>,
  // This value is automatically converted to having a type of xsd:boolean
  "sensor:active": <span class="diff">true</span>,
...
}
</pre>
<p class="note">
When
dealing
with
a
number
of
modern
programming
languages,
including
JavaScript
ECMA-262,
there
is
no
distinction
between
<strong>
xsd:decimal
</strong>
and
<strong>
xsd:double
</strong>
values.
That
is,
the
<a class="tref internalDFN" title="number" href="#dfn-number">
number
</a>
<code>
5.3
</code>
and
the
<a class="tref internalDFN" title="number" href="#dfn-number">
number
</a>
<code>
5.3e0
</code>
are
treated
as
if
they
were
the
same.
When
converting
from
JSON-LD
to
a
language-native
format
and
back,
datatype
information
is
lost
in
a
number
of
these
languages.
Thus,
one
could
say
that
<code>
5.3
</code>
is
a
<strong>
xsd:decimal
</strong>
and
<code>
5.3e0
</code>
is
an
<strong>
xsd:double
</strong>
in
JSON-LD,
but
when
both
values
are
converted
to
a
language-native
format
the
datatype
difference
between
the
two
is
lost
because
the
machine-level
representation
will
almost
always
be
a
<strong>
double
</strong>.
Implementers
should
be
aware
of
this
potential
round-tripping
issue
between
<strong>
xsd:decimal
</strong>
and
<strong>
xsd:double
</strong>.
Specifically
objects
with
a
datatype
of
<strong>
xsd:decimal
</strong>
<em class="rfc2119" title="must not">
must
not
</em>
be
converted
to
a
language
native
type.
</p>
</div>
<div id="type-coercion" class="section">
<h3>
<span class="secno">
<del class="diff-old">4.2
</del>
<ins class="diff-chg">4.3
</ins>
</span>
Type
Coercion
</h3>
<p>
JSON-LD
supports
the
coercion
of
values
to
particular
data
types.
Type
coercion
allows
someone
deploying
JSON-LD
to
coerce
the
incoming
or
outgoing
types
to
the
proper
data
type
based
on
a
mapping
of
data
type
IRIs
to
property
types.
Using
type
coercion,
one
may
convert
simple
JSON
data
to
properly
typed
RDF
data.
</p>
<p>
The
example
below
demonstrates
how
a
JSON-LD
author
can
coerce
values
to
<a class="tref internalDFN" title="plain_literal" href="#dfn-plain_literal">
plain
literal
</a>
s,
<a class="tref internalDFN" title="typed_literal" href="#dfn-typed_literal">
typed
literal
</a>
s
and
IRIs.
</p>
<pre class="example">
{
  "@context": 
  {  
     "rdf": "http://www.w3.org/1999/02/22-rdf-syntax-ns#",
     "xsd": "http://www.w3.org/2001/XMLSchema#",
     "name": "http://xmlns.com/foaf/0.1/name",
     "age": "http://xmlns.com/foaf/0.1/age",
     "homepage": "http://xmlns.com/foaf/0.1/homepage",
<span class="diff">     "@coerce":
     {
        "xsd:integer": "age",
        "@iri": "homepage"
     }</span>
  },
  "name": "John Smith",
  "age": <span class="diff">"41"</span>,
  "homepage": <span class="diff">"http://example.org/home/"</span>
}
</pre>
<p>
The
example
above
would
generate
the
following
triples:
</p>
<pre class="example">
_:bnode1
   &lt;http://xmlns.com/foaf/0.1/name&gt;
      "John Smith" .
_:bnode1
   &lt;http://xmlns.com/foaf/0.1/age&gt;
      "41"^^http://www.w3.org/2001/XMLSchema#integer .
_:bnode1
   &lt;http://xmlns.com/foaf/0.1/homepage&gt;
&lt;http://example.org/home/&gt;
.
</pre>
</div>
<div id="chaining" class="section">
<h3>
<span class="secno">
<del class="diff-old">4.3
</del>
<ins class="diff-chg">4.4
</ins>
</span>
Chaining
</h3>
<p>
Object
<dfn title="chaining" id="dfn-chaining">
chaining
</dfn>
is
a
JSON-LD
feature
that
allows
an
author
to
use
the
definition
of
JSON-LD
objects
as
<a class="tref internalDFN" title="property" href="#dfn-property">
property
</a>
values.
This
is
a
commonly
used
mechanism
for
creating
a
parent-child
relationship
between
two
<a class="tref internalDFN" title="subject" href="#dfn-subject">
subject
</a>
s.
</p>
<p>
The
example
shows
an
two
subjects
related
by
a
property
from
the
first
subject:
</p>
  <pre class="example">
{
...
<del class="diff-old">  "foaf:name": "Manu Sporny",
  "": {
    "",
    "",
</del>
<ins class="diff-chg">  "name": "Manu Sporny",
  "<span class="diff">knows</span>": {
    "<span class="diff">@type</span>": "<span class="diff">Person</span>",
    "<span class="diff">name</span>": "<span class="diff">Gregg Kellogg</span>",
</ins>
  }
...
}
</pre>
<p>
An
object
definition,
like
the
one
used
above,
<em class="rfc2119" title="may">
may
</em>
be
used
as
a
JSON
value
at
any
point
in
JSON-LD.
</p>
</div>
<div id="identifying-unlabeled-nodes" class="section">
<h3>
<span class="secno">
<del class="diff-old">4.4
</del>
<ins class="diff-chg">4.5
</ins>
</span>
Identifying
Unlabeled
Nodes
</h3>
<p>
At
times,
it
becomes
necessary
to
be
able
to
express
information
without
being
able
to
specify
the
subject.
Typically,
this
type
of
node
is
called
an
unlabeled
node
or
a
blank
node.
In
JSON-LD,
unlabeled
node
identifiers
are
automatically
created
if
a
subject
is
not
specified
using
the
<code>
@subject
</code>
keyword.
However,
authors
may
provide
identifiers
for
unlabeled
nodes
by
using
the
special
<code>
_
</code>
(underscore)
<a class="tref internalDFN" title="CURIE" href="#dfn-curie">
CURIE
</a>
prefix.
</p>
<pre class="example">
{
...
  "@subject": "<span class="diff">_:foo</span>",
...
}
</pre>
<p>
The
example
above
would
set
the
subject
to
<code>
_:foo
</code>,
which
can
then
be
used
later
on
in
the
JSON-LD
markup
to
refer
back
to
the
unlabeled
node.
This
practice,
however,
is
usually
frowned
upon
when
generating
Linked
Data.
If
a
developer
finds
that
they
refer
to
the
unlabeled
node
more
than
once,
they
should
consider
naming
the
node
using
a
resolve-able
IRI.
</p>
</div>
<div id="overriding-keywords" class="section">
<h3>
<span class="secno">
<del class="diff-old">4.5
</del>
<ins class="diff-chg">4.6
</ins>
</span>
Overriding
Keywords
</h3>
<p>
JSON-LD
allows
all
of
the
syntax
keywords,
except
for
<code>
@context
</code>,
to
be
overridden.
This
feature
allows
more
legacy
JSON
content
to
be
supported
by
JSON-LD.
It
also
allows
developers
to
design
domain-specific
implementations
using
only
the
JSON-LD
context.
</p>
<pre class="example">
{
  "@context": 
  {  
     <span class="diff">"url": "@subject"</span>,
     <span class="diff">"a": "@type"</span>,
     "name": "http://schema.org/name"
  },
  "url": "http://example.com/about#gregg",
  "a": "http://schema.org/Person",
  "name": "Gregg Kellogg"
}
</pre>
<p>
In
the
example
above,
the
<code>
@subject
</code>
and
<code>
@type
</code>
keywords
have
been
overridden
by
<strong>
url
</strong>
and
<strong>
a
</strong>,
respectively.
</p>
</div>
<div id="normalization" class="section">
<h3>
<span class="secno">
<del class="diff-old">4.6
</del>
<ins class="diff-chg">4.7
</ins>
</span>
Normalization
</h3>
<p>
Normalization
is
the
process
of
taking
<a class="tref internalDFN" title="JSON-LD_input" href="#dfn-json-ld_input">
JSON-LD
input
</a>
and
performing
a
deterministic
transformation
on
that
input
that
results
in
a
<a class="tref internalDFN" title="JSON-LD_output" href="#dfn-json-ld_output">
JSON-LD
output
</a>
that
any
conforming
JSON-LD
processor
would
have
generated
given
the
same
input.
The
problem
is
a
fairly
difficult
technical
problem
to
solve
because
it
requires
a
directed
graph
to
be
ordered
into
a
set
of
nodes
and
edges
in
a
deterministic
way.
This
is
easy
to
do
when
all
of
the
nodes
have
unique
names,
but
very
difficult
to
do
when
some
of
the
nodes
are
not
labeled.
</p>
<p>
Normalization
is
useful
when
comparing
two
graphs
against
one
another,
when
generating
a
detailed
list
of
differences
between
two
graphs,
and
when
generating
a
cryptographic
digital
signature
for
information
contained
in
a
graph
or
when
generating
a
hash
of
the
information
contained
in
a
graph.
</p>
<p>
The
example
below
is
an
un-normalized
JSON-LD
document:
</p>
<pre class="example">
{
   "name": "Manu Sporny",
   "homepage": "http://manu.sporny.org/",
   "@context": 
   {
      "name": "http://xmlns.com/foaf/0.1/name",
      "homepage": "http://xmlns.com/foaf/0.1/homepage",
      "xsd": "http://www.w3.org/2001/XMLSchema#",
      "@coerce": 
      {
         "@iri": ["homepage"]
      }
   }
}
</pre>
<p>
The
example
below
is
the
normalized
form
of
the
JSON-LD
document
above:
</p>
<p class="note">
Whitespace
is
used
below
to
aid
readability.
The
normalization
algorithm
for
JSON-LD
remove
all
unnecessary
whitespace
in
the
fully
normalized
form.
</p>
<pre class="example">
[{
    "@subject": 
    {
        "@iri": "_:c14n0"
    },
    "http://xmlns.com/foaf/0.1/homepage": 
    {
        "@iri": "http://manu.sporny.org/"
    },
    "http://xmlns.com/foaf/0.1/name": "Manu Sporny"
}]
</pre>
<p>
Notice
how
all
of
the
<a class="tref internalDFN" title="term" href="#dfn-term">
term
</a>
s
have
been
expanded
and
sorted
in
alphabetical
order.
Also,
notice
how
the
<a class="tref internalDFN" title="subject" href="#dfn-subject">
subject
</a>
has
been
labeled
with
a
<a class="tref internalDFN" title="blank_node_identifier" href="#dfn-blank_node_identifier-7">
blank
node
identifier
</a>.
Normalization
ensures
that
any
arbitrary
graph
containing
exactly
the
same
information
would
be
normalized
to
exactly
the
same
form
shown
above.
</p>
</div>
</div>
<div id="the-application-programming-interface" class="section">
<h2>
<span class="secno">
5.
</span>
<ins class="diff-new">The
Application
Programming
Interface
</ins></h2><p><ins class="diff-new">
This
API
provides
a
clean
mechanism
that
enables
developers
to
convert
JSON-LD
data
into
a
a
variety
of
output
formats
that
are
easier
to
work
with
in
various
programming
languages.
If
an
API
is
provided
in
a
programming
environment,
the
entire
API
</ins><em class="rfc2119" title="must"><ins class="diff-new">
must
</ins></em><ins class="diff-new">
be
implemented.
</ins></p><div id="jsonldprocessor" class="section"><h3><span class="secno"><ins class="diff-new">
5.1
</ins></span><ins class="diff-new">
JSONLDProcessor
</ins></h3><pre class="idl"><span class="idlInterface" id="idl-def-JSONLDProcessor">[<span class="extAttr">NoInterfaceObject</span>]<ins class="diff-new">
interface <span class="idlInterfaceID">JSONLDProcessor</span> {
</ins><span class="idlMethod">    <span class="idlMethType"><a>object</a></span> <span class="idlMethName"><a href="#widl-JSONLDProcessor-expand-object-object-input-JSONLDProcessorCallback-callback">expand</a></span> (<span class="idlParam">in <span class="idlParamType"><a>object</a></span> <span class="idlParamName">input</span></span>, <span class="idlParam">in optional <span class="idlParamType"><a href="#idl-def-JSONLDProcessorCallback" class="idlType"><code>JSONLDProcessorCallback</code></a>?</span> <span class="idlParamName">callback</span></span>);</span><span class="idlMethod">    <span class="idlMethType"><a>object</a></span> <span class="idlMethName"><a href="#widl-JSONLDProcessor-compact-object-object-input-object-context-JSONLDProcessorCallback-callback">compact</a></span> (<span class="idlParam">in <span class="idlParamType"><a>object</a></span> <span class="idlParamName">input</span></span>, <span class="idlParam">in <span class="idlParamType"><a>object</a></span> <span class="idlParamName">context</span></span>, <span class="idlParam">in optional <span class="idlParamType"><a href="#idl-def-JSONLDProcessorCallback" class="idlType"><code>JSONLDProcessorCallback</code></a>?</span> <span class="idlParamName">callback</span></span>);</span><span class="idlMethod">    <span class="idlMethType"><a>object</a></span> <span class="idlMethName"><a href="#widl-JSONLDProcessor-frame-object-object-input-object-frame-object-options-JSONLDProcessorCallback-callback">frame</a></span> (<span class="idlParam">in <span class="idlParamType"><a>object</a></span> <span class="idlParamName">input</span></span>, <span class="idlParam">in <span class="idlParamType"><a>object</a></span> <span class="idlParamName">frame</span></span>, <span class="idlParam">in <span class="idlParamType"><a>object</a></span> <span class="idlParamName">options</span></span>, <span class="idlParam">in optional <span class="idlParamType"><a href="#idl-def-JSONLDProcessorCallback" class="idlType"><code>JSONLDProcessorCallback</code></a>?</span> <span class="idlParamName">callback</span></span>);</span><span class="idlMethod">    <span class="idlMethType"><a>object</a></span> <span class="idlMethName"><a href="#widl-JSONLDProcessor-normalize-object-object-input-JSONLDProcessorCallback-callback">normalize</a></span> (<span class="idlParam">in <span class="idlParamType"><a>object</a></span> <span class="idlParamName">input</span></span>, <span class="idlParam">in optional <span class="idlParamType"><a href="#idl-def-JSONLDProcessorCallback" class="idlType"><code>JSONLDProcessorCallback</code></a>?</span> <span class="idlParamName">callback</span></span>);</span><span class="idlMethod">    <span class="idlMethType"><a>object</a></span> <span class="idlMethName"><a href="#widl-JSONLDProcessor-triples-object-object-input-JSONLDTripleCallback-tripleCallback-JSONLDProcessorCallback-parserCallback">triples</a></span> (<span class="idlParam">in <span class="idlParamType"><a>object</a></span> <span class="idlParamName">input</span></span>, <span class="idlParam">in <span class="idlParamType"><a href="#idl-def-JSONLDTripleCallback" class="idlType"><code>JSONLDTripleCallback</code></a></span> <span class="idlParamName">tripleCallback</span></span>, <span class="idlParam">in optional <span class="idlParamType"><a href="#idl-def-JSONLDProcessorCallback" class="idlType"><code>JSONLDProcessorCallback</code></a>?</span> <span class="idlParamName">parserCallback</span></span>);</span><ins class="diff-new">
};</span>
</ins></pre><div id="methods" class="section"><h4><span class="secno"><ins class="diff-new">
5.1.1
</ins></span><ins class="diff-new">
Methods
</ins></h4><dl class="methods"><dt id="widl-JSONLDProcessor-compact-object-object-input-object-context-JSONLDProcessorCallback-callback"><code><ins class="diff-new">
compact
</ins></code></dt><dd><a href="#compaction"><ins class="diff-new">
Compacts
</ins></a><ins class="diff-new">
the
given
</ins><code><ins class="diff-new">
input
</ins></code><ins class="diff-new">
according
to
the
steps
in
the
</ins><a href="#compaction-algorithm"><ins class="diff-new">
Compaction
Algorithm
</ins></a>.<ins class="diff-new">
The
</ins><code><ins class="diff-new">
input
</ins></code><em class="rfc2119" title="must"><ins class="diff-new">
must
</ins></em><ins class="diff-new">
be
copied,
compacted
and
returned
if
there
are
no
errors.
If
the
compaction
fails,
</ins><code><ins class="diff-new">
null
</ins></code><em class="rfc2119" title="must"><ins class="diff-new">
must
</ins></em><ins class="diff-new">
be
returned.
</ins><table class="parameters"><tr><th><ins class="diff-new">
Parameter
</ins></th><th><ins class="diff-new">
Type
</ins></th><th><ins class="diff-new">
Nullable
</ins></th><th><ins class="diff-new">
Optional
</ins></th><th><ins class="diff-new">
Description
</ins></th></tr><tr><td class="prmName"><ins class="diff-new">
input
</ins></td><td class="prmType"><code><a><ins class="diff-new">
object
</ins></a></code></td><td class="prmNullFalse"><ins class="diff-new">
✘
</ins></td><td class="prmOptFalse"><ins class="diff-new">
✘
</ins></td><td class="prmDesc"><ins class="diff-new">
The
JSON-LD
object
to
perform
compaction
on.
</ins></td></tr><tr><td class="prmName"><ins class="diff-new">
context
</ins></td><td class="prmType"><code><a><ins class="diff-new">
object
</ins></a></code></td><td class="prmNullFalse"><ins class="diff-new">
✘
</ins></td><td class="prmOptFalse"><ins class="diff-new">
✘
</ins></td><td class="prmDesc"><ins class="diff-new">
The
base
context
to
use
when
compacting
the
</ins><code><ins class="diff-new">
input
</ins></code>.</td></tr><tr><td class="prmName"><ins class="diff-new">
callback
</ins></td><td class="prmType"><code><a href="#idl-def-JSONLDProcessorCallback" class="idlType"><code><ins class="diff-new">
JSONLDProcessorCallback
</ins></code></a></code></td><td class="prmNullTrue"><ins class="diff-new">
✔
</ins></td><td class="prmOptTrue"><ins class="diff-new">
✔
</ins></td><td class="prmDesc"><ins class="diff-new">
A
callback
that
is
called
whenever
a
processing
error
occurs
on
the
given
</ins><code><ins class="diff-new">
input
</ins></code>.</td></tr></table><div><em><ins class="diff-new">
No
exceptions.
</ins></em></div><div><em><ins class="diff-new">
Return
type:
</ins></em><code><a><ins class="diff-new">
object
</ins></a></code></div></dd><dt id="widl-JSONLDProcessor-expand-object-object-input-JSONLDProcessorCallback-callback"><code><ins class="diff-new">
expand
</ins></code></dt><dd><a href="#expansion"><ins class="diff-new">
Expands
</ins></a><ins class="diff-new">
the
given
</ins><code><ins class="diff-new">
input
</ins></code><ins class="diff-new">
according
to
the
steps
in
the
</ins><a href="#expansion-algorithm"><ins class="diff-new">
Expansion
Algorithm
</ins></a>.<ins class="diff-new">
The
</ins><code><ins class="diff-new">
input
</ins></code><em class="rfc2119" title="must"><ins class="diff-new">
must
</ins></em><ins class="diff-new">
be
copied,
expanded
and
returned
if
there
are
no
errors.
If
the
expansion
fails,
</ins><code><ins class="diff-new">
null
</ins></code><em class="rfc2119" title="must"><ins class="diff-new">
must
</ins></em><ins class="diff-new">
be
returned.
</ins><div class="issue"><ins class="diff-new">
How
do
we
generate
warning
messages
during
this
process?
For
example,
what
happens
when
a
key
that
doesn't
have
a
mapping
is
discovered?
</ins></div><table class="parameters"><tr><th><ins class="diff-new">
Parameter
</ins></th><th><ins class="diff-new">
Type
</ins></th><th><ins class="diff-new">
Nullable
</ins></th><th><ins class="diff-new">
Optional
</ins></th><th><ins class="diff-new">
Description
</ins></th></tr><tr><td class="prmName"><ins class="diff-new">
input
</ins></td><td class="prmType"><code><a><ins class="diff-new">
object
</ins></a></code></td><td class="prmNullFalse"><ins class="diff-new">
✘
</ins></td><td class="prmOptFalse"><ins class="diff-new">
✘
</ins></td><td class="prmDesc"><ins class="diff-new">
The
JSON-LD
object
to
copy
and
perform
the
expansion
upon.
</ins></td></tr><tr><td class="prmName"><ins class="diff-new">
callback
</ins></td><td class="prmType"><code><a href="#idl-def-JSONLDProcessorCallback" class="idlType"><code><ins class="diff-new">
JSONLDProcessorCallback
</ins></code></a></code></td><td class="prmNullTrue"><ins class="diff-new">
✔
</ins></td><td class="prmOptTrue"><ins class="diff-new">
✔
</ins></td><td class="prmDesc"><ins class="diff-new">
A
callback
that
is
called
whenever
a
processing
error
occurs
on
the
</ins><code><ins class="diff-new">
input
</ins></code>.</td></tr></table><div><em><ins class="diff-new">
No
exceptions.
</ins></em></div><div><em><ins class="diff-new">
Return
type:
</ins></em><code><a><ins class="diff-new">
object
</ins></a></code></div></dd><dt id="widl-JSONLDProcessor-frame-object-object-input-object-frame-object-options-JSONLDProcessorCallback-callback"><code><ins class="diff-new">
frame
</ins></code></dt><dd><a href="#framing"><ins class="diff-new">
Frames
</ins></a><ins class="diff-new">
the
given
</ins><code><ins class="diff-new">
input
</ins></code><ins class="diff-new">
using
the
</ins><code><ins class="diff-new">
frame
</ins></code><ins class="diff-new">
according
to
the
steps
in
the
</ins><a href="#framing-algorithm"><ins class="diff-new">
Framing
Algorithm
</ins></a>.<ins class="diff-new">
The
</ins><code><ins class="diff-new">
input
</ins></code><ins class="diff-new">
is
used
to
build
the
framed
output
and
is
returned
if
there
are
no
errors.
Exceptions
are
thrown
if
there
are
errors.
</ins><div class="issue"><ins class="diff-new">
Define
what
the
exceptions
are.
We
need
to
specify
whether
or
not
we
want
exceptions
thrown,
or
errors
returned
to
the
error
callback?
</ins></div><table class="parameters"><tr><th><ins class="diff-new">
Parameter
</ins></th><th><ins class="diff-new">
Type
</ins></th><th><ins class="diff-new">
Nullable
</ins></th><th><ins class="diff-new">
Optional
</ins></th><th><ins class="diff-new">
Description
</ins></th></tr><tr><td class="prmName"><ins class="diff-new">
input
</ins></td><td class="prmType"><code><a><ins class="diff-new">
object
</ins></a></code></td><td class="prmNullFalse"><ins class="diff-new">
✘
</ins></td><td class="prmOptFalse"><ins class="diff-new">
✘
</ins></td><td class="prmDesc"><ins class="diff-new">
The
JSON-LD
object
to
perform
framing
on.
</ins></td></tr><tr><td class="prmName"><ins class="diff-new">
frame
</ins></td><td class="prmType"><code><a><ins class="diff-new">
object
</ins></a></code></td><td class="prmNullFalse"><ins class="diff-new">
✘
</ins></td><td class="prmOptFalse"><ins class="diff-new">
✘
</ins></td><td class="prmDesc"><ins class="diff-new">
The
frame
to
use
when
re-arranging
the
data.
</ins></td></tr><tr><td class="prmName"><ins class="diff-new">
options
</ins></td><td class="prmType"><code><a><ins class="diff-new">
object
</ins></a></code></td><td class="prmNullFalse"><ins class="diff-new">
✘
</ins></td><td class="prmOptFalse"><ins class="diff-new">
✘
</ins></td><td class="prmDesc"><ins class="diff-new">
A
set
of
options
that
will
affect
the
framing
algorithm.
</ins></td></tr><tr><td class="prmName"><ins class="diff-new">
callback
</ins></td><td class="prmType"><code><a href="#idl-def-JSONLDProcessorCallback" class="idlType"><code><ins class="diff-new">
JSONLDProcessorCallback
</ins></code></a></code></td><td class="prmNullTrue"><ins class="diff-new">
✔
</ins></td><td class="prmOptTrue"><ins class="diff-new">
✔
</ins></td><td class="prmDesc"><ins class="diff-new">
A
callback
that
is
called
whenever
a
processing
error
occurs
on
the
given
</ins><code><ins class="diff-new">
input
</ins></code>.</td></tr></table><div><em><ins class="diff-new">
No
exceptions.
</ins></em></div><div><em><ins class="diff-new">
Return
type:
</ins></em><code><a><ins class="diff-new">
object
</ins></a></code></div></dd><dt id="widl-JSONLDProcessor-normalize-object-object-input-JSONLDProcessorCallback-callback"><code><ins class="diff-new">
normalize
</ins></code></dt><dd><a href="#normalization"><ins class="diff-new">
Normalizes
</ins></a><ins class="diff-new">
the
given
</ins><code><ins class="diff-new">
input
</ins></code><ins class="diff-new">
according
to
the
steps
in
the
</ins><a href="#normalization-algorithm"><ins class="diff-new">
Normalization
Algorithm
</ins></a>.<ins class="diff-new">
The
</ins><code><ins class="diff-new">
input
</ins></code><em class="rfc2119" title="must"><ins class="diff-new">
must
</ins></em><ins class="diff-new">
be
copied,
normalized
and
returned
if
there
are
no
errors.
If
the
compaction
fails,
</ins><code><ins class="diff-new">
null
</ins></code><em class="rfc2119" title="must"><ins class="diff-new">
must
</ins></em><ins class="diff-new">
be
returned.
</ins><table class="parameters"><tr><th><ins class="diff-new">
Parameter
</ins></th><th><ins class="diff-new">
Type
</ins></th><th><ins class="diff-new">
Nullable
</ins></th><th><ins class="diff-new">
Optional
</ins></th><th><ins class="diff-new">
Description
</ins></th></tr><tr><td class="prmName"><ins class="diff-new">
input
</ins></td><td class="prmType"><code><a><ins class="diff-new">
object
</ins></a></code></td><td class="prmNullFalse"><ins class="diff-new">
✘
</ins></td><td class="prmOptFalse"><ins class="diff-new">
✘
</ins></td><td class="prmDesc"><ins class="diff-new">
The
JSON-LD
object
to
perform
normalization
upon.
</ins></td></tr><tr><td class="prmName"><ins class="diff-new">
callback
</ins></td><td class="prmType"><code><a href="#idl-def-JSONLDProcessorCallback" class="idlType"><code><ins class="diff-new">
JSONLDProcessorCallback
</ins></code></a></code></td><td class="prmNullTrue"><ins class="diff-new">
✔
</ins></td><td class="prmOptTrue"><ins class="diff-new">
✔
</ins></td><td class="prmDesc"><ins class="diff-new">
A
callback
that
is
called
whenever
a
processing
error
occurs
on
the
given
JSON-LD
string.
</ins></td></tr></table><div><em><ins class="diff-new">
No
exceptions.
</ins></em></div><div><em><ins class="diff-new">
Return
type:
</ins></em><code><a><ins class="diff-new">
object
</ins></a></code></div></dd><dt id="widl-JSONLDProcessor-triples-object-object-input-JSONLDTripleCallback-tripleCallback-JSONLDProcessorCallback-parserCallback"><code><ins class="diff-new">
triples
</ins></code></dt><dd><ins class="diff-new">
Processes
the
</ins><code><ins class="diff-new">
input
</ins></code><ins class="diff-new">
according
to
the
</ins><a href="#rdf-conversion-algorithm"><ins class="diff-new">
RDF
Conversion
Algorithm
</ins></a>,<ins class="diff-new">
calling
the
provided
</ins><code><ins class="diff-new">
tripleCallback
</ins></code><ins class="diff-new">
for
each
triple
generated.
</ins><table class="parameters"><tr><th><ins class="diff-new">
Parameter
</ins></th><th><ins class="diff-new">
Type
</ins></th><th><ins class="diff-new">
Nullable
</ins></th><th><ins class="diff-new">
Optional
</ins></th><th><ins class="diff-new">
Description
</ins></th></tr><tr><td class="prmName"><ins class="diff-new">
input
</ins></td><td class="prmType"><code><a><ins class="diff-new">
object
</ins></a></code></td><td class="prmNullFalse"><ins class="diff-new">
✘
</ins></td><td class="prmOptFalse"><ins class="diff-new">
✘
</ins></td><td class="prmDesc"><ins class="diff-new">
The
JSON-LD
object
to
process
when
outputting
triples.
</ins></td></tr><tr><td class="prmName"><ins class="diff-new">
tripleCallback
</ins></td><td class="prmType"><code><a href="#idl-def-JSONLDTripleCallback" class="idlType"><code><ins class="diff-new">
JSONLDTripleCallback
</ins></code></a></code></td><td class="prmNullFalse"><ins class="diff-new">
✘
</ins></td><td class="prmOptFalse"><ins class="diff-new">
✘
</ins></td><td class="prmDesc"><ins class="diff-new">
A
callback
that
is
called
whenever
a
processing
error
occurs
on
the
given
</ins><code><ins class="diff-new">
input
</ins></code>.<div class="issue"><ins class="diff-new">
This
callback
should
be
aligned
with
the
RDF
API.
</ins></div></td></tr><tr><td class="prmName"><ins class="diff-new">
parserCallback
</ins></td><td class="prmType"><code><a href="#idl-def-JSONLDProcessorCallback" class="idlType"><code><ins class="diff-new">
JSONLDProcessorCallback
</ins></code></a></code></td><td class="prmNullTrue"><ins class="diff-new">
✔
</ins></td><td class="prmOptTrue"><ins class="diff-new">
✔
</ins></td><td class="prmDesc"><ins class="diff-new">
A
callback
that
is
called
whenever
a
processing
error
occurs
on
the
given
</ins><code><ins class="diff-new">
input
</ins></code>.</td></tr></table><div><em><ins class="diff-new">
No
exceptions.
</ins></em></div><div><em><ins class="diff-new">
Return
type:
</ins></em><code><a><ins class="diff-new">
object
</ins></a></code></div></dd></dl></div></div><div id="jsonldprocessorcallback" class="section"><h3><span class="secno"><ins class="diff-new">
5.2
</ins></span><ins class="diff-new">
JSONLDProcessorCallback
</ins></h3><p><ins class="diff-new">
The
JSONLDProcessorCallback
is
called
whenever
a
processing
error
occurs
while
processing
the
</ins><a class="tref internalDFN" title="JSON-LD_input" href="#dfn-json-ld_input"><ins class="diff-new">
JSON-LD
input
</ins></a>.</p><pre class="idl"><span class="idlInterface" id="idl-def-JSONLDProcessorCallback">[<span class="extAttr">NoInterfaceObject Callback</span>]<ins class="diff-new">
interface <span class="idlInterfaceID">JSONLDProcessorCallback</span> {
</ins><span class="idlMethod">    <span class="idlMethType"><a>void</a></span> <span class="idlMethName"><a href="#widl-JSONLDProcessorCallback-error-void-DOMString-error">error</a></span> (<span class="idlParam">in <span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">error</span></span>);</span><ins class="diff-new">
};</span>
</ins></pre><div id="methods-1" class="section"><h4><span class="secno"><ins class="diff-new">
5.2.1
</ins></span><ins class="diff-new">
Methods
</ins></h4><dl class="methods"><dt id="widl-JSONLDProcessorCallback-error-void-DOMString-error"><code><ins class="diff-new">
error
</ins></code></dt><dd><ins class="diff-new">
This
callback
is
invoked
whenever
an
error
occurs
during
processing.
</ins><table class="parameters"><tr><th><ins class="diff-new">
Parameter
</ins></th><th><ins class="diff-new">
Type
</ins></th><th><ins class="diff-new">
Nullable
</ins></th><th><ins class="diff-new">
Optional
</ins></th><th><ins class="diff-new">
Description
</ins></th></tr><tr><td class="prmName"><ins class="diff-new">
error
</ins></td><td class="prmType"><code><a><ins class="diff-new">
DOMString
</ins></a></code></td><td class="prmNullFalse"><ins class="diff-new">
✘
</ins></td><td class="prmOptFalse"><ins class="diff-new">
✘
</ins></td><td class="prmDesc"><ins class="diff-new">
A
descriptive
error
string
returned
by
the
processor.
</ins></td></tr></table><div><em><ins class="diff-new">
No
exceptions.
</ins></em></div><div><em><ins class="diff-new">
Return
type:
</ins></em><code><a><ins class="diff-new">
void
</ins></a></code></div></dd></dl></div></div><div id="jsonldtriplecallback" class="section"><h3><span class="secno"><ins class="diff-new">
5.3
</ins></span><ins class="diff-new">
JSONLDTripleCallback
</ins></h3><p><ins class="diff-new">
The
JSONLDTripleCallback
is
called
whenever
the
processor
generates
a
triple
during
the
</ins><code><ins class="diff-new">
triple()
</ins></code><ins class="diff-new">
call.
</ins></p><pre class="idl"><span class="idlInterface" id="idl-def-JSONLDTripleCallback">[<span class="extAttr">NoInterfaceObject Callback</span>]<ins class="diff-new">
interface <span class="idlInterfaceID">JSONLDTripleCallback</span> {
</ins><span class="idlMethod">    <span class="idlMethType"><a>void</a></span> <span class="idlMethName"><a href="#widl-JSONLDTripleCallback-triple-void-DOMString-subject-DOMString-property-DOMString-objectType-DOMString-object-DOMString-datatype-DOMString-language">triple</a></span> (<span class="idlParam">in <span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">subject</span></span>, <span class="idlParam">in <span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">property</span></span>, <span class="idlParam">in <span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">objectType</span></span>, <span class="idlParam">in <span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">object</span></span>, <span class="idlParam">in <span class="idlParamType"><a>DOMString</a>?</span> <span class="idlParamName">datatype</span></span>, <span class="idlParam">in <span class="idlParamType"><a>DOMString</a>?</span> <span class="idlParamName">language</span></span>);</span><ins class="diff-new">
};</span>
</ins></pre><div id="methods-2" class="section"><h4><span class="secno"><ins class="diff-new">
5.3.1
</ins></span><ins class="diff-new">
Methods
</ins></h4><dl class="methods"><dt id="widl-JSONLDTripleCallback-triple-void-DOMString-subject-DOMString-property-DOMString-objectType-DOMString-object-DOMString-datatype-DOMString-language"><code><ins class="diff-new">
triple
</ins></code></dt><dd><ins class="diff-new">
This
callback
is
invoked
whenever
a
triple
is
generated
by
the
processor.
</ins><table class="parameters"><tr><th><ins class="diff-new">
Parameter
</ins></th><th><ins class="diff-new">
Type
</ins></th><th><ins class="diff-new">
Nullable
</ins></th><th><ins class="diff-new">
Optional
</ins></th><th><ins class="diff-new">
Description
</ins></th></tr><tr><td class="prmName"><ins class="diff-new">
subject
</ins></td><td class="prmType"><code><a><ins class="diff-new">
DOMString
</ins></a></code></td><td class="prmNullFalse"><ins class="diff-new">
✘
</ins></td><td class="prmOptFalse"><ins class="diff-new">
✘
</ins></td><td class="prmDesc"><ins class="diff-new">
The
subject
IRI
that
is
associated
with
the
triple.
</ins></td></tr><tr><td class="prmName"><ins class="diff-new">
property
</ins></td><td class="prmType"><code><a><ins class="diff-new">
DOMString
</ins></a></code></td><td class="prmNullFalse"><ins class="diff-new">
✘
</ins></td><td class="prmOptFalse"><ins class="diff-new">
✘
</ins></td><td class="prmDesc"><ins class="diff-new">
The
property
IRI
that
is
associated
with
the
triple.
</ins></td></tr><tr><td class="prmName"><ins class="diff-new">
objectType
</ins></td><td class="prmType"><code><a><ins class="diff-new">
DOMString
</ins></a></code></td><td class="prmNullFalse"><ins class="diff-new">
✘
</ins></td><td class="prmOptFalse"><ins class="diff-new">
✘
</ins></td><td class="prmDesc"><ins class="diff-new">
The
type
of
object
that
is
associated
with
the
triple.
Valid
values
are
</ins><code><ins class="diff-new">
IRI
</ins></code><ins class="diff-new">
and
</ins><code><ins class="diff-new">
literal
</ins></code>.</td></tr><tr><td class="prmName"><ins class="diff-new">
object
</ins></td><td class="prmType"><code><a><ins class="diff-new">
DOMString
</ins></a></code></td><td class="prmNullFalse"><ins class="diff-new">
✘
</ins></td><td class="prmOptFalse"><ins class="diff-new">
✘
</ins></td><td class="prmDesc"><ins class="diff-new">
The
object
value
associated
with
the
subject
and
the
property.
</ins></td></tr><tr><td class="prmName"><ins class="diff-new">
datatype
</ins></td><td class="prmType"><code><a><ins class="diff-new">
DOMString
</ins></a></code></td><td class="prmNullTrue"><ins class="diff-new">
✔
</ins></td><td class="prmOptFalse"><ins class="diff-new">
✘
</ins></td><td class="prmDesc"><ins class="diff-new">
The
datatype
associated
with
the
object.
</ins></td></tr><tr><td class="prmName"><ins class="diff-new">
language
</ins></td><td class="prmType"><code><a><ins class="diff-new">
DOMString
</ins></a></code></td><td class="prmNullTrue"><ins class="diff-new">
✔
</ins></td><td class="prmOptFalse"><ins class="diff-new">
✘
</ins></td><td class="prmDesc"><ins class="diff-new">
The
language
associated
with
the
object
in
BCP47
format.
</ins></td></tr></table><div><em><ins class="diff-new">
No
exceptions.
</ins></em></div><div><em><ins class="diff-new">
Return
type:
</ins></em><code><a><ins class="diff-new">
void
</ins></a></code></div></dd></dl></div></div></div><div id="algorithms" class="section"><h2><span class="secno"><ins class="diff-new">
6.
</ins></span>
Algorithms
</h2>
<p>
All
algorithms
described
in
this
section
are
intended
to
operate
on
language-native
data
structures.
That
is,
the
serialization
to
a
text-based
JSON
document
isn't
required
as
input
or
output
to
any
of
these
algorithms
and
language-native
data
structures
<em class="rfc2119" title="must">
must
</em>
be
used
where
applicable.
</p>
<div id="syntax-tokens-and-keywords" class="section">
<h3>
<span class="secno">
<del class="diff-old">5.1
</del>
<ins class="diff-chg">6.1
</ins>
</span>
Syntax
Tokens
and
Keywords
</h3>
<p>
JSON-LD
specifies
a
number
of
syntax
tokens
and
keywords
that
are
using
in
all
algorithms
described
in
this
section:
</p>
<dl>
<dt>
<code>
@context
</code>
</dt>
<dd>
Used
to
set
the
<a class="tref internalDFN" title="local_context" href="#dfn-local_context">
local
context
</a>.
</dd>
<dt>
<code>
@base
</code>
</dt>
<dd>
Used
to
set
the
base
IRI
for
all
object
IRIs
affected
by
the
<a class="tref internalDFN" title="active_context" href="#dfn-active_context">
active
context
</a>.
</dd>
<dt>
<code>
@vocab
</code>
</dt>
<dd>
Used
to
set
the
base
IRI
for
all
property
IRIs
affected
by
the
<a class="tref internalDFN" title="active_context" href="#dfn-active_context">
active
context
</a>.
</dd>
<dt>
<code>
@coerce
</code>
</dt>
<dd>
Used
to
specify
type
coercion
rules.
</dd>
<dt>
<code>
@literal
</code>
</dt>
<dd>
Used
to
specify
a
literal
value.
</dd>
<dt>
<code>
@iri
</code>
</dt>
<dd>
Used
to
specify
an
IRI
value.
</dd>
<dt>
<code>
@language
</code>
</dt>
<dd>
Used
to
specify
the
language
for
a
literal.
</dd>
<dt>
<code>
@datatype
</code>
</dt>
<dd>
Used
to
specify
the
datatype
for
a
literal.
</dd>
<dt>
<code>:
</code>
</dt>
<dd>
The
separator
for
<del class="diff-old">CURIEs
</del>
<a class="tref internalDFN" title="CURIE" href="#dfn-curie">
<ins class="diff-chg">CURIE
</ins></a><ins class="diff-chg">
s
</ins>
when
used
in
JSON
keys
or
JSON
values.
</dd>
<dt>
<code>
@subject
</code>
</dt>
<dd>
Sets
the
active
subjects.
</dd>
<dt>
<code>
@type
</code>
</dt>
<dd>
Used
to
set
the
type
of
the
active
subjects.
</dd>
</dl>
</div>
<div id="algorithm-terms" class="section">
<h3>
<span class="secno">
<del class="diff-old">5.2
</del>
<ins class="diff-chg">6.2
</ins>
</span>
Algorithm
Terms
</h3>
<dl>
<dt>
<dfn title="initial_context" id="dfn-initial_context">
initial
context
</dfn>
</dt>
<dd>
a
context
that
is
specified
to
the
algorithm
before
processing
begins.
</dd>
<dt>
<dfn title="active_subject" id="dfn-active_subject">
active
subject
</dfn>
</dt>
<dd>
the
currently
active
subject
that
the
processor
should
use
when
processing.
</dd>
<dt>
<dfn title="active_property" id="dfn-active_property">
active
property
</dfn>
</dt>
<dd>
the
currently
active
property
that
the
processor
should
use
when
processing.
</dd>
<dt>
<dfn title="active_object" id="dfn-active_object">
active
object
</dfn>
</dt>
<dd>
the
currently
active
object
that
the
processor
should
use
when
processing.
</dd>
<dt>
<dfn title="active_context" id="dfn-active_context">
active
context
</dfn>
</dt>
<dd>
a
context
that
is
used
to
resolve
<del class="diff-old">CURIEs
</del>
<a class="tref internalDFN" title="CURIE" href="#dfn-curie">
<ins class="diff-chg">CURIE
</ins></a><ins class="diff-chg">
s
</ins>
while
the
processing
algorithm
is
running.
The
<a class="tref internalDFN" title="active_context" href="#dfn-active_context">
active
context
</a>
is
the
context
contained
within
the
<a class="tref internalDFN" title="processor_state" href="#dfn-processor_state">
processor
state
</a>.
</dd>
<dt>
<dfn title="local_context" id="dfn-local_context">
local
context
</dfn>
</dt>
<dd>
a
context
that
is
specified
<del class="diff-old">at
the
</del>
<ins class="diff-chg">within
a
</ins><a class="tref internalDFN" title="JSON_object" href="#dfn-json_object">
JSON
<del class="diff-old">associative-array
level,
</del>
<ins class="diff-chg">object
</ins></a>,
specified
via
the
<code>
@context
</code>
keyword.
</dd>
<dt>
<dfn title="processor_state" id="dfn-processor_state">
processor
state
</dfn>
</dt>
<dd>
the
<a class="tref internalDFN" title="processor_state" href="#dfn-processor_state">
processor
state
</a>,
which
includes
the
<a class="tref" title="active__context">
active
context
</a>,
<a class="tref" title="current_subject">
current
subject
</a>,
and
<a class="tref" title="current_property">
current
property
</a>.
The
<a class="tref internalDFN" title="processor_state" href="#dfn-processor_state">
processor
state
</a>
is
managed
as
a
stack
with
elements
from
the
previous
<a class="tref internalDFN" title="processor_state" href="#dfn-processor_state">
processor
state
</a>
copied
into
a
new
<a class="tref internalDFN" title="processor_state" href="#dfn-processor_state">
processor
state
</a>
when
entering
a
new
<del class="diff-old">associative
array.
</del>
<a class="tref internalDFN" title="JSON_object" href="#dfn-json_object">
<ins class="diff-chg">JSON
object
</ins></a>.
</dd>
<dt>
<dfn title="JSON-LD_input" id="dfn-json-ld_input">
JSON-LD
input
</dfn>
</dt>
<dd>
The
JSON-LD
data
structure
that
is
provided
as
input
to
the
algorithm.
</dd>
<dt>
<dfn title="JSON-LD_output" id="dfn-json-ld_output">
JSON-LD
output
</dfn>
</dt>
<dd>
The
JSON-LD
data
structure
that
is
produced
as
output
by
the
algorithm.
</dd>
</dl>
</div>
<div id="context-1" class="section">
<h3 id="context">
<span class="secno">
<del class="diff-old">5.3
</del>
<ins class="diff-chg">6.3
</ins>
</span>
Context
</h3>
<p>
Processing
of
JSON-LD
data
structure
is
managed
recursively.
During
processing,
each
rule
is
applied
using
information
provided
by
the
<a class="tref internalDFN" title="active_context" href="#dfn-active_context">
active
context
</a>.
Processing
begins
by
pushing
a
new
<a class="tref internalDFN" title="processor_state" href="#dfn-processor_state">
processor
state
</a>
onto
the
<a class="tref internalDFN" title="processor_state" href="#dfn-processor_state">
processor
state
</a>
stack
and
initializing
the
<a class="tref internalDFN" title="active_context" href="#dfn-active_context">
active
context
</a>
with
the
<a class="tref internalDFN" title="initial_context" href="#dfn-initial_context">
initial
context
</a>.
If
a
<a class="tref internalDFN" title="local_context" href="#dfn-local_context">
local
context
</a>
is
encountered,
information
from
the
<a class="tref internalDFN" title="local_context" href="#dfn-local_context">
local
context
</a>
is
merged
into
the
<a class="tref internalDFN" title="active_context" href="#dfn-active_context">
active
context
</a>.
</p>
<p>
The
<a class="tref internalDFN" title="active_context" href="#dfn-active_context">
active
context
</a>
is
used
for
expanding
keys
and
values
of
<del class="diff-old">an
associative
array
</del>
<ins class="diff-chg">a
</ins><a class="tref internalDFN" title="JSON_object" href="#dfn-json_object"><ins class="diff-chg">
JSON
object
</ins></a>
(or
elements
of
a
list
(see
<span a="#list-processing">
List
Processing
</span>
)).
</p>
<p>
A
<a class="tref internalDFN" title="local_context" href="#dfn-local_context">
local
context
</a>
is
identified
within
<del class="diff-old">an
associative
array
</del>
<ins class="diff-chg">a
</ins><a class="tref internalDFN" title="JSON_object" href="#dfn-json_object"><ins class="diff-chg">
JSON
object
</ins></a>
having
a
key
of
<code>
@context
</code>
with
<a class="tref internalDFN" title="string" href="#dfn-string">
string
</a>
or
<del class="diff-old">an
associative
array
</del>
<ins class="diff-chg">a
</ins><a class="tref internalDFN" title="JSON_object" href="#dfn-json_object"><ins class="diff-chg">
JSON
object
</ins></a>
value.
When
processing
a
<a class="tref" title="local__context">
local
context
</a>,
special
processing
rules
apply:
</p>
<ol class="algorithm">
<li>
Create
a
new,
empty
<a class="tref internalDFN" title="local_context" href="#dfn-local_context">
local
context
</a>.
</li>
<li>
If
the
value
is
a
simple
<del class="diff-old">string,
</del>
<a class="tref internalDFN" title="string" href="#dfn-string">
<ins class="diff-chg">string
</ins></a>,
it
<em class="rfc2119" title="must">
must
</em>
have
a
lexical
form
of
IRI
and
used
to
initialize
a
new
JSON
document
which
replaces
the
value
for
subsequent
processing.
</li>
<li>
If
the
value
is
<del class="diff-old">an
associative
array,
</del>
<ins class="diff-chg">a
</ins><a class="tref internalDFN" title="JSON_object" href="#dfn-json_object"><ins class="diff-chg">
JSON
object
</ins></a>,
perform
the
following
steps:
<ol class="algorithm">
<li>
If
the
<del class="diff-old">associative
array
</del>
<a class="tref internalDFN" title="JSON_object" href="#dfn-json_object">
<ins class="diff-chg">JSON
object
</ins></a>
has
a
<code>
@base
</code>
key,
it
<em class="rfc2119" title="must">
must
</em>
have
a
value
of
a
simple
<a class="tref internalDFN" title="string" href="#dfn-string">
string
</a>
with
the
lexical
form
of
an
absolute
IRI.
Add
the
base
mapping
to
the
<a class="tref" title="local__context">
local
context
</a>.
<p class="issue">
Turtle
allows
@base
to
be
relative.
If
we
did
this,
we
would
have
to
add
<a href="#iri-expansion">
IRI
Expansion
</a>.
</p>
</li>
<li>
If
the
<del class="diff-old">associative
array
</del>
<a class="tref internalDFN" title="JSON_object" href="#dfn-json_object">
<ins class="diff-chg">JSON
object
</ins></a>
has
a
<code>
@vocab
</code>
key,
it
<em class="rfc2119" title="must">
must
</em>
have
a
value
of
a
simple
<a class="tref internalDFN" title="string" href="#dfn-string">
string
</a>
with
the
lexical
form
of
an
absolute
IRI.
Add
the
vocabulary
mapping
to
the
<a class="tref internalDFN" title="local_context" href="#dfn-local_context">
local
context
</a>
after
performing
<a href="#iri-expansion">
IRI
Expansion
</a>
on
the
associated
value.
</li>
<li>
If
the
<del class="diff-old">associative
array
</del>
<a class="tref internalDFN" title="JSON_object" href="#dfn-json_object">
<ins class="diff-chg">JSON
object
</ins></a>
has
a
<code>
@coerce
</code>
key,
it
<em class="rfc2119" title="must">
must
</em>
have
a
value
of
<del class="diff-old">an
associative
array.
</del>
<ins class="diff-chg">a
</ins><a class="tref internalDFN" title="JSON_object" href="#dfn-json_object"><ins class="diff-chg">
JSON
object
</ins></a>.
Add
the
<code>
@coerce
</code>
mapping
to
the
<a class="tref internalDFN" title="local_context" href="#dfn-local_context">
local
context
</a>
performing
<a href="#iri-expansion">
IRI
Expansion
</a>
on
the
associated
value(s).
</li>
<li>
Otherwise,
the
key
<em class="rfc2119" title="must">
must
</em>
have
the
lexical
form
of
<cite>
<a href="http://www.w3.org/TR/2009/REC-xml-names-20091208/#NT-NCName">
NCName
</a>
</cite>
and
<em class="rfc2119" title="must">
must
</em>
have
the
value
of
a
simple
<a class="tref internalDFN" title="string" href="#dfn-string">
string
</a>
with
the
lexical
form
of
IRI.
Merge
the
key-value
pair
into
the
<a class="tref internalDFN" title="local_context" href="#dfn-local_context">
local
context
</a>.
</li>
</ol>
</li>
<li>
Merge
the
of
<a class="tref internalDFN" title="local_context" href="#dfn-local_context">
local
context
</a>
's
<code>
@coerce
</code>
mapping
into
the
<a class="tref internalDFN" title="active_context" href="#dfn-active_context">
active
context
</a>
's
<code>
@coerce
</code>
mapping
as
described
<a href="#coerce">
below
</a>.
</li>
<li>
Merge
all
entries
other
than
the
<code>
@coerce
</code>
mapping
from
the
<a class="tref internalDFN" title="local_context" href="#dfn-local_context">
local
context
</a>
to
the
<a class="tref internalDFN" title="active_context" href="#dfn-active_context">
active
context
</a>
overwriting
any
duplicate
values.
</li>
</ol>
<div id="coerce" class="section">
<h4>
<span class="secno">
<del class="diff-old">5.3.1
</del>
<ins class="diff-chg">6.3.1
</ins>
</span>
Coerce
</h4>
<p>
Map
each
key-value
pair
in
the
<a class="tref internalDFN" title="local_context" href="#dfn-local_context">
local
context
</a>
's
<code>
@coerce
</code>
mapping
into
the
<a class="tref internalDFN" title="active_context" href="#dfn-active_context">
active
context
</a>
's
<code>
@coerce
</code>
mapping,
overwriting
any
duplicate
values
in
the
<a class="tref internalDFN" title="active_context" href="#dfn-active_context">
active
context
</a>
's
<code>
@coerce
</code>
mapping.
The
<code>
@coerce
</code>
mapping
has
either
a
single
<a class="tref internalDFN" title="CURIE" href="#dfn-curie">
CURIE
</a>
or
an
<a class="tref internalDFN" title="array" href="#dfn-array">
array
</a>
of
CURIEs.
When
merging
with
an
existing
mapping
in
the
<a class="tref internalDFN" title="active_context" href="#dfn-active_context">
active
context
</a>,
map
all
CURIE
values
to
<a class="tref internalDFN" title="array" href="#dfn-array">
array
</a>
form
and
replace
with
the
union
of
the
value
from
the
<a class="tref internalDFN" title="local_context" href="#dfn-local_context">
local
context
</a>
and
the
value
of
the
<a class="tref internalDFN" title="active_context" href="#dfn-active_context">
active
context
</a>.
If
the
result
is
an
<a class="tref internalDFN" title="array" href="#dfn-array">
array
</a>
with
a
single
CURIE,
the
processor
<em class="rfc2119" title="may">
may
</em>
represent
this
as
a
string
value.
</p>
</div>
<div id="initial-context" class="section">
<h4>
<span class="secno">
<del class="diff-old">5.3.2
</del>
<ins class="diff-chg">6.3.2
</ins>
</span>
Initial
Context
</h4>
<p>
The
<a class="tref internalDFN" title="initial_context" href="#dfn-initial_context">
initial
context
</a>
is
initialized
as
follows:
</p>
<ul>
<li>
<code>
@base
</code>
is
set
using
<cite>
<href="http: www.ietf.org="" rfc="" rfc2396.txt"="">
section
5.1
Establishing
a
Base
URI
</href="http:>
</cite>
of
[
<cite>
<a class="bibref" rel="biblioentry" href="#bib-RFC3986">
RFC3986
</a>
</cite>
].
Processors
<em class="rfc2119" title="may">
may
</em>
provide
a
means
of
setting
the
base
IRI
programatically.
</li>
<li>
<code>
@coerce
</code>
is
set
with
a
single
mapping
from
<code>
@iri
</code>
to
<code>
@type
</code>.
</li>
</ul>
    <pre class="example">
{
    "@base": <span class="diff">document-location</span>,
    "@context": {
      "@iri": "@type"
    }
}
</pre>
</div>
</div>
<div id="iri-expansion" class="section">
<h3>
<span class="secno">
<del class="diff-old">5.4
</del>
<ins class="diff-chg">6.4
</ins>
</span>
IRI
Expansion
</h3>
<p>
Keys
and
some
values
are
evaluated
to
produce
an
IRI.
This
section
defines
an
algorithm
for
transforming
a
value
representing
an
IRI
into
an
actual
IRI.
</p>
<p>
IRIs
may
be
represented
as
an
explicit
string,
or
as
a
<del class="diff-old">CURIE,
</del>
<a class="tref internalDFN" title="CURIE" href="#dfn-curie">
<ins class="diff-chg">CURIE
</ins></a>,
as
a
value
relative
to
<code>
@base
</code>
or
<code>
@vocab
</code>.
</p>
<p>
<del class="diff-old">CURIEs
are
defined
more
formally
in
[
RDFA-CORE
]
section
6
"CURIE
Syntax
Definition"
.
Generally,
a
CURIE
is
composed
of
a
prefix
and
a
suffix
separated
by
a
':'.
In
JSON-LD,
either
the
prefix
may
be
the
empty
string,
denoting
the
default
prefix
.
</del>
The
algorithm
for
generating
an
IRI
is:
</p>
<ol class="algorithm">
<li>
Split
the
value
into
a
<em>
prefix
</em>
and
<em>
suffix
</em>
from
the
first
occurrence
of
':'.
</li>
<li>
If
the
prefix
is
a
'_'
(underscore),
the
IRI
is
unchanged.
</li>
<li>
If
the
<a class="tref internalDFN" title="active_context" href="#dfn-active_context">
active
context
</a>
contains
a
mapping
for
<em>
prefix
</em>,
generate
an
IRI
by
prepending
the
mapped
prefix
to
the
(possibly
empty)
suffix
using
textual
concatenation.
Note
that
an
empty
suffix
and
no
suffix
(meaning
the
value
contains
no
':'
string
at
all)
are
treated
equivalently.
</li>
<li>
If
the
IRI
being
processed
is
for
a
property
(i.e.,
a
key
value
in
<del class="diff-old">an
associative
array,
</del>
<ins class="diff-chg">a
</ins><a class="tref internalDFN" title="JSON_object" href="#dfn-json_object"><ins class="diff-chg">
JSON
object
</ins></a>,
or
a
value
in
a
<code>
@coerce
</code>
mapping)
and
the
active
context
has
a
<code>
@vocab
</code>
mapping,
join
the
mapped
value
to
the
suffix
using
textual
concatenation.
</li>
<li>
If
the
IRI
being
processed
is
for
a
subject
or
object
(i.e.,
not
a
property)
and
the
active
context
has
a
<code>
@base
</code>
mapping,
join
the
mapped
value
to
the
suffix
using
the
method
described
in
[
<cite>
<a class="bibref" rel="biblioentry" href="#bib-RFC3986">
RFC3986
</a>
</cite>
].
</li>
<li>
Otherwise,
use
the
value
directly
as
an
IRI.
</li>
</ol>
<p>
</p>
</div>
<div id="iri-compaction" class="section">
<h3>
<span class="secno">
<del class="diff-old">5.5
</del>
<ins class="diff-chg">6.5
</ins>
</span>
IRI
Compaction
</h3>
<p>
Some
keys
and
values
are
expressed
using
IRIs.
This
section
defines
an
algorithm
for
transforming
an
IRI
to
a
compact
IRI
using
the
<a class="tref internalDFN" title="term" href="#dfn-term">
term
</a>
s
and
<a class="tref internalDFN" title="prefix" href="#dfn-prefix">
prefix
</a>
es
specified
in
the
<a class="tref internalDFN" title="local_context" href="#dfn-local_context">
local
context
</a>.
</p>
<p>
The
algorithm
for
generating
a
compacted
IRI
is:
</p>
<ol class="algorithm">
<li>
Search
every
key-value
pair
in
the
<a class="tref internalDFN" title="active_context" href="#dfn-active_context">
active
context
</a>
for
a
<a class="tref internalDFN" title="term" href="#dfn-term">
term
</a>
that
is
a
complete
match
against
the
IRI.
If
a
complete
match
is
found,
the
resulting
compacted
IRI
is
the
<a class="tref internalDFN" title="term" href="#dfn-term">
term
</a>
associated
with
the
IRI
in
the
<a class="tref internalDFN" title="active_context" href="#dfn-active_context">
active
context
</a>.
</li>
<li>
If
a
complete
match
is
not
found,
search
for
a
partial
match
from
the
beginning
of
the
IRI.
For
all
matches
that
are
found,
the
resulting
compacted
IRI
is
the
<a class="tref internalDFN" title="prefix" href="#dfn-prefix">
prefix
</a>
associated
with
the
partially
matched
IRI
in
the
<a class="tref internalDFN" title="active_context" href="#dfn-active_context">
active
context
</a>
concatenated
with
a
colon
(:)
character
and
the
unmatched
part
of
the
string.
If
there
is
more
than
one
compacted
IRI
produced,
the
final
value
is
the
lexicographically
least
value
of
the
entire
set
of
compacted
IRIs.
</li>
</ol>
<p>
</p>
</div>
<div id="value-expansion" class="section">
<h3>
<span class="secno">
<del class="diff-old">5.6
</del>
<ins class="diff-chg">6.6
</ins>
</span>
Value
Expansion
</h3>
<p>
Some
values
in
JSON-LD
can
be
expressed
in
a
compact
form.
These
values
are
required
to
be
expanded
at
times
when
processing
JSON-LD
documents.
</p>
<p>
The
algorithm
for
expanding
a
value
is:
</p>
<ol class="algorithm">
<li>
If
the
key
that
is
associated
with
the
value
has
an
associated
coercion
entry
in
the
<a class="tref internalDFN" title="local_context" href="#dfn-local_context">
local
context
</a>,
the
resulting
expansion
is
an
object
populated
according
to
the
following
steps:
<ol class="algorithm">
<li>
If
the
coercion
target
is
<code>
@iri
</code>,
expand
the
value
by
adding
a
new
key-value
pair
where
the
key
is
<code>
@iri
</code>
and
the
value
is
the
expanded
IRI
according
to
the
<a href="#iri-expansion">
IRI
Expansion
</a>
rules.
</li>
<li>
If
the
coercion
target
is
a
typed
literal,
expand
the
value
by
adding
two
new
key-value
pairs.
The
first
key-value
pair
will
be
<code>
@literal
</code>
and
the
unexpanded
value.
The
second
key-value
pair
will
be
<code>
@datatype
</code>
and
the
associated
coercion
datatype
expanded
according
to
the
<a href="#iri-expansion">
IRI
Expansion
</a>
rules.
</li>
</ol>
</li>
</ol>
<p>
</p>
</div>
<div id="value-compaction" class="section">
<h3>
<span class="secno">
<del class="diff-old">5.7
</del>
<ins class="diff-chg">6.7
</ins>
</span>
Value
Compaction
</h3>
<p>
Some
values,
such
as
IRIs
and
typed
literals,
may
be
expressed
in
an
expanded
form
in
JSON-LD.
These
values
are
required
to
be
compacted
at
times
when
processing
JSON-LD
documents.
</p>
<p>
The
algorithm
for
compacting
a
value
is:
</p>
<ol class="algorithm">
<li>
If
the
<a class="tref internalDFN" title="local_context" href="#dfn-local_context">
local
context
</a>
contains
a
coercion
target
for
the
key
that
is
associated
with
the
value,
compact
the
value
using
the
following
steps:
<ol class="algorithm">
<li>
If
the
coercion
target
is
an
<code>
@iri
</code>,
the
compacted
value
is
the
value
associated
with
the
<code>
@iri
</code>
key,
processed
according
to
the
<a href="#iri-compaction">
IRI
Compaction
</a>
steps.
</li>
<li>
If
the
coercion
target
is
a
typed
literal,
the
compacted
value
is
the
value
associated
with
the
<code>
@literal
</code>
key.
</li>
<li>
Otherwise,
the
value
is
not
modified.
</li>
</ol>
</li>
</ol>
<p>
</p>
</div>
<div id="expansion-1" class="section">
<h3>
<span class="secno">
<del class="diff-old">5.8
</del>
<ins class="diff-chg">6.8
</ins>
</span>
Expansion
</h3>
<p class="issue">
This
algorithm
is
a
work
in
progress,
do
not
implement
it.
</p>
<p>
As
stated
previously,
expansion
is
the
process
of
taking
a
JSON-LD
input
and
expanding
all
IRIs
and
typed
literals
to
their
fully-expanded
form.
The
output
will
not
contain
a
single
context
declaration
and
will
have
all
IRIs
and
typed
literals
fully
expanded.
</p>
<div id="expansion-algorithm" class="section">
<h4>
<span class="secno">
<del class="diff-old">5.8.1
</del>
<ins class="diff-chg">6.8.1
</ins>
</span>
Expansion
Algorithm
</h4>
<ol class="algorithm">
<li>
If
the
top-level
item
in
the
<a class="tref internalDFN" title="JSON-LD_input" href="#dfn-json-ld_input">
JSON-LD
input
</a>
is
an
<del class="diff-old">array,
</del>
<a class="tref internalDFN" title="array" href="#dfn-array">
<ins class="diff-chg">array
</ins></a>,
process
each
item
in
the
<a class="tref internalDFN" title="array" href="#dfn-array">
array
</a>
recursively
using
this
algorithm.
</li>
<li>
If
the
top-level
item
in
the
<a class="tref internalDFN" title="JSON-LD_input" href="#dfn-json-ld_input">
JSON-LD
input
</a>
is
an
object,
update
the
<a class="tref internalDFN" title="local_context" href="#dfn-local_context">
local
context
</a>
according
to
the
steps
outlined
in
the
<a href="#context">
context
</a>
section.
Process
each
key,
expanding
the
key
according
to
the
<a href="#iri-expansion">
IRI
Expansion
</a>
rules.
</li>
<ol class="algorithm">
<li>
Process
each
value
associated
with
each
key
<ol class="algorithm">
<li>
If
the
value
is
an
<del class="diff-old">array,
</del>
<a class="tref internalDFN" title="array" href="#dfn-array">
<ins class="diff-chg">array
</ins></a>,
process
each
item
in
the
<a class="tref internalDFN" title="array" href="#dfn-array">
array
</a>
recursively
using
this
algorithm.
</li>
<li>
If
the
value
is
an
object,
process
the
object
recursively
using
this
algorithm.
</li>
<li>
Otherwise,
check
to
see
the
associated
key
has
an
associated
coercion
rule.
If
the
value
should
be
coerced,
expand
the
value
according
to
the
<a href="#value-expansion">
Value
Expansion
</a>
rules.
If
the
value
does
not
need
to
be
coerced,
leave
the
value
as-is.
</li>
</ol>
</li>
<li>
Remove
the
context
from
the
object
</li>
</ol>
</ol>
</div>
</div>
<div id="compaction-1" class="section">
<h3>
<span class="secno">
<del class="diff-old">5.9
</del>
<ins class="diff-chg">6.9
</ins>
</span>
Compaction
</h3>
<p class="issue">
This
algorithm
is
a
work
in
progress,
do
not
implement
it.
</p>
<p>
As
stated
previously,
compaction
is
the
process
of
taking
a
JSON-LD
input
and
compacting
all
IRIs
using
a
given
context.
The
output
will
contain
a
single
top-level
context
declaration
and
will
only
use
<a class="tref internalDFN" title="term" href="#dfn-term">
term
</a>
s
and
<a class="tref internalDFN" title="prefix" href="#dfn-prefix">
prefix
</a>
es
and
will
ensure
that
all
typed
literals
are
fully
compacted.
</p>
<div id="compaction-algorithm" class="section">
<h4>
<span class="secno">
<del class="diff-old">5.9.1
</del>
<ins class="diff-chg">6.9.1
</ins>
</span>
Compaction
Algorithm
</h4>
<ol class="algorithm">
<li>
Perform
the
<a href="#expansion-algorithm">
Expansion
Algorithm
</a>
on
the
<a class="tref internalDFN" title="JSON-LD_input" href="#dfn-json-ld_input">
JSON-LD
input
</a>.
</li>
<li>
If
the
top-level
item
is
an
<del class="diff-old">array,
</del>
<a class="tref internalDFN" title="array" href="#dfn-array">
<ins class="diff-chg">array
</ins></a>,
process
each
item
in
the
<a class="tref internalDFN" title="array" href="#dfn-array">
array
</a>
recursively,
starting
at
this
step.
</li>
<li>
If
the
top-level
item
is
an
object,
compress
each
key
using
the
steps
defined
in
<a href="#iri-compaction">
IRI
Compaction
</a>
and
compress
each
value
using
the
steps
defined
in
<a href="#value-compaction">
Value
Compaction
</a>
</li>
</ol>
</div>
</div>
<div id="framing-1" class="section">
<h3>
<span class="secno">
<del class="diff-old">5.10
</del>
<ins class="diff-chg">6.10
</ins>
</span>
Framing
</h3>
<p class="issue">
This
algorithm
is
a
work
in
progress,
do
not
implement
it.
</p>
<p>
A
JSON-LD
document
is
a
representation
of
a
directed
graph.
A
single
directed
graph
can
have
many
different
serializations,
each
expressing
exactly
the
same
information.
Developers
typically
don't
work
directly
with
graphs,
but
rather,
prefer
trees
when
dealing
with
JSON.
While
mapping
a
graph
to
a
tree
can
be
done,
the
layout
of
the
end
result
must
be
specified
in
advance.
This
section
defines
an
algorithm
for
mapping
a
graph
to
a
tree
given
a
<a class="tref internalDFN" title="frame" href="#dfn-frame">
frame
</a>.
</p>
<div id="framing-algorithm-terms" class="section">
<h4>
<span class="secno">
<del class="diff-old">5.10.1
</del>
<ins class="diff-chg">6.10.1
</ins>
</span>
Framing
Algorithm
Terms
</h4>
<dl>
<dt>
<dfn title="input_frame" id="dfn-input_frame">
input
frame
</dfn>
</dt>
<dd>
the
initial
<a class="tref internalDFN" title="frame" href="#dfn-frame">
frame
</a>
provided
to
the
framing
algorithm.
</dd>
<dt>
<dfn title="framing_context" id="dfn-framing_context">
framing
context
</dfn>
</dt>
<dd>
a
context
containing
the
<a class="tref internalDFN" title="object_embed_flag" href="#dfn-object_embed_flag">
object
embed
flag
</a>,
the
<a class="tref internalDFN" title="explicit_inclusion_flag" href="#dfn-explicit_inclusion_flag">
explicit
inclusion
flag
</a>
and
the
<a class="tref" title="omit_default_flag">
omit
default
flag
</a>.
</dd>
<dt>
<dfn title="object_embed_flag" id="dfn-object_embed_flag">
object
embed
flag
</dfn>
</dt>
<dd>
a
flag
specifying
that
objects
should
be
directly
embedded
in
the
output,
instead
of
being
referred
to
by
their
IRI.
</dd>
<dt>
<dfn title="explicit_inclusion_flag" id="dfn-explicit_inclusion_flag">
explicit
inclusion
flag
</dfn>
</dt>
<dd>
a
flag
specifying
that
for
properties
to
be
included
in
the
output,
they
must
be
explicitly
declared
in
the
<a class="tref internalDFN" title="framing_context" href="#dfn-framing_context">
framing
context
</a>.
</dd>
<dt>
<dfn title="omit_missing_properties_flag" id="dfn-omit_missing_properties_flag">
omit
missing
properties
flag
</dfn>
</dt>
<dd>
a
flag
specifying
that
properties
that
are
missing
from
the
<a class="tref internalDFN" title="JSON-LD_input" href="#dfn-json-ld_input">
JSON-LD
input
</a>
should
be
omitted
from
the
output.
</dd>
<dt>
<dfn title="match_limit" id="dfn-match_limit">
match
limit
</dfn>
</dt>
<dd>
A
value
specifying
the
maximum
number
of
matches
to
accept
when
building
arrays
of
values
during
the
framing
algorithm.
A
value
of
-1
specifies
that
there
is
no
match
limit.
</dd>
<dt>
<dfn title="map_of_embedded_subjects" id="dfn-map_of_embedded_subjects">
map
of
embedded
subjects
</dfn>
</dt>
<dd>
A
map
that
tracks
if
a
subject
has
been
embedded
in
the
output
of
the
<a href="#framing-algorithm">
Framing
Algorithm
</a>.
</dd>
</dl>
</div>
<div id="framing-algorithm" class="section">
<h4>
<span class="secno">
<del class="diff-old">5.10.2
</del>
<ins class="diff-chg">6.10.2
</ins>
</span>
Framing
Algorithm
</h4>
<p>
The
framing
algorithm
takes
<a class="tref internalDFN" title="JSON-LD_input" href="#dfn-json-ld_input">
JSON-LD
input
</a>
that
has
been
normalized
according
to
the
<a href="#normalization-algorithm">
Normalization
Algorithm
</a>
(
<strong>
normalized
input
</strong>
),
an
<a class="tref internalDFN" title="input_frame" href="#dfn-input_frame">
input
frame
</a>
that
has
been
expanded
according
to
the
<a href="#expansion-algorithm">
Expansion
Algorithm
</a>
(
<strong>
expanded
frame
</strong>
),
and
a
number
of
options
and
produces
<a class="tref internalDFN" title="JSON-LD_output" href="#dfn-json-ld_output">
JSON-LD
output
</a>.
The
following
series
of
steps
is
the
recursive
portion
of
the
framing
algorithm:
</p>
<ol class="algorithm">
<li>
Initialize
the
<a class="tref internalDFN" title="framing_context" href="#dfn-framing_context">
framing
context
</a>
by
setting
the
<a class="tref internalDFN" title="object_embed_flag" href="#dfn-object_embed_flag">
object
embed
flag
</a>,
clearing
the
<a class="tref internalDFN" title="explicit_inclusion_flag" href="#dfn-explicit_inclusion_flag">
explicit
inclusion
flag
</a>,
and
clearing
the
<a class="tref internalDFN" title="omit_missing_properties_flag" href="#dfn-omit_missing_properties_flag">
omit
missing
properties
flag
</a>.
Override
these
values
based
on
input
options
provided
to
the
algorithm
by
the
application.
</li>
<li>
Generate
a
<dfn title="list_of_frames" id="dfn-list_of_frames">
list
of
frames
</dfn>
by
processing
the
<strong>
expanded
frame
</strong>:
<ol class="algorithm">
<li>
If
the
<strong>
expanded
frame
</strong>
is
not
an
<del class="diff-old">array,
</del>
<a class="tref internalDFN" title="array" href="#dfn-array">
<ins class="diff-chg">array
</ins></a>,
set
<a class="tref internalDFN" title="match_limit" href="#dfn-match_limit">
match
limit
</a>
to
1,
place
the
<strong>
expanded
frame
</strong>
into
the
<a class="tref internalDFN" title="list_of_frames" href="#dfn-list_of_frames">
list
of
frames
</a>,
and
set
the
<a class="tref internalDFN" title="JSON-LD_output" href="#dfn-json-ld_output">
JSON-LD
output
</a>
to
<code>
null
</code>.
</li>
<li>
If
the
<strong>
expanded
frame
</strong>
is
an
empty
<del class="diff-old">array,
</del>
<a class="tref internalDFN" title="array" href="#dfn-array">
<ins class="diff-chg">array
</ins></a>,
place
an
empty
object
into
the
<a class="tref internalDFN" title="list_of_frames" href="#dfn-list_of_frames">
list
of
frames
</a>,
set
the
<a class="tref internalDFN" title="JSON-LD_output" href="#dfn-json-ld_output">
JSON-LD
output
</a>
to
an
<del class="diff-old">array,
</del>
<a class="tref internalDFN" title="array" href="#dfn-array">
<ins class="diff-chg">array
</ins></a>,
and
set
<a class="tref internalDFN" title="match_limit" href="#dfn-match_limit">
match
limit
</a>
to
-1.
</li>
<li>
If
the
<strong>
expanded
frame
</strong>
is
a
non-empty
<del class="diff-old">array,
</del>
<a class="tref internalDFN" title="array" href="#dfn-array">
<ins class="diff-chg">array
</ins></a>,
add
each
item
in
the
<strong>
expanded
frame
</strong>
into
the
<a class="tref internalDFN" title="list_of_frames" href="#dfn-list_of_frames">
list
of
frames
</a>,
set
the
<a class="tref internalDFN" title="JSON-LD_output" href="#dfn-json-ld_output">
JSON-LD
output
</a>
to
an
<del class="diff-old">array,
</del>
<a class="tref internalDFN" title="array" href="#dfn-array">
<ins class="diff-chg">array
</ins></a>,
and
set
<a class="tref internalDFN" title="match_limit" href="#dfn-match_limit">
match
limit
</a>
to
-1.
</li>
</ol>
</li>
<li>
Create
a
<dfn title="match_array" id="dfn-match_array">
match
array
</dfn>
for
each
<strong>
expanded
frame
</strong>
in
the
<a class="tref internalDFN" title="list_of_frames" href="#dfn-list_of_frames">
list
of
frames
</a>
halting
when
either
the
<a class="tref internalDFN" title="match_limit" href="#dfn-match_limit">
match
limit
</a>
is
zero
or
the
end
of
the
<a class="tref internalDFN" title="list_of_frames" href="#dfn-list_of_frames">
list
of
frames
</a>
is
reached.
If
an
<strong>
expanded
frame
</strong>
is
not
an
object,
the
processor
<em class="rfc2119" title="must">
must
</em>
throw
a
<code>
Invalid
Frame
Format
</code>
exception.
Add
each
matching
item
from
the
<strong>
normalized
input
</strong>
to
the
<a class="tref" title="matches_array">
matches
array
</a>
and
decrement
the
<a class="tref internalDFN" title="match_limit" href="#dfn-match_limit">
match
limit
</a>
by
1
if:
<ol class="algorithm">
<li>
The
<strong>
expanded
frame
</strong>
has
an
<code>
rdf:type
</code>
that
exists
in
the
item's
list
of
<code>
rdf:type
</code>
s.
Note:
the
<code>
rdf:type
</code>
can
be
an
<del class="diff-old">array,
</del>
<a class="tref internalDFN" title="array" href="#dfn-array">
<ins class="diff-chg">array
</ins></a>,
but
only
one
value
needs
to
be
in
common
between
the
item
and
the
<strong>
expanded
frame
</strong>
for
a
match.
</li>
<li>
The
<strong>
expanded
frame
</strong>
does
not
have
an
<code>
rdf:type
</code>
property,
but
every
property
in
the
<strong>
expanded
frame
</strong>
exists
in
the
item.
</li>
</ol>
</li>
<li>
Process
each
item
in
the
<a class="tref internalDFN" title="match_array" href="#dfn-match_array">
match
array
</a>
with
its
associated
<dfn title="match_frame" id="dfn-match_frame">
match
frame
</dfn>:
<ol class="algorithm">
<li>
If
the
<a class="tref internalDFN" title="match_frame" href="#dfn-match_frame">
match
frame
</a>
contains
an
<code>
@embed
</code>
keyword,
set
the
<a class="tref internalDFN" title="object_embed_flag" href="#dfn-object_embed_flag">
object
embed
flag
</a>
to
its
value.
If
the
<a class="tref internalDFN" title="match_frame" href="#dfn-match_frame">
match
frame
</a>
contains
an
<code>
@explicit
</code>
keyword,
set
the
<a class="tref internalDFN" title="explicit_inclusion_flag" href="#dfn-explicit_inclusion_flag">
explicit
inclusion
flag
</a>
to
its
value.
Note:
if
the
keyword
exists,
but
the
value
is
neither
<code>
true
</code>
or
<code>
false
</code>,
set
the
associated
flag
to
<code>
true
</code>.
</li>
<li>
If
the
<a class="tref internalDFN" title="object_embed_flag" href="#dfn-object_embed_flag">
object
embed
flag
</a>
is
cleared
and
the
item
has
the
<code>
@subject
</code>
property,
replace
the
item
with
the
value
of
the
<code>
@subject
</code>
property.
</li>
<li>
If
the
<a class="tref internalDFN" title="object_embed_flag" href="#dfn-object_embed_flag">
object
embed
flag
</a>
is
set
and
the
item
has
the
<code>
@subject
</code>
property,
and
its
IRI
is
in
the
<a class="tref internalDFN" title="map_of_embedded_subjects" href="#dfn-map_of_embedded_subjects">
map
of
embedded
subjects
</a>,
throw
a
<code>
Duplicate
Embed
</code>
exception.
</li>
<li>
If
the
<a class="tref internalDFN" title="object_embed_flag" href="#dfn-object_embed_flag">
object
embed
flag
</a>
is
set
and
the
item
has
the
<code>
@subject
</code>
property
and
its
IRI
is
not
in
the
<a class="tref internalDFN" title="map_of_embedded_subjects" href="#dfn-map_of_embedded_subjects">
map
of
embedded
subjects
</a>:
<ol class="algorithm">
<li>
If
the
<a class="tref internalDFN" title="explicit_inclusion_flag" href="#dfn-explicit_inclusion_flag">
explicit
inclusion
flag
</a>
is
set,
then
delete
any
key
from
the
item
that
does
not
exist
in
the
<a class="tref internalDFN" title="match_frame" href="#dfn-match_frame">
match
frame
</a>,
except
<code>
@subject
</code>.
</li>
<li>
For
each
key
in
the
<a class="tref internalDFN" title="match_frame" href="#dfn-match_frame">
match
frame
</a>,
except
for
keywords
and
<code>
rdf:type
</code>:
<ol class="algorithm">
<li>
If
the
key
is
in
the
item,
then
build
a
new
<dfn title="recursion_input_list" id="dfn-recursion_input_list">
recursion
input
list
</dfn>
using
the
object
or
objects
associated
with
the
key.
If
any
object
contains
an
<code>
@iri
</code>
value
that
exists
in
the
<a class="tref" title="normalized_input">
normalized
input
</a>,
replace
the
object
in
the
<a class="tref" title="recusion_input_list">
recusion
input
list
</a>
with
a
new
object
containing
the
<code>
@subject
</code>
key
where
the
value
is
the
value
of
the
<code>
@iri
</code>,
and
all
of
the
other
key-value
pairs
for
that
subject.
Set
the
<dfn title="recursion_match_frame" id="dfn-recursion_match_frame">
recursion
match
frame
</dfn>
to
the
value
associated
with
the
<a class="tref internalDFN" title="match_frame" href="#dfn-match_frame">
match
frame
</a>
's
key.
Replace
the
value
associated
with
the
key
by
recursively
calling
this
algorithm
using
<a class="tref internalDFN" title="recursion_input_list" href="#dfn-recursion_input_list">
recursion
input
list
</a>,
<a class="tref internalDFN" title="recursion_match_frame" href="#dfn-recursion_match_frame">
recursion
match
frame
</a>
as
input.
</li>
<li>
If
the
key
is
not
in
the
item,
add
the
key
to
the
item
and
set
the
associated
value
to
an
empty
array
if
the
<a class="tref internalDFN" title="match_frame" href="#dfn-match_frame">
match
frame
</a>
key's
value
is
an
array
or
<code>
null
</code>
otherwise.
</li>
<li>
If
value
associated
with
the
item's
key
is
<code>
null
</code>,
process
the
<a class="tref internalDFN" title="omit_missing_properties_flag" href="#dfn-omit_missing_properties_flag">
omit
missing
properties
flag
</a>:
<ol class="algorithm">
<li>
If
the
value
associated
with
the
key
in
the
<a class="tref internalDFN" title="match_frame" href="#dfn-match_frame">
match
frame
</a>
is
an
array,
use
the
first
frame
from
the
array
as
the
<dfn title="property_frame" id="dfn-property_frame">
property
frame
</dfn>,
otherwise
set
the
<a class="tref internalDFN" title="property_frame" href="#dfn-property_frame">
property
frame
</a>
to
an
empty
object.
</li>
<li>
If
the
<a class="tref internalDFN" title="property_frame" href="#dfn-property_frame">
property
frame
</a>
contains
an
<code>
@omitDefault
</code>
keyword,
set
the
<a class="tref internalDFN" title="omit_missing_properties_flag" href="#dfn-omit_missing_properties_flag">
omit
missing
properties
flag
</a>
to
its
value.
Note:
if
the
keyword
exists,
but
the
value
is
neither
<code>
true
</code>
or
<code>
false
</code>,
set
the
associated
flag
to
<code>
true
</code>.
</li>
<li>
If
the
<a class="tref internalDFN" title="omit_missing_properties_flag" href="#dfn-omit_missing_properties_flag">
omit
missing
properties
flag
</a>
is
set,
delete
the
key
in
the
item.
Otherwise,
if
the
<code>
@default
</code>
keyword
is
set
in
the
<a class="tref internalDFN" title="property_frame" href="#dfn-property_frame">
property
frame
</a>
set
the
item's
value
to
the
value
of
<code>
@default
</code>.
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li>
If
the
<a class="tref internalDFN" title="JSON-LD_output" href="#dfn-json-ld_output">
JSON-LD
output
</a>
is
<code>
null
</code>
set
it
to
the
item,
otherwise,
append
the
item
to
the
<a class="tref internalDFN" title="JSON-LD_output" href="#dfn-json-ld_output">
JSON-LD
output
</a>.
</li>
</ol>
</li>
<li>
Return
the
<a class="tref internalDFN" title="JSON-LD_output" href="#dfn-json-ld_output">
JSON-LD
output
</a>.
</li>
</ol>
The
final,
non-recursive
step
of
the
framing
algorithm
requires
the
<a class="tref internalDFN" title="JSON-LD_output" href="#dfn-json-ld_output">
JSON-LD
output
</a>
to
be
compacted
according
to
the
<a href="#compaction-algorithm">
Compaction
Algorithm
</a>
by
using
the
context
provided
in
the
<a class="tref internalDFN" title="input_frame" href="#dfn-input_frame">
input
frame
</a>.
The
resulting
value
is
the
final
output
of
the
compaction
algorithm
and
is
what
should
be
returned
to
the
application.
</div>
</div>
<div id="normalization-1" class="section">
<h3>
<span class="secno">
<del class="diff-old">5.11
</del>
<ins class="diff-chg">6.11
</ins>
</span>
Normalization
</h3>
<p class="issue">
This
algorithm
is
a
work
in
progress,
do
not
implement
it.
</p>
<p>
Normalization
is
the
process
of
taking
<a class="tref internalDFN" title="JSON-LD_input" href="#dfn-json-ld_input">
JSON-LD
input
</a>
and
performing
a
deterministic
transformation
on
that
input
that
results
in
all
aspects
of
the
graph
being
fully
expanded
and
named
in
the
<a class="tref internalDFN" title="JSON-LD_output" href="#dfn-json-ld_output">
JSON-LD
output
</a>.
The
normalized
output
is
generated
in
such
a
way
that
any
conforming
JSON-LD
processor
will
generate
identical
output
given
the
same
input.
The
problem
is
a
fairly
difficult
technical
problem
to
solve
because
it
requires
a
directed
graph
to
be
ordered
into
a
set
of
nodes
and
edges
in
a
deterministic
way.
This
is
easy
to
do
when
all
of
the
nodes
have
unique
names,
but
very
difficult
to
do
when
some
of
the
nodes
are
not
labeled.
</p>
<p>
In
time,
there
may
be
more
than
one
normalization
algorithm
that
will
need
to
be
identified.
For
identification
purposes,
this
algorithm
is
named
<abbr title="Universal Graph Normalization Algorithm 2011">
UGNA2011
</abbr>.
</p>
<div id="normalization-algorithm-terms" class="section">
<h4>
<span class="secno">
<del class="diff-old">5.11.1
</del>
<ins class="diff-chg">6.11.1
</ins>
</span>
Normalization
Algorithm
Terms
</h4>
<dl>
<dt>
<dfn title="label" id="dfn-label">
<ins class="diff-new">label
</ins></dfn></dt><dd><ins class="diff-new">
The
subject
IRI
associated
with
a
graph
node.
The
subject
IRI
is
expressed
using
a
key-value
pair
in
a
</ins><a class="tref internalDFN" title="JSON_object" href="#dfn-json_object"><ins class="diff-new">
JSON
object
</ins></a><ins class="diff-new">
where
the
key
is
</ins><code><ins class="diff-new">
@subject
</ins></code><ins class="diff-new">
and
the
value
is
a
string
that
is
an
IRI
or
a
</ins><a class="tref internalDFN" title="JSON_object" href="#dfn-json_object"><ins class="diff-new">
JSON
object
</ins></a><ins class="diff-new">
containing
the
key
</ins><code><ins class="diff-new">
@iri
</ins></code><ins class="diff-new">
and
a
value
that
is
a
string
that
is
an
IRI.
</ins></dd><dt>
<dfn title="list_of_expanded_nodes" id="dfn-list_of_expanded_nodes">
list
of
expanded
nodes
</dfn>
</dt>
<dd>
A
list
of
all
nodes
in
the
<a class="tref internalDFN" title="JSON-LD_input" href="#dfn-json-ld_input">
JSON-LD
input
</a>
graph
containing
no
embedded
objects
and
having
all
keys
and
values
expanded
according
to
the
steps
in
the
<a href="#expansion-algorithm">
Expansion
Algorithm
</a>.
</dd>
<dt>
<del class="diff-old">naming
base
string
An
unlabeled
node
naming
prefix
that
is
not
used
by
any
other
node
in
the
JSON-LD
input
and
does
not
start
with
the
characters
c14n
.
The
prefix
is
used
to
temporarily
name
nodes
during
the
normalization
algorithm
in
a
way
that
doesn't
collide
with
the
names
that
already
exist
as
well
as
the
names
that
will
be
generated
by
the
normalization
algorithm.
</del>
<dfn title="alpha" id="dfn-alpha">
alpha
</dfn>
and
<dfn title="beta" id="dfn-beta">
beta
</dfn>
values
</dt>
<dd>
The
words
<a class="tref internalDFN" title="alpha" href="#dfn-alpha">
alpha
</a>
and
<a class="tref internalDFN" title="beta" href="#dfn-beta">
beta
</a>
refer
to
the
first
and
second
nodes
or
values
being
examined
in
an
algorithm.
The
names
are
merely
used
to
refer
to
each
input
value
to
a
comparison
algorithm.
</dd>
<dt>
<del class="diff-old">naming
base
string
</del>
<dfn title="renaming_counter" id="dfn-renaming_counter">
<ins class="diff-chg">renaming
counter
</ins></dfn></dt><dd><ins class="diff-chg">
A
counter
that
is
used
during
the
</ins><a href="#node-relabeling-algorithm"><ins class="diff-chg">
Node
Relabeling
Algorithm
</ins></a>.<ins class="diff-chg">
The
counter
typically
starts
at
one
(1)
and
counts
up
for
every
node
that
is
relabeled.
There
will
be
two
such
renaming
counters
in
an
implementation
of
the
normalization
algorithm.
The
first
is
the
</ins><a class="tref internalDFN" title="labeling_counter" href="#dfn-labeling_counter"><ins class="diff-chg">
labeling
counter
</ins></a><ins class="diff-chg">
and
the
second
is
the
</ins><a class="tref" title="deterministic_labeling_counter"><ins class="diff-chg">
deterministic
labeling
counter
</ins></a>.</dd><dt><dfn title="serialization_label" id="dfn-serialization_label"><ins class="diff-chg">
serialization
label
</ins>
</dfn>
</dt>
<dd>
An
<del class="diff-old">unlabeled
</del>
<ins class="diff-chg">identifier
that
is
created
to
aid
in
the
normalization
process
in
the
</ins><a href="#deep-comparison-algorithm"><ins class="diff-chg">
Deep
Comparison
Algorithm
</ins></a>.<ins class="diff-chg">
The
value
typically
takes
the
form
of
</ins><code><ins class="diff-chg">
s
</ins><NUMBER></code><ins class="diff-chg">
or
</ins><code><ins class="diff-chg">
c
</ins><NUMBER></code>.</dd></dl></div><div id="normalization-state" class="section"><h4><span class="secno"><ins class="diff-chg">
6.11.2
</ins></span><ins class="diff-chg">
Normalization
State
</ins></h4><p><ins class="diff-chg">
When
performing
the
steps
required
by
the
normalization
algorithm,
it
is
helpful
to
track
the
many
pieces
of
information
in
a
data
structure
called
the
</ins><dfn title="normalization_state" id="dfn-normalization_state"><ins class="diff-chg">
normalization
state
</ins></dfn>.<ins class="diff-chg">
Many
of
these
pieces
simply
provide
indexes
into
the
graph.
The
information
contained
in
the
</ins><a class="tref internalDFN" title="normalization_state" href="#dfn-normalization_state"><ins class="diff-chg">
normalization
state
</ins></a><ins class="diff-chg">
is
described
below.
</ins></p><dl><dt><dfn title="node_state" id="dfn-node_state">
node
<del class="diff-old">naming
</del>
<ins class="diff-chg">state
</ins></dfn></dt><dd><ins class="diff-chg">
Each
node
in
the
graph
will
be
assigned
a
</ins><a class="tref internalDFN" title="node_state" href="#dfn-node_state"><ins class="diff-chg">
node
state
</ins></a>.<ins class="diff-chg">
This
state
contains
the
information
necessary
to
deterministically
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-chg">
label
</ins></a><ins class="diff-chg">
all
nodes
in
the
graph.
A
</ins><a class="tref internalDFN" title="node_state" href="#dfn-node_state"><ins class="diff-chg">
node
state
</ins></a><ins class="diff-chg">
includes:
</ins><dl><dt><dfn title="node_reference" id="dfn-node_reference"><ins class="diff-chg">
node
reference
</ins></dfn></dt><dd><ins class="diff-chg">
A
</ins><a class="tref internalDFN" title="node_reference" href="#dfn-node_reference"><ins class="diff-chg">
node
reference
</ins></a><ins class="diff-chg">
is
a
reference
to
a
node
in
the
graph.
For
a
given
</ins><a class="tref internalDFN" title="node_state" href="#dfn-node_state"><ins class="diff-chg">
node
state
</ins></a>,<ins class="diff-chg">
its
</ins><a class="tref internalDFN" title="node_reference" href="#dfn-node_reference"><ins class="diff-chg">
node
reference
</ins></a><ins class="diff-chg">
refers
to
the
node
that
the
state
is
for.
When
a
</ins><a class="tref internalDFN" title="node_state" href="#dfn-node_state"><ins class="diff-chg">
node
state
</ins></a><ins class="diff-chg">
is
created,
its
</ins><a class="tref internalDFN" title="node_reference" href="#dfn-node_reference"><ins class="diff-chg">
node
reference
</ins></a><ins class="diff-chg">
should
be
to
the
node
it
is
created
for.
</ins></dd><dt><dfn title="outgoing_list" id="dfn-outgoing_list"><ins class="diff-chg">
outgoing
list
</ins></dfn></dt><dd><ins class="diff-chg">
Lists
the
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-chg">
label
</ins></a><ins class="diff-chg">
s
for
all
nodes
that
are
properties
of
the
</ins><a class="tref internalDFN" title="node_reference" href="#dfn-node_reference"><ins class="diff-chg">
node
reference
</ins></a>.<ins class="diff-chg">
This
list
should
be
initialized
by
iterating
over
every
object
associated
with
a
property
in
the
</ins><a class="tref internalDFN" title="node_reference" href="#dfn-node_reference"><ins class="diff-chg">
node
reference
</ins></a><ins class="diff-chg">
adding
its
label
if
it
is
another
node.
</ins></dd><dt><dfn title="incoming_list" id="dfn-incoming_list"><ins class="diff-chg">
incoming
list
</ins></dfn></dt><dd><ins class="diff-chg">
Lists
the
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-chg">
label
</ins></a><ins class="diff-chg">
s
for
all
nodes
in
the
graph
for
which
the
</ins><a class="tref internalDFN" title="node_reference" href="#dfn-node_reference"><ins class="diff-chg">
node
reference
</ins></a><ins class="diff-chg">
is
a
property.
This
list
is
initialized
to
an
empty
list.
</ins></dd><dt><dfn title="outgoing_serialization_map" id="dfn-outgoing_serialization_map"><ins class="diff-chg">
outgoing
serialization
map
</ins></dfn></dt><dd><ins class="diff-chg">
Maps
node
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-chg">
label
</ins></a><ins class="diff-chg">
s
to
</ins><a class="tref internalDFN" title="serialization_label" href="#dfn-serialization_label-1"><ins class="diff-chg">
serialization
label
</ins></a><ins class="diff-chg">
s.
This
map
is
initialized
to
an
empty
map.
When
this
map
is
populated,
it
will
be
filled
with
keys
that
are
the
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-chg">
label
</ins></a><ins class="diff-chg">
s
of
every
node
in
the
graph
with
a
label
that
begins
with
</ins><code><ins class="diff-chg">
_:
</ins></code><ins class="diff-chg">
and
that
has
a
path,
via
properties,
that
starts
with
the
</ins><a class="tref internalDFN" title="node_reference" href="#dfn-node_reference"><ins class="diff-chg">
node
reference
</ins></a>.</dd><dt><dfn title="outgoing_serialization" id="dfn-outgoing_serialization"><ins class="diff-chg">
outgoing
serialization
</ins></dfn></dt><dd><ins class="diff-chg">
A
string
that
can
be
lexicographically
compared
to
the
</ins><a class="tref internalDFN" title="outgoing_serialization" href="#dfn-outgoing_serialization"><ins class="diff-chg">
outgoing
serialization
</ins></a><ins class="diff-chg">
s
of
other
</ins><a class="tref internalDFN" title="node_state" href="#dfn-node_state"><ins class="diff-chg">
node
state
</ins></a><ins class="diff-chg">
s.
It
is
a
representation
of
the
</ins><a class="tref internalDFN" title="outgoing_serialization_map" href="#dfn-outgoing_serialization_map"><ins class="diff-chg">
outgoing
serialization
map
</ins></a><ins class="diff-chg">
and
other
related
information.
This
string
is
initialized
to
an
empty
string.
</ins></dd><dt><dfn title="incoming_serialization_map" id="dfn-incoming_serialization_map"><ins class="diff-chg">
incoming
serialization
map
</ins></dfn></dt><dd><ins class="diff-chg">
Maps
node
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-chg">
label
</ins></a><ins class="diff-chg">
s
to
</ins><a class="tref internalDFN" title="serialization_label" href="#dfn-serialization_label-1"><ins class="diff-chg">
serialization
label
</ins></a><ins class="diff-chg">
s.
This
map
is
initialized
to
an
empty
map.
When
this
map
is
populated,
it
will
be
filled
with
keys
that
are
the
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-chg">
label
</ins></a><ins class="diff-chg">
s
of
every
node
in
the
graph
with
a
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-chg">
label
</ins></a><ins class="diff-chg">
that
begins
with
</ins><code><ins class="diff-chg">
_:
</ins></code><ins class="diff-chg">
and
that
has
a
path,
via
properties,
that
ends
with
the
</ins><a class="tref internalDFN" title="node_reference" href="#dfn-node_reference"><ins class="diff-chg">
node
reference
</ins></a>.</dd><dt><dfn title="incoming_serialization" id="dfn-incoming_serialization"><ins class="diff-chg">
incoming
serialization
</ins></dfn></dt><dd><ins class="diff-chg">
A
string
that
can
be
lexicographically
compared
to
the
</ins><a class="tref internalDFN" title="outgoing_serialization" href="#dfn-outgoing_serialization"><ins class="diff-chg">
outgoing
serialization
</ins></a><ins class="diff-chg">
s
of
other
</ins><a class="tref internalDFN" title="node_state" href="#dfn-node_state"><ins class="diff-chg">
node
state
</ins></a><ins class="diff-chg">
s.
It
is
a
representation
of
the
</ins><a class="tref internalDFN" title="incoming_serialization_map" href="#dfn-incoming_serialization_map"><ins class="diff-chg">
incoming
serialization
map
</ins></a><ins class="diff-chg">
and
other
related
information.
This
string
is
initialized
to
an
empty
string.
</ins></dd></dl></dd><dt><dfn title="node_state_map" id="dfn-node_state_map"><ins class="diff-chg">
node
state
map
</ins></dfn></dt><dd><ins class="diff-chg">
A
mapping
from
a
node's
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-chg">
label
</ins></a><ins class="diff-chg">
to
a
</ins><a class="tref internalDFN" title="node_state" href="#dfn-node_state"><ins class="diff-chg">
node
state
</ins></a>.<ins class="diff-chg">
It
is
initialized
to
an
empty
map.
</ins></dd><dt><dfn title="labeling_prefix" id="dfn-labeling_prefix"><ins class="diff-chg">
labeling
</ins>
prefix
</dfn>
</dt>
<dd>
<ins class="diff-new">The
labeling
prefix
is
a
string
</ins>
that
is
<ins class="diff-new">used
as
the
beginning
of
a
node
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-new">
label
</ins></a>.<ins class="diff-new">
It
should
be
initialized
to
a
random
base
string
that
starts
with
the
characters
</ins><code><ins class="diff-new">
_:
</ins></code>,<ins class="diff-new">
is
</ins>
not
used
by
any
other
<del class="diff-old">node
</del>
<ins class="diff-chg">node's
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-chg">
label
</ins></a>
in
the
<a class="tref internalDFN" title="JSON-LD_input" href="#dfn-json-ld_input">
JSON-LD
input
</a>,
and
does
not
start
with
the
characters
<code>
<del class="diff-old">c14n
</del>
<ins class="diff-chg">_:c14n
</ins>
</code>.
The
prefix
<ins class="diff-new">has
two
uses.
First
it
</ins>
is
used
to
temporarily
name
nodes
during
the
normalization
algorithm
in
a
way
that
doesn't
collide
with
the
names
that
already
exist
as
well
as
the
names
that
will
be
generated
by
the
normalization
algorithm.
<ins class="diff-new">Second,
it
will
eventually
be
set
to
</ins><code><ins class="diff-new">
_:c14n
</ins></code><ins class="diff-new">
to
generate
the
final,
deterministic
labels
for
nodes
in
the
graph.
This
prefix
will
be
concatenated
with
the
</ins><a class="tref internalDFN" title="labeling_counter" href="#dfn-labeling_counter"><ins class="diff-new">
labeling
counter
</ins></a><ins class="diff-new">
to
produce
a
node
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-new">
label
</ins></a>.<ins class="diff-new">
For
example,
</ins><code><ins class="diff-new">
_:j8r3k
</ins></code><ins class="diff-new">
is
a
proper
initial
value
for
the
</ins><a class="tref internalDFN" title="labeling_prefix" href="#dfn-labeling_prefix"><ins class="diff-new">
labeling
prefix
</ins></a>.</dd><dt><dfn title="labeling_counter" id="dfn-labeling_counter"><ins class="diff-new">
labeling
counter
</ins></dfn></dt><dd><ins class="diff-new">
A
counter
that
is
used
to
label
nodes.
It
is
appended
to
the
</ins><a class="tref internalDFN" title="labeling_prefix" href="#dfn-labeling_prefix"><ins class="diff-new">
labeling
prefix
</ins></a><ins class="diff-new">
to
create
a
node
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-new">
label
</ins></a>.<ins class="diff-new">
It
is
initialized
to
</ins><code><ins class="diff-new">
1
</ins></code>.</dd><dt><dfn title="map_of_flattened_nodes" id="dfn-map_of_flattened_nodes"><ins class="diff-new">
map
of
flattened
nodes
</ins></dfn></dt><dd><ins class="diff-new">
A
map
containing
a
representation
of
all
nodes
in
the
graph
where
the
key
is
a
node
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-new">
label
</ins></a><ins class="diff-new">
and
the
value
is
a
single
</ins><a class="tref internalDFN" title="JSON_object" href="#dfn-json_object"><ins class="diff-new">
JSON
object
</ins></a><ins class="diff-new">
that
has
no
nested
sub-objects
and
has
had
all
properties
for
the
same
node
merged
into
a
single
</ins><a class="tref internalDFN" title="JSON_object" href="#dfn-json_object"><ins class="diff-new">
JSON
object
</ins></a>.
</dd>
</dl>
</div>
<div id="normalization-algorithm" class="section">
<h4>
<span class="secno">
<del class="diff-old">5.11.2
</del>
<ins class="diff-chg">6.11.3
</ins>
</span>
Normalization
Algorithm
</h4>
<p>
The
normalization
algorithm
expands
the
<a class="tref internalDFN" title="JSON-LD_input" href="#dfn-json-ld_input">
JSON-LD
input
</a>,
flattens
the
data
structure,
and
creates
an
initial
set
of
names
for
all
nodes
in
the
graph.
The
flattened
data
structure
is
then
processed
by
<del class="diff-old">the
</del>
<ins class="diff-chg">a
</ins>
node
labeling
algorithm
in
order
to
get
a
fully
expanded
and
named
list
of
<ins class="diff-new">nodes
which
is
then
sorted.
The
result
is
a
deterministically
named
and
ordered
list
of
graph
</ins>
nodes.
</p>
<ol class="algorithm">
<li>
Expand
the
<a class="tref internalDFN" title="JSON-LD_input" href="#dfn-json-ld_input">
JSON-LD
input
</a>
according
to
the
steps
in
the
<a href="#expansion-algorithm">
Expansion
Algorithm
</a>
and
store
the
result
as
the
<strong>
expanded
input
</strong>.
</li>
<li>
<del class="diff-old">Process
every
object
in
the
expanded
input
searching
for
@subject
values
that
start
with
the
text
string
_:c14n
.
If
a
match
is
found,
rename
the
subject
and
all
references
to
the
subject
by
concatenating
_:
with
the
naming
base
string
and
</del>
<ins class="diff-chg">Create
</ins>
a
<del class="diff-old">unique
identifier,
such
as
an
incremented
counter
value.
</del>
<a class="tref internalDFN" title="normalization_state" href="#dfn-normalization_state">
<ins class="diff-chg">normalization
state
</ins></a>.
</li>
<li>
<del class="diff-old">Create
an
empty
list
</del>
<ins class="diff-chg">Initialize
the
</ins><a class="tref internalDFN" title="map_of_flattened_nodes" href="#dfn-map_of_flattened_nodes"><ins class="diff-chg">
map
</ins>
of
<del class="diff-old">expanded
</del>
<ins class="diff-chg">flattened
</ins>
nodes
</a>
<del class="diff-old">and
</del>
<ins class="diff-chg">by
</ins>
recursively
<del class="diff-old">process
</del>
<ins class="diff-chg">processing
</ins>
every
<del class="diff-old">object
</del>
<dfn title="expanded_node" id="dfn-expanded_node">
<ins class="diff-chg">expanded
node
</ins></dfn>
in
the
<strong>
expanded
input
</strong>
<del class="diff-old">that
is
not
an
expanded
IRI,
typed
literal
or
language
literal,
</del>
in
depth-first
order:
<ol class="algorithm">
<li>
If
<ins class="diff-new">the
</ins><a class="tref internalDFN" title="expanded_node" href="#dfn-expanded_node"><ins class="diff-new">
expanded
node
</ins></a><ins class="diff-new">
is
</ins>
an
<del class="diff-old">object
does
not
contain
</del>
<ins class="diff-chg">unlabeled
node,
add
</ins>
a
<ins class="diff-new">new
key-value
pair
to
the
</ins><a class="tref internalDFN" title="expanded_node" href="#dfn-expanded_node"><ins class="diff-new">
expanded
node
</ins></a><ins class="diff-new">
where
the
key
is
</ins>
<code>
@subject
<del class="diff-old">,
name
it
by
concatenating
_:
</del>
</code>
<del class="diff-old">with
</del>
<ins class="diff-chg">and
</ins>
the
<del class="diff-old">naming
base
string
</del>
<ins class="diff-chg">value
is
the
concatenation
of
the
</ins><a class="tref internalDFN" title="labeling_prefix" href="#dfn-labeling_prefix"><ins class="diff-chg">
labeling
prefix
</ins>
</a>
and
<del class="diff-old">a
unique
identifier,
such
as
an
incremented
</del>
<ins class="diff-chg">the
string
value
of
the
</ins><a class="tref internalDFN" title="labeling_counter" href="#dfn-labeling_counter"><ins class="diff-chg">
labeling
</ins>
counter
<del class="diff-old">value.
</del>
</a>.
<ins class="diff-chg">Increment
the
</ins><a class="tref internalDFN" title="labeling_counter" href="#dfn-labeling_counter"><ins class="diff-chg">
labeling
counter
</ins></a>.
</li>
<li>
Add
the
<del class="diff-old">object
</del>
<a class="tref internalDFN" title="expanded_node" href="#dfn-expanded_node">
<ins class="diff-chg">expanded
node
</ins></a>
to
the
<del class="diff-old">list
</del>
<a class="tref internalDFN" title="map_of_flattened_nodes" href="#dfn-map_of_flattened_nodes">
<ins class="diff-chg">map
</ins>
of
<ins class="diff-new">flattened
nodes
</ins></a>:<ol class="algorithm"><li><ins class="diff-new">
If
the
</ins><a class="tref internalDFN" title="expanded_node" href="#dfn-expanded_node">
expanded
<ins class="diff-new">node
</ins></a><ins class="diff-new">
's
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-new">
label
</ins></a><ins class="diff-new">
is
already
in
the
</ins><a class="tref internalDFN" title="map_of_flattened_nodes" href="#dfn-map_of_flattened_nodes"><ins class="diff-new">
map
of
flattened
</ins>
nodes
<del class="diff-old">.
</del>
</a>
<ins class="diff-new">merge
all
properties
from
the
entry
in
the
</ins><a class="tref internalDFN" title="map_of_flattened_nodes" href="#dfn-map_of_flattened_nodes"><ins class="diff-new">
map
of
flattened
nodes
</ins></a><ins class="diff-new">
into
the
</ins><a class="tref internalDFN" title="expanded_node" href="#dfn-expanded_node"><ins class="diff-new">
expanded
node
</ins></a>.</li><li><ins class="diff-new">
Go
through
every
property
associated
with
an
array
in
the
</ins><a class="tref internalDFN" title="expanded_node" href="#dfn-expanded_node"><ins class="diff-new">
expanded
node
</ins></a><ins class="diff-new">
and
remove
any
duplicate
IRI
entries
from
the
array.
If
the
resulting
array
only
has
one
IRI
entry,
change
it
from
an
array
to
an
object.
</ins></li><li><ins class="diff-new">
Set
the
entry
for
the
</ins><a class="tref internalDFN" title="expanded_node" href="#dfn-expanded_node"><ins class="diff-new">
expanded
node
</ins></a><ins class="diff-new">
's
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-new">
label
</ins></a><ins class="diff-new">
in
the
</ins><a class="tref internalDFN" title="map_of_flattened_nodes" href="#dfn-map_of_flattened_nodes"><ins class="diff-new">
map
of
flattened
nodes
</ins></a><ins class="diff-new">
to
the
</ins><a class="tref internalDFN" title="expanded_node" href="#dfn-expanded_node"><ins class="diff-new">
expanded
node
</ins></a>.</li></ol>
</li>
<li>
<del class="diff-old">Replace
</del>
<ins class="diff-chg">After
exiting
the
recursive
step,
replace
</ins>
the
reference
to
the
<del class="diff-old">object
</del>
<a class="tref internalDFN" title="expanded_node" href="#dfn-expanded_node">
<ins class="diff-chg">expanded
node
</ins></a>
with
<ins class="diff-new">an
object
containing
a
single
key-value
pair
where
the
key
is
</ins><code><ins class="diff-new">
@iri
</ins></code><ins class="diff-new">
and
the
value
is
</ins>
the
value
of
the
<code>
@subject
</code>
<ins class="diff-new">key
</ins>
in
the
<del class="diff-old">object.
</del>
<ins class="diff-chg">node.
</ins></li></ol>
</li>
<li>
<del class="diff-old">???duplicate
objects
for
predicates???
</del>
<ins class="diff-chg">For
every
entry
in
the
</ins><a class="tref internalDFN" title="map_of_flattened_nodes" href="#dfn-map_of_flattened_nodes"><ins class="diff-chg">
map
of
flattened
nodes
</ins></a>,<ins class="diff-chg">
insert
a
key-value
pair
into
the
</ins><a class="tref internalDFN" title="node_state_map" href="#dfn-node_state_map"><ins class="diff-chg">
node
state
map
</ins></a><ins class="diff-chg">
where
the
key
is
the
key
from
the
</ins><a class="tref internalDFN" title="map_of_flattened_nodes" href="#dfn-map_of_flattened_nodes"><ins class="diff-chg">
map
of
flattened
nodes
</ins></a><ins class="diff-chg">
and
the
value
is
a
</ins><a class="tref internalDFN" title="node_state" href="#dfn-node_state"><ins class="diff-chg">
node
state
</ins></a><ins class="diff-chg">
where
its
</ins><a class="tref internalDFN" title="node_reference" href="#dfn-node_reference"><ins class="diff-chg">
node
reference
</ins></a><ins class="diff-chg">
refers
to
the
value
from
the
</ins><a class="tref internalDFN" title="map_of_flattened_nodes" href="#dfn-map_of_flattened_nodes"><ins class="diff-chg">
map
of
flattened
nodes
</ins></a>.
</li>
<li>
<ins class="diff-new">Populate
the
</ins><a class="tref internalDFN" title="incoming_list" href="#dfn-incoming_list"><ins class="diff-new">
incoming
list
</ins></a><ins class="diff-new">
for
each
</ins><a class="tref internalDFN" title="node_state" href="#dfn-node_state"><ins class="diff-new">
node
state
</ins></a><ins class="diff-new">
by
iterating
over
every
node
in
the
graph
and
adding
its
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-new">
label
</ins></a><ins class="diff-new">
to
the
</ins><a class="tref internalDFN" title="incoming_list" href="#dfn-incoming_list"><ins class="diff-new">
incoming
list
</ins></a><ins class="diff-new">
associated
with
each
node
found
in
its
properties.
</ins>
</li>
<li>
<ins class="diff-new">For
every
entry
in
the
</ins><a class="tref internalDFN" title="node_state_map" href="#dfn-node_state_map"><ins class="diff-new">
node
state
map
</ins></a><ins class="diff-new">
that
has
a
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-new">
label
</ins></a><ins class="diff-new">
that
begins
with
</ins><code><ins class="diff-new">
_:c14n
</ins></code>,<ins class="diff-new">
relabel
the
node
using
the
</ins><a href="#node-relabeling-algorithm"><ins class="diff-new">
Node
Relabeling
Algorithm
</ins></a>.</li><li>
Label
all
of
the
nodes
that
contain
a
<code>
@subject
</code>
key
associated
with
a
value
starting
with
<code>
_:
</code>
according
to
the
steps
in
the
<del class="diff-old">Node
</del>
<a href="#deterministic-labeling-algorithm">
<ins class="diff-chg">Deterministic
</ins>
Labeling
Algorithm
</a>.
</li>
</ol>
</div>
<div id="node-relabeling-algorithm" class="section">
<h4>
<span class="secno">
<del class="diff-old">5.11.3
</del>
<ins class="diff-chg">6.11.4
</ins>
</span>
Node
<del class="diff-old">Labeling
</del>
<ins class="diff-chg">Relabeling
</ins>
Algorithm
</h4>
<p>
<ins class="diff-new">This
algorithm
renames
a
node
by
generating
a
unique
</ins><dfn title="new_label" id="dfn-new_label"><ins class="diff-new">
new
label
</ins></dfn><ins class="diff-new">
and
updating
all
references
to
that
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-new">
label
</ins></a><ins class="diff-new">
in
the
</ins><a class="tref internalDFN" title="node_state_map" href="#dfn-node_state_map"><ins class="diff-new">
node
state
map
</ins></a>.<ins class="diff-new">
The
</ins><dfn title="old_label" id="dfn-old_label"><ins class="diff-new">
old
label
</ins></dfn><ins class="diff-new">
and
the
</ins><a class="tref internalDFN" title="normalization_state" href="#dfn-normalization_state"><ins class="diff-new">
normalization
state
</ins></a><ins class="diff-new">
must
be
given
as
an
input
to
the
algorithm.
The
</ins><a class="tref internalDFN" title="old_label" href="#dfn-old_label"><ins class="diff-new">
old
label
</ins></a><ins class="diff-new">
is
the
current
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-new">
label
</ins></a><ins class="diff-new">
of
the
node
that
is
to
be
relabeled.
</ins></p><p>
The
node
<ins class="diff-new">relabeling
algorithm
is
as
follows:
</ins></p><ol class="algorithm"><li><ins class="diff-new">
If
the
</ins><a class="tref internalDFN" title="labeling_prefix" href="#dfn-labeling_prefix"><ins class="diff-new">
labeling
prefix
</ins></a><ins class="diff-new">
is
</ins><code><ins class="diff-new">
_:c14n
</ins></code><ins class="diff-new">
and
the
</ins><a class="tref internalDFN" title="old_label" href="#dfn-old_label"><ins class="diff-new">
old
label
</ins></a><ins class="diff-new">
begins
with
</ins><code><ins class="diff-new">
_:c14n
</ins></code><ins class="diff-new">
then
return
as
the
node
has
already
been
renamed.
</ins></li><li><ins class="diff-new">
Generate
the
</ins><dfn title="new_label" id="dfn-new_label-1"><ins class="diff-new">
new
label
</ins></dfn><ins class="diff-new">
by
concatenating
the
</ins><a class="tref internalDFN" title="labeling_prefix" href="#dfn-labeling_prefix"><ins class="diff-new">
labeling
prefix
</ins></a><ins class="diff-new">
with
the
string
value
of
the
</ins><a class="tref internalDFN" title="labeling_counter" href="#dfn-labeling_counter"><ins class="diff-new">
labeling
counter
</ins></a>.<ins class="diff-new">
Increment
the
</ins><a class="tref internalDFN" title="labeling_counter" href="#dfn-labeling_counter"><ins class="diff-new">
labeling
counter
</ins></a>.</li><li><ins class="diff-new">
For
the
</ins><a class="tref internalDFN" title="node_state" href="#dfn-node_state"><ins class="diff-new">
node
state
</ins></a><ins class="diff-new">
associated
with
the
</ins><a class="tref internalDFN" title="old_label" href="#dfn-old_label"><ins class="diff-new">
old
label
</ins></a>,<ins class="diff-new">
update
every
node
in
the
</ins><a class="tref internalDFN" title="incoming_list" href="#dfn-incoming_list"><ins class="diff-new">
incoming
list
</ins></a><ins class="diff-new">
by
changing
all
the
properties
that
reference
the
</ins><a class="tref internalDFN" title="old_label" href="#dfn-old_label"><ins class="diff-new">
old
label
</ins></a><ins class="diff-new">
to
the
</ins><a class="tref internalDFN" title="new_label" href="#dfn-new_label-1"><ins class="diff-new">
new
label
</ins></a>.</li><li><ins class="diff-new">
Change
the
</ins><a class="tref internalDFN" title="old_label" href="#dfn-old_label"><ins class="diff-new">
old
label
</ins></a><ins class="diff-new">
key
in
the
</ins><a class="tref internalDFN" title="node_state_map" href="#dfn-node_state_map"><ins class="diff-new">
node
state
map
</ins></a><ins class="diff-new">
to
the
</ins><a class="tref internalDFN" title="new_label" href="#dfn-new_label-1"><ins class="diff-new">
new
label
</ins></a><ins class="diff-new">
and
set
the
associated
</ins><a class="tref internalDFN" title="node_reference" href="#dfn-node_reference"><ins class="diff-new">
node
reference
</ins></a><ins class="diff-new">
's
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-new">
label
</ins></a><ins class="diff-new">
to
the
</ins><a class="tref internalDFN" title="new_label" href="#dfn-new_label-1"><ins class="diff-new">
new
label
</ins></a>.</li></ol></div><div id="deterministic-labeling-algorithm" class="section"><h4><span class="secno"><ins class="diff-new">
6.11.5
</ins></span><ins class="diff-new">
Deterministic
Labeling
Algorithm
</ins></h4><p><ins class="diff-new">
The
deterministic
</ins>
labeling
algorithm
takes
the
<a class="tref internalDFN" title="normalization_state" href="#dfn-normalization_state">
<ins class="diff-chg">normalization
state
</ins></a><ins class="diff-chg">
and
produces
a
</ins><dfn title="list_of_finished_nodes" id="dfn-list_of_finished_nodes">
list
of
<del class="diff-old">expanded
</del>
<ins class="diff-chg">finished
</ins>
nodes
</dfn>
<ins class="diff-chg">that
is
sorted
</ins>
and
<del class="diff-old">sorts
the
list,
</del>
<ins class="diff-chg">contains
</ins>
deterministically
<del class="diff-old">naming
all
of
the
unlabeled
</del>
<ins class="diff-chg">named
and
expanded
</ins>
nodes
<del class="diff-old">in
</del>
<ins class="diff-chg">from
</ins>
the
graph.
</p>
<ol class="algorithm">
<li>
<del class="diff-old">Create
a
forward
mapping
that
relates
graph
nodes
</del>
<ins class="diff-chg">Set
the
</ins><a class="tref internalDFN" title="labeling_prefix" href="#dfn-labeling_prefix"><ins class="diff-chg">
labeling
prefix
</ins></a>
to
<code>
<ins class="diff-new">_:c14n
</ins></code>,
the
<del class="diff-old">IRIs
</del>
<a class="tref internalDFN" title="labeling_counter" href="#dfn-labeling_counter">
<ins class="diff-chg">labeling
counter
</ins></a><ins class="diff-chg">
to
</ins><code><ins class="diff-chg">
1
</ins></code>,<ins class="diff-chg">
the
</ins><dfn title="list_of_finished_nodes" id="dfn-list_of_finished_nodes-1"><ins class="diff-chg">
list
</ins>
of
<ins class="diff-new">finished
nodes
</ins></dfn><ins class="diff-new">
to
an
empty
array,
and
create
an
empty
array,
</ins>
the
<del class="diff-old">targets
</del>
<dfn title="list_of_unfinished_nodes" id="dfn-list_of_unfinished_nodes">
<ins class="diff-chg">list
of
unfinished
</ins>
nodes
<del class="diff-old">that
they
reference.
</del>
</dfn>.
</li>
<li>
For
<del class="diff-old">example,
if
a
</del>
<ins class="diff-chg">each
</ins><a class="tref internalDFN" title="node_reference" href="#dfn-node_reference">
node
<del class="diff-old">alpha
</del>
<ins class="diff-chg">reference
</ins>
</a>
<del class="diff-old">refers
to
a
</del>
<ins class="diff-chg">in
the
</ins><a class="tref internalDFN" title="node_state_map" href="#dfn-node_state_map">
node
<del class="diff-old">beta
</del>
<ins class="diff-chg">state
map
</ins></a>:<ol class="algorithm"><li><ins class="diff-chg">
If
the
node's
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-chg">
label
</ins>
</a>
<del class="diff-old">via
a
property,
</del>
<ins class="diff-chg">does
not
start
with
</ins><code><ins class="diff-chg">
_:
</ins></code><ins class="diff-chg">
then
put
</ins>
the
<del class="diff-old">key
</del>
<a class="tref internalDFN" title="node_reference" href="#dfn-node_reference">
<ins class="diff-chg">node
reference
</ins></a>
in
the
<del class="diff-old">forward
mapping
</del>
<a class="tref internalDFN" title="list_of_finished_nodes" href="#dfn-list_of_finished_nodes-1">
<ins class="diff-chg">list
of
finished
nodes
</ins></a>.</li><li><ins class="diff-chg">
If
the
node's
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-chg">
label
</ins>
</a>
<del class="diff-old">is
</del>
<ins class="diff-chg">does
start
with
</ins><code><ins class="diff-chg">
_:
</ins></code><ins class="diff-chg">
then
put
</ins>
the
<del class="diff-old">subject
IRI
</del>
<a class="tref internalDFN" title="node_reference" href="#dfn-node_reference">
<ins class="diff-chg">node
reference
</ins></a><ins class="diff-chg">
in
the
</ins><a class="tref internalDFN" title="list_of_unfinished_nodes" href="#dfn-list_of_unfinished_nodes"><ins class="diff-chg">
list
</ins>
of
<del class="diff-old">alpha
</del>
<ins class="diff-chg">unfinished
nodes
</ins></a>.</li></ol></li><li><ins class="diff-chg">
Append
to
the
</ins><a class="tref internalDFN" title="list_of_finished_nodes" href="#dfn-list_of_finished_nodes-1"><ins class="diff-chg">
list
of
finished
nodes
</ins>
</a>
<del class="diff-old">and
</del>
<ins class="diff-chg">by
processing
</ins>
the
<del class="diff-old">value
is
an
array
containing
at
least
</del>
<ins class="diff-chg">remainder
of
</ins>
the
<del class="diff-old">subject
IRI
</del>
<a class="tref internalDFN" title="list_of_unfinished_nodes" href="#dfn-list_of_unfinished_nodes">
<ins class="diff-chg">list
</ins>
of
<del class="diff-old">beta
.
</del>
<ins class="diff-chg">unfinished
nodes
</ins></a><ins class="diff-chg">
until
it
is
empty:
</ins>
<ol class="algorithm">
<li>
<del class="diff-old">Add
all
forward
mappings
for
every
node
</del>
<ins class="diff-chg">Sort
the
</ins><a class="tref internalDFN" title="list_of_unfinished_nodes" href="#dfn-list_of_unfinished_nodes"><ins class="diff-chg">
list
of
unfinished
nodes
</ins></a>
in
<ins class="diff-new">descending
order
according
to
</ins>
the
<del class="diff-old">graph.
</del>
<a href="#deep-comparison-algorithm">
<ins class="diff-chg">Deep
Comparison
Algorithm
</ins></a><ins class="diff-chg">
to
determine
the
sort
order.
</ins>
</li>
<li>
Create
a
<del class="diff-old">reverse
mapping
</del>
<dfn title="list_of_labels" id="dfn-list_of_labels">
<ins class="diff-chg">list
of
labels
</ins>
</dfn>
<del class="diff-old">that
relates
graph
nodes
</del>
<ins class="diff-chg">and
initialize
it
</ins>
to
<del class="diff-old">every
other
</del>
<ins class="diff-chg">an
empty
array.
</ins></li><li><ins class="diff-chg">
For
the
first
</ins>
node
<del class="diff-old">that
refers
</del>
<ins class="diff-chg">from
the
</ins><a class="tref internalDFN" title="list_of_unfinished_nodes" href="#dfn-list_of_unfinished_nodes"><ins class="diff-chg">
list
of
unfinished
nodes
</ins></a>:<ol class="algorithm"><li><ins class="diff-chg">
Add
its
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-chg">
label
</ins></a>
to
<del class="diff-old">them
in
</del>
the
<del class="diff-old">graph.
</del>
<a class="tref internalDFN" title="list_of_labels" href="#dfn-list_of_labels">
<ins class="diff-chg">list
of
labels
</ins></a>.</li><li>
For
<del class="diff-old">example,
if
</del>
<ins class="diff-chg">each
key-value
pair
from
its
associated
</ins><a class="tref internalDFN" title="outgoing_serialization_map" href="#dfn-outgoing_serialization_map"><ins class="diff-chg">
outgoing
serialization
map
</ins></a>,<ins class="diff-chg">
add
the
key
to
</ins>
a
<del class="diff-old">node
alpha
refers
</del>
<ins class="diff-chg">list
and
then
sort
the
list
according
to
the
lexicographical
order
of
the
keys'
associated
values.
Append
the
list
to
the
</ins><a class="tref" title="list_of_nodes_to_label"><ins class="diff-chg">
list
of
nodes
to
label
</ins></a>.</li><li><ins class="diff-chg">
For
each
key-value
pair
from
its
associated
</ins><a class="tref internalDFN" title="incoming_serialization_map" href="#dfn-incoming_serialization_map"><ins class="diff-chg">
incoming
serialization
map
</ins></a>,<ins class="diff-chg">
add
the
key
</ins>
to
a
<ins class="diff-new">list
and
then
sort
the
list
according
to
the
lexicographical
order
of
the
keys'
associated
values.
Append
the
list
to
the
</ins><a class="tref" title="list_of_nodes_to_label"><ins class="diff-new">
list
of
nodes
to
label
</ins></a>.</li></ol></li><li><ins class="diff-new">
For
each
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-new">
label
</ins></a><ins class="diff-new">
in
the
</ins><a class="tref internalDFN" title="list_of_labels" href="#dfn-list_of_labels"><ins class="diff-new">
list
of
labels
</ins></a>,<ins class="diff-new">
relabel
the
associated
</ins>
node
<del class="diff-old">beta
</del>
<ins class="diff-chg">according
to
the
</ins><a href="#node-relabeling-algorithm"><ins class="diff-chg">
Node
Relabeling
Algorithm
</ins></a>.<ins class="diff-chg">
If
any
</ins><a class="tref internalDFN" title="outgoing_serialization_map" href="#dfn-outgoing_serialization_map"><ins class="diff-chg">
outgoing
serialization
map
</ins>
</a>
<del class="diff-old">via
</del>
<ins class="diff-chg">contains
</ins>
a
<del class="diff-old">property,
the
</del>
key
<del class="diff-old">in
</del>
<ins class="diff-chg">that
matches
</ins>
the
<del class="diff-old">reverse
mapping
is
</del>
<a class="tref internalDFN" title="label" href="#dfn-label">
<ins class="diff-chg">label
</ins></a>,<ins class="diff-chg">
clear
</ins>
the
<del class="diff-old">subject
IRI
for
beta
</del>
<ins class="diff-chg">map
</ins>
and
<ins class="diff-new">set
</ins>
the
<del class="diff-old">value
is
</del>
<ins class="diff-chg">associated
</ins><a class="tref internalDFN" title="outgoing_serialization" href="#dfn-outgoing_serialization"><ins class="diff-chg">
outgoing
serialization
</ins></a><ins class="diff-chg">
to
</ins>
an
<del class="diff-old">array
containing
at
least
</del>
<ins class="diff-chg">empty
string.
If
any
</ins><a class="tref internalDFN" title="incoming_serialization_map" href="#dfn-incoming_serialization_map"><ins class="diff-chg">
incoming
serialization
map
</ins></a><ins class="diff-chg">
contains
a
key
that
matches
</ins>
the
<del class="diff-old">IRI
for
alpha
.
</del>
<a class="tref internalDFN" title="label" href="#dfn-label">
<ins class="diff-chg">label
</ins></a>,<ins class="diff-chg">
clear
the
map
and
set
the
associated
</ins><a class="tref internalDFN" title="incoming_serialization" href="#dfn-incoming_serialization"><ins class="diff-chg">
incoming
serialization
</ins></a><ins class="diff-chg">
to
an
empty
string.
</ins></li>
<li>
<del class="diff-old">Add
all
reverse
mappings
for
every
</del>
<ins class="diff-chg">Remove
each
</ins>
node
<del class="diff-old">in
</del>
<ins class="diff-chg">with
a
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-chg">
label
</ins></a><ins class="diff-chg">
that
starts
with
</ins><code><ins class="diff-chg">
_:c14n
</ins></code><ins class="diff-chg">
from
</ins>
the
<del class="diff-old">graph.
</del>
<a class="tref internalDFN" title="list_of_unfinished_nodes" href="#dfn-list_of_unfinished_nodes">
<ins class="diff-chg">list
of
unfinished
nodes
</ins></a><ins class="diff-chg">
and
add
it
to
the
</ins><a class="tref internalDFN" title="list_of_finished_nodes" href="#dfn-list_of_finished_nodes-1"><ins class="diff-chg">
list
of
finished
nodes
</ins></a>.
</li>
</ol>
</li>
<li>
<del class="diff-old">Label
every
unlabeled
node
according
to
</del>
<ins class="diff-chg">Sort
</ins>
the
<del class="diff-old">Label
Generation
Algorithm
</del>
<a class="tref internalDFN" title="list_of_finished_nodes" href="#dfn-list_of_finished_nodes-1">
<ins class="diff-chg">list
of
finished
nodes
</ins>
</a>
in
descending
order
<del class="diff-old">using
</del>
<ins class="diff-chg">according
to
</ins>
the
<a href="#deep-comparison-algorithm">
Deep
Comparison
Algorithm
</a>
to
determine
the
sort
order.
</li>
</ol>
</div>
<div id="shallow-comparison-algorithm" class="section">
<h4>
<span class="secno">
<del class="diff-old">5.11.4
</del>
<ins class="diff-chg">6.11.6
</ins>
</span>
Shallow
Comparison
Algorithm
</h4>
<p>
The
shallow
comparison
algorithm
takes
two
unlabeled
nodes,
<a class="tref internalDFN" title="alpha" href="#dfn-alpha">
alpha
</a>
and
<a class="tref internalDFN" title="beta" href="#dfn-beta">
beta
</a>,
as
input
and
determines
which
one
should
come
first
in
a
sorted
list.
The
following
algorithm
determines
the
steps
that
are
executed
in
order
to
determine
the
node
that
should
come
first
in
a
list:
</p>
<ol class="algorithm">
<li>
Compare
the
total
number
of
node
properties.
The
node
with
fewer
properties
is
first.
</li>
<li>
Lexicographically
sort
the
property
IRIs
for
each
node
and
compare
the
sorted
lists.
If
an
IRI
is
found
to
be
lexicographically
smaller,
the
node
containing
that
IRI
is
first.
</li>
<li>
Compare
the
property
values
against
one
another:
<ol class="algorithm">
<li>
Create
an
<dfn title="alpha_list" id="dfn-alpha_list">
alpha
list
</dfn>
by
adding
all
values
associated
with
the
<a class="tref internalDFN" title="alpha" href="#dfn-alpha">
alpha
</a>
property
that
is
not
an
unlabeled
node.
Track
the
number
of
unlabeled
nodes
not
added
to
the
list
using
an
<dfn title="alpha_unlabeled_counter" id="dfn-alpha_unlabeled_counter">
alpha
unlabeled
counter
</dfn>.
</li>
<li>
Create
a
<dfn title="beta_list" id="dfn-beta_list">
beta
list
</dfn>
by
adding
all
values
associated
with
the
<a class="tref internalDFN" title="beta" href="#dfn-beta">
beta
</a>
property
that
is
not
an
unlabeled
node.
Track
the
number
of
unlabeled
nodes
not
added
to
the
list
using
an
<dfn title="beta_unlabeled_counter" id="dfn-beta_unlabeled_counter">
beta
unlabeled
counter
</dfn>.
</li>
<li>
Compare
the
length
of
<a class="tref internalDFN" title="alpha_list" href="#dfn-alpha_list">
alpha
list
</a>
and
<a class="tref internalDFN" title="beta_list" href="#dfn-beta_list">
beta
list
</a>.
The
node
associated
with
the
list
containing
the
lesser
number
of
items
is
first.
</li>
<li>
Compare
the
<a class="tref internalDFN" title="alpha_unlabeled_counter" href="#dfn-alpha_unlabeled_counter">
alpha
unlabeled
counter
</a>
to
the
<a class="tref internalDFN" title="beta_unlabeled_counter" href="#dfn-beta_unlabeled_counter">
beta
unlabeled
counter
</a>,
the
node
associated
with
the
lesser
value
is
first.
</li>
<li>
Sort
<a class="tref internalDFN" title="alpha_list" href="#dfn-alpha_list">
alpha
list
</a>
and
<a class="tref internalDFN" title="beta_list" href="#dfn-beta_list">
beta
list
</a>
<del class="diff-old">using
</del>
<ins class="diff-chg">according
to
</ins>
the
<a href="#object-comparison-algorithm">
Object
Comparison
Algorithm
</a>
as
the
sorting
comparator.
For
each
offset
into
the
<a class="tref internalDFN" title="alpha_list" href="#dfn-alpha_list">
alpha
list
</a>,
compare
the
item
at
the
offset
against
the
item
at
the
same
offset
in
the
<a class="tref internalDFN" title="beta_list" href="#dfn-beta_list">
beta
list
</a>
<del class="diff-old">using
</del>
<ins class="diff-chg">according
to
</ins>
the
<a href="#object-comparison-algorithm">
Object
Comparison
Algorithm
</a>.
The
node
associated
with
the
lesser
item
is
first.
</li>
</ol>
</li>
<li>
Process
the
<del class="diff-old">reverse
mapping
</del>
<a class="tref internalDFN" title="incoming_list" href="#dfn-incoming_list">
<ins class="diff-chg">incoming
list
</ins>
</a>
<ins class="diff-new">s
associated
with
each
node
</ins>
to
determine
order:
<ol class="algorithm">
<li>
The
node
with
<del class="diff-old">fewer
entries
in
</del>
the
<del class="diff-old">reverse
mapping
</del>
<ins class="diff-chg">shortest
</ins><a class="tref internalDFN" title="incoming_list" href="#dfn-incoming_list"><ins class="diff-chg">
incoming
list
</ins>
</a>
is
first.
</li>
<li>
Sort
the
<del class="diff-old">reverse
mapping
entry
for
alpha
into
a
</del>
<a class="tref internalDFN" title="incoming_list" href="#dfn-incoming_list">
<ins class="diff-chg">incoming
</ins>
list
<del class="diff-old">of
sorted
alpha
mappings
.
Sort
the
reverse
mapping
</del>
</a>
<del class="diff-old">entry
for
beta
into
a
list
of
sorted
beta
mappings
.
</del>
<ins class="diff-chg">s
according
to
incoming
property
and
then
incoming
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-chg">
label
</ins></a>.
</li>
<li>
The
node
associated
with
the
<del class="diff-old">list
of
sorted
mappings
with
the
</del>
least
number
of
<ins class="diff-new">incoming
</ins>
unlabeled
nodes
is
first.
</li>
<li>
For
each
offset
into
the
<a class="tref internalDFN" title="incoming_list" href="#dfn-incoming_list">
<ins class="diff-chg">incoming
</ins>
list
<del class="diff-old">of
sorted
alpha
mappings
,
</del>
</a>
<ins class="diff-chg">s,
</ins>
compare
the
<del class="diff-old">IRI
at
the
offset
against
the
IRI
at
the
same
offset
in
</del>
<ins class="diff-chg">associated
properties
and
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-chg">
label
</ins></a><ins class="diff-chg">
s.
The
node
associated
with
</ins>
the
<del class="diff-old">list
of
sorted
beta
mappings
.
</del>
<ins class="diff-chg">lexicographically
lesser
associated
property
is
first.
</ins>
The
node
associated
with
the
lexicographically
lesser
<del class="diff-old">IRI
</del>
<a class="tref internalDFN" title="label" href="#dfn-label">
<ins class="diff-chg">label
</ins></a>
is
first.
</li>
</ol>
</li>
<li>
Otherwise,
the
nodes
are
<del class="diff-old">equal.
</del>
<ins class="diff-chg">equivalent.
</ins>
</li>
</ol>
</div>
<div id="object-comparison-algorithm" class="section">
<h4>
<span class="secno">
<del class="diff-old">5.11.5
</del>
<ins class="diff-chg">6.11.7
</ins>
</span>
Object
Comparison
Algorithm
</h4>
<p>
The
object
comparison
algorithm
is
designed
to
compare
two
graph
node
property
values,
<a class="tref internalDFN" title="alpha" href="#dfn-alpha">
alpha
</a>
and
<a class="tref internalDFN" title="beta" href="#dfn-beta">
beta
</a>,
against
the
other.
The
algorithm
is
useful
when
sorting
two
lists
of
graph
node
properties.
</p>
<ol class="algorithm">
<li>
If
one
of
the
values
is
a
<a class="tref internalDFN" title="string" href="#dfn-string">
string
</a>
and
the
other
is
not,
the
value
that
is
a
string
is
first.
</li>
<li>
If
both
values
are
<del class="diff-old">strings,
</del>
<a class="tref internalDFN" title="string" href="#dfn-string">
<ins class="diff-chg">string
</ins></a><ins class="diff-chg">
s,
</ins>
the
lexicographically
lesser
string
is
first.
</li>
<li>
If
one
of
the
values
is
a
literal
and
the
other
is
not,
the
value
that
is
a
literal
is
first.
</li>
<li>
If
both
values
are
literals
<ol class="algorithm">
<li>
The
lexicographically
lesser
string
associated
with
<code>
@literal
</code>
is
first.
</li>
<li>
The
lexicographically
lesser
string
associated
with
<code>
@datatype
</code>
is
first.
</li>
<li>
The
lexicographically
lesser
string
associated
with
<code>
@language
</code>
is
first.
</li>
</ol>
</li>
<li>
If
both
values
are
expanded
IRIs,
the
lexicographically
lesser
string
associated
with
<code>
@iri
</code>
is
first.
</li>
<li>
Otherwise,
the
two
values
are
equivalent.
</li>
</ol>
</div>
<div id="deep-comparison-algorithm" class="section">
<h4>
<span class="secno">
<del class="diff-old">5.11.6
</del>
<ins class="diff-chg">6.11.8
</ins>
</span>
Deep
Comparison
Algorithm
</h4>
<p>
<del class="diff-old">DeepCompare(bnodeA,
bnodeB):
Return
</del>
<ins class="diff-chg">The
deep
comparison
algorithm
is
used
to
compare
the
difference
between
two
nodes,
</ins><a class="tref internalDFN" title="alpha" href="#dfn-alpha"><ins class="diff-chg">
alpha
</ins></a><ins class="diff-chg">
and
</ins><a class="tref internalDFN" title="beta" href="#dfn-beta"><ins class="diff-chg">
beta
</ins></a>.<ins class="diff-chg">
A
deep
comparison
takes
</ins>
the
<ins class="diff-new">incoming
and
outgoing
node
edges
in
a
graph
into
account
if
the
number
of
properties
and
</ins>
value
of
<del class="diff-old">ShallowCompare
</del>
<ins class="diff-chg">those
properties
are
identical.
The
algorithm
is
helpful
when
sorting
a
list
of
nodes
and
will
return
whichever
node
should
be
placed
first
in
a
list
</ins>
if
<ins class="diff-new">the
two
nodes
are
not
truly
equivalent.
</ins></p><p><ins class="diff-new">
When
performing
the
steps
required
by
the
deep
comparison
algorithm,
</ins>
it
is
<del class="diff-old">non-zero.
</del>
<ins class="diff-chg">helpful
to
track
state
information
about
mappings.
The
information
contained
in
a
</ins><a class="tref internalDFN" title="mapping_state" href="#dfn-mapping_state"><ins class="diff-chg">
mapping
state
</ins></a><ins class="diff-chg">
is
described
below.
</ins></p><dl class="algorithm"><dt><dfn title="mapping_state" id="dfn-mapping_state"><ins class="diff-chg">
mapping
state
</ins></dfn></dt><dd><dl><dt><dfn title="mapping_counter" id="dfn-mapping_counter"><ins class="diff-chg">
mapping
counter
</ins></dfn></dt><dd><ins class="diff-chg">
Keeps
track
of
the
number
of
nodes
that
have
been
mapped
to
</ins><a class="tref" title="serialization_labels"><ins class="diff-chg">
serialization
labels
</ins></a>.<ins class="diff-chg">
It
is
initialized
to
</ins><code><ins class="diff-chg">
1
</ins></code>.</dd><dt><dfn title="processed_labels_map" id="dfn-processed_labels_map"><ins class="diff-chg">
processed
labels
map
</ins></dfn></dt><dd><ins class="diff-chg">
Keeps
track
of
the
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-chg">
label
</ins></a><ins class="diff-chg">
s
of
nodes
that
have
already
been
assigned
</ins><a class="tref internalDFN" title="serialization_label" href="#dfn-serialization_label-1"><ins class="diff-chg">
serialization
label
</ins></a><ins class="diff-chg">
s.
It
is
initialized
to
an
empty
map.
</ins></dd><dt><dfn title="serialized_labels_map" id="dfn-serialized_labels_map"><ins class="diff-chg">
serialized
labels
map
</ins></dfn></dt><dd><ins class="diff-chg">
Maps
a
node
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-chg">
label
</ins></a><ins class="diff-chg">
to
its
associated
</ins><a class="tref internalDFN" title="serialization_label" href="#dfn-serialization_label-1"><ins class="diff-chg">
serialization
label
</ins></a>.<ins class="diff-chg">
It
is
initialized
to
an
empty
map.
</ins></dd><dt><dfn title="adjacent_info_map" id="dfn-adjacent_info_map"><ins class="diff-chg">
adjacent
info
map
</ins></dfn></dt><dd><ins class="diff-chg">
Maps
a
</ins><a class="tref internalDFN" title="serialization_label" href="#dfn-serialization_label-1"><ins class="diff-chg">
serialization
label
</ins></a><ins class="diff-chg">
to
the
node
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-chg">
label
</ins></a><ins class="diff-chg">
associated
with
it,
the
list
of
sorted
</ins><a class="tref internalDFN" title="serialization_label" href="#dfn-serialization_label-1"><ins class="diff-chg">
serialization
label
</ins></a><ins class="diff-chg">
s
for
adjacent
nodes,
and
the
map
of
adjacent
node
</ins><a class="tref" title="serialiation_label"><ins class="diff-chg">
serialiation
label
</ins></a><ins class="diff-chg">
s
to
their
associated
node
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-chg">
label
</ins></a><ins class="diff-chg">
s.
It
is
initialized
to
an
empty
map.
</ins></dd><dt><dfn title="key_stack" id="dfn-key_stack"><ins class="diff-chg">
key
stack
</ins></dfn></dt><dd><ins class="diff-chg">
A
stack
where
each
element
contains
an
array
of
adjacent
</ins><a class="tref internalDFN" title="serialization_label" href="#dfn-serialization_label-1"><ins class="diff-chg">
serialization
label
</ins></a><ins class="diff-chg">
s
and
an
index
into
that
array.
It
is
initialized
to
a
stack
containing
a
single
element
where
its
array
contains
a
single
string
element
</ins><code><ins class="diff-chg">
s1
</ins></code><ins class="diff-chg">
and
its
index
is
set
to
</ins><code><ins class="diff-chg">
0
</ins></code>.</dd><dt><dfn title="serialized_keys" id="dfn-serialized_keys"><ins class="diff-chg">
serialized
keys
</ins></dfn></dt><dd><ins class="diff-chg">
Keeps
track
of
which
</ins><a class="tref internalDFN" title="serialization_label" href="#dfn-serialization_label-1"><ins class="diff-chg">
serialization
label
</ins></a><ins class="diff-chg">
s
have
already
been
written
at
least
once
to
the
</ins><a class="tref internalDFN" title="serialization_string" href="#dfn-serialization_string"><ins class="diff-chg">
serialization
string
</ins></a>.<ins class="diff-chg">
It
is
initialized
to
an
empty
map.
</ins></dd><dt><dfn title="serialization_string" id="dfn-serialization_string"><ins class="diff-chg">
serialization
string
</ins></dfn></dt><dd><ins class="diff-chg">
A
string
that
is
incrementally
updated
as
a
serialization
is
built.
It
is
initialized
to
an
empty
string.
</ins></dd></dl></dd></dl><p><ins class="diff-chg">
The
deep
comparison
algorithm
is
as
follows:
</ins></p><ol class="algorithm"><li><ins class="diff-chg">
Perform
a
comparison
between
</ins><a class="tref internalDFN" title="alpha" href="#dfn-alpha"><ins class="diff-chg">
alpha
</ins></a><ins class="diff-chg">
and
</ins><a class="tref internalDFN" title="beta" href="#dfn-beta"><ins class="diff-chg">
beta
</ins></a><ins class="diff-chg">
according
to
the
</ins><a href="#shallow-comparison-algorithm"><ins class="diff-chg">
Shallow
Comparison
Algorithm
</ins></a>.<ins class="diff-chg">
If
the
result
does
not
show
that
the
two
nodes
are
equivalent,
return
the
result.
</ins>
</li>
<li>
Compare
<del class="diff-old">property
serializations
</del>
<ins class="diff-chg">incoming
</ins>
and
<del class="diff-old">then
reference
serializations,
recycling
the
mapping
from
property
serializations
</del>
<ins class="diff-chg">outgoing
edges
</ins>
for
<del class="diff-old">reference
serializations.
</del>
<ins class="diff-chg">each
node,
updating
their
associated
</ins><a class="tref internalDFN" title="node_state" href="#dfn-node_state"><ins class="diff-chg">
node
state
</ins></a><ins class="diff-chg">
as
each
node
is
processed:
</ins>
<ol class="algorithm">
<li>
If
the
<a class="tref internalDFN" title="outgoing_serialization_map" href="#dfn-outgoing_serialization_map">
<ins class="diff-new">outgoing
</ins>
serialization
<ins class="diff-new">map
</ins></a>
for
<del class="diff-old">bnodeA
</del>
<a class="tref internalDFN" title="alpha" href="#dfn-alpha">
<ins class="diff-chg">alpha
</ins></a>
is
<del class="diff-old">null,
do
SerializeNode(bnodeA,
</del>
<ins class="diff-chg">empty,
generate
the
serialization
according
to
the
</ins><a href="#node-serialization-algorithm"><ins class="diff-chg">
Node
Serialization
Algorithm
</ins></a>.<ins class="diff-chg">
Provide
</ins><a class="tref internalDFN" title="alpha" href="#dfn-alpha"><ins class="diff-chg">
alpha
</ins></a><ins class="diff-chg">
's
</ins><a class="tref internalDFN" title="node_state" href="#dfn-node_state"><ins class="diff-chg">
node
state
</ins></a>,<ins class="diff-chg">
a
</ins>
new
<del class="diff-old">Mapping).
</del>
<a class="tref internalDFN" title="mapping_state" href="#dfn-mapping_state">
<ins class="diff-chg">mapping
state
</ins></a>,<code><ins class="diff-chg">
outgoing
direction
</ins></code><ins class="diff-chg">
to
the
algorithm
as
inputs.
</ins>
</li>
<li>
If
the
<a class="tref internalDFN" title="outgoing_serialization_map" href="#dfn-outgoing_serialization_map">
<ins class="diff-new">outgoing
</ins>
serialization
<ins class="diff-new">map
</ins></a>
for
<del class="diff-old">bnodeB
</del>
<a class="tref internalDFN" title="beta" href="#dfn-beta">
<ins class="diff-chg">beta
</ins></a>
is
<del class="diff-old">null,
do
SerializeNode(bnodeA,
</del>
<ins class="diff-chg">empty,
generate
the
serialization
according
to
the
</ins><a href="#node-serialization-algorithm"><ins class="diff-chg">
Node
Serialization
Algorithm
</ins></a>.<ins class="diff-chg">
Provide
</ins><a class="tref internalDFN" title="beta" href="#dfn-beta"><ins class="diff-chg">
beta
</ins></a><ins class="diff-chg">
's
</ins><a class="tref internalDFN" title="node_state" href="#dfn-node_state"><ins class="diff-chg">
node
state
</ins></a>,<ins class="diff-chg">
a
</ins>
new
<del class="diff-old">Mapping).
</del>
<a class="tref internalDFN" title="mapping_state" href="#dfn-mapping_state">
<ins class="diff-chg">mapping
state
</ins></a>,<ins class="diff-chg">
and
</ins><code><ins class="diff-chg">
outgoing
direction
</ins></code><ins class="diff-chg">
to
the
algorithm
as
inputs.
</ins>
</li>
<li>
<del class="diff-old">Return
</del>
<ins class="diff-chg">If
</ins><a class="tref internalDFN" title="alpha" href="#dfn-alpha"><ins class="diff-chg">
alpha
</ins></a><ins class="diff-chg">
's
</ins><a class="tref internalDFN" title="outgoing_serialization" href="#dfn-outgoing_serialization"><ins class="diff-chg">
outgoing
serialization
</ins></a><ins class="diff-chg">
is
lexicographically
less
than
</ins><a class="tref internalDFN" title="beta" href="#dfn-beta"><ins class="diff-chg">
beta
</ins></a><ins class="diff-chg">
's,
then
</ins><a class="tref internalDFN" title="alpha" href="#dfn-alpha"><ins class="diff-chg">
alpha
</ins></a><ins class="diff-chg">
is
first.
If
it
is
greater,
then
</ins><a class="tref internalDFN" title="beta" href="#dfn-beta"><ins class="diff-chg">
beta
</ins></a><ins class="diff-chg">
is
first.
</ins></li><li><ins class="diff-chg">
If
</ins>
the
<del class="diff-old">result
</del>
<a class="tref internalDFN" title="incoming_serialization_map" href="#dfn-incoming_serialization_map">
<ins class="diff-chg">incoming
serialization
map
</ins></a><ins class="diff-chg">
for
</ins><a class="tref internalDFN" title="alpha" href="#dfn-alpha"><ins class="diff-chg">
alpha
</ins></a><ins class="diff-chg">
is
empty,
generate
the
serialization
according
to
the
</ins><a href="#node-serialization-algorithm"><ins class="diff-chg">
Node
Serialization
Algorithm
</ins></a>.<ins class="diff-chg">
Provide
</ins><a class="tref internalDFN" title="alpha" href="#dfn-alpha"><ins class="diff-chg">
alpha
</ins></a><ins class="diff-chg">
's
</ins><a class="tref internalDFN" title="node_state" href="#dfn-node_state"><ins class="diff-chg">
node
state
</ins></a>,<ins class="diff-chg">
a
new
</ins><a class="tref internalDFN" title="mapping_state" href="#dfn-mapping_state"><ins class="diff-chg">
mapping
state
</ins></a><ins class="diff-chg">
with
its
</ins><a class="tref internalDFN" title="serialized_labels_map" href="#dfn-serialized_labels_map"><ins class="diff-chg">
serialized
labels
map
</ins></a><ins class="diff-chg">
set
to
a
copy
</ins>
of
<a class="tref internalDFN" title="alpha" href="#dfn-alpha">
<ins class="diff-new">alpha
</ins></a><ins class="diff-new">
's
</ins><a class="tref internalDFN" title="outgoing_serialization_map" href="#dfn-outgoing_serialization_map"><ins class="diff-new">
outgoing
serialization
map
</ins></a>,<ins class="diff-new">
and
</ins><code><ins class="diff-new">
incoming
direction
</ins></code><ins class="diff-new">
to
the
algorithm
as
inputs.
</ins></li><li><ins class="diff-new">
If
the
</ins><a class="tref internalDFN" title="incoming_serialization_map" href="#dfn-incoming_serialization_map"><ins class="diff-new">
incoming
serialization
map
</ins></a><ins class="diff-new">
for
</ins><a class="tref internalDFN" title="beta" href="#dfn-beta"><ins class="diff-new">
beta
</ins></a><ins class="diff-new">
is
empty,
generate
the
serialization
according
to
the
</ins><a href="#node-serialization-algorithm"><ins class="diff-new">
Node
Serialization
Algorithm
</ins></a>.<ins class="diff-new">
Provide
</ins><a class="tref internalDFN" title="beta" href="#dfn-beta"><ins class="diff-new">
beta
</ins></a><ins class="diff-new">
's
</ins><a class="tref internalDFN" title="node_state" href="#dfn-node_state"><ins class="diff-new">
node
state
</ins></a>,
a
<del class="diff-old">lexicographical
comparison
</del>
<ins class="diff-chg">new
</ins><a class="tref internalDFN" title="mapping_state" href="#dfn-mapping_state"><ins class="diff-chg">
mapping
state
</ins></a><ins class="diff-chg">
with
its
</ins><a class="tref internalDFN" title="serialized_labels_map" href="#dfn-serialized_labels_map"><ins class="diff-chg">
serialized
labels
map
</ins></a><ins class="diff-chg">
set
to
a
copy
</ins>
of
<a class="tref internalDFN" title="beta" href="#dfn-beta">
<ins class="diff-new">beta
</ins></a><ins class="diff-new">
's
</ins><a class="tref internalDFN" title="outgoing_serialization_map" href="#dfn-outgoing_serialization_map"><ins class="diff-new">
outgoing
serialization
map
</ins></a>,<ins class="diff-new">
and
</ins><code><ins class="diff-new">
incoming
direction
</ins></code><ins class="diff-new">
to
</ins>
the
<del class="diff-old">two
serializations.
</del>
<ins class="diff-chg">algorithm
as
inputs.
</ins>
</li>
<li>
<ins class="diff-chg">If
</ins><a class="tref internalDFN" title="alpha" href="#dfn-alpha"><ins class="diff-chg">
alpha
</ins></a><ins class="diff-chg">
's
</ins><a class="tref internalDFN" title="incoming_serialization" href="#dfn-incoming_serialization"><ins class="diff-chg">
incoming
serialization
</ins></a><ins class="diff-chg">
is
lexicographically
less
than
</ins><a class="tref internalDFN" title="beta" href="#dfn-beta"><ins class="diff-chg">
beta
</ins></a><ins class="diff-chg">
's,
then
</ins><a class="tref internalDFN" title="alpha" href="#dfn-alpha"><ins class="diff-chg">
alpha
</ins></a><ins class="diff-chg">
is
first.
If
it
is
greater,
then
</ins><a class="tref internalDFN" title="beta" href="#dfn-beta"><ins class="diff-chg">
beta
</ins></a><ins class="diff-chg">
is
first.
</ins>
</li>
</ol>
</li>
</ol>
</div>
<div id="node-serialization-algorithm" class="section">
<h4>
<span class="secno">
<del class="diff-old">5.11.7
</del>
<ins class="diff-chg">6.11.9
</ins>
</span>
Node
Serialization
Algorithm
</h4>
<p>
<del class="diff-old">SerializeNode(bnode,
mapping,
dir):
</del>
<ins class="diff-chg">The
node
serialization
algorithm
takes
a
</ins><a class="tref internalDFN" title="node_state" href="#dfn-node_state"><ins class="diff-chg">
node
state
</ins></a>,<ins class="diff-chg">
a
</ins><a class="tref internalDFN" title="mapping_state" href="#dfn-mapping_state"><ins class="diff-chg">
mapping
state
</ins></a>,<ins class="diff-chg">
and
a
</ins><dfn title="direction" id="dfn-direction"><ins class="diff-chg">
direction
</ins></dfn><ins class="diff-chg">
(either
</ins><code><ins class="diff-chg">
outgoing
direction
</ins></code><ins class="diff-chg">
or
</ins><code><ins class="diff-chg">
incoming
direction
</ins></code><ins class="diff-chg">
)
as
inputs
and
generates
a
deterministic
serialization
for
the
</ins><a class="tref internalDFN" title="node_reference" href="#dfn-node_reference"><ins class="diff-chg">
node
reference
</ins></a>.
</p>
<ol class="algorithm">
<li>
If
the
<del class="diff-old">bnode's
</del>
<a class="tref internalDFN" title="label" href="#dfn-label">
label
<del class="diff-old">is
already
marked
</del>
</a>
<ins class="diff-chg">exists
in
the
</ins><a class="tref internalDFN" title="processed_labels_map" href="#dfn-processed_labels_map"><ins class="diff-chg">
processed
labels
map
</ins></a>,<ins class="diff-chg">
terminate
the
algorithm
</ins>
as
<del class="diff-old">mapped,
return.
</del>
<ins class="diff-chg">the
</ins><a class="tref internalDFN" title="serialization_label" href="#dfn-serialization_label-1"><ins class="diff-chg">
serialization
label
</ins></a><ins class="diff-chg">
has
already
been
created.
</ins>
</li>
<li>
<del class="diff-old">Mark
</del>
<ins class="diff-chg">Set
</ins>
the
<del class="diff-old">bnode's
</del>
<ins class="diff-chg">value
associated
with
the
</ins><a class="tref internalDFN" title="label" href="#dfn-label">
label
<del class="diff-old">as
mapped.
</del>
</a>
<ins class="diff-chg">in
the
</ins><a class="tref internalDFN" title="processed_labels_map" href="#dfn-processed_labels_map"><ins class="diff-chg">
processed
labels
map
</ins></a><ins class="diff-chg">
to
</ins><code><ins class="diff-chg">
true
</ins></code>.
</li>
<li>
<del class="diff-old">Assign
</del>
<ins class="diff-chg">Generate
</ins>
the
next
<dfn title="serialization_label" id="dfn-serialization_label-1">
serialization
<del class="diff-old">name
</del>
<ins class="diff-chg">label
</ins></dfn><ins class="diff-chg">
for
the
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-chg">
label
</ins></a><ins class="diff-chg">
according
</ins>
to
the
<del class="diff-old">bnode's
</del>
<a href="#serialization-label-generation-algorithm">
<ins class="diff-chg">Serialization
Label
Generation
Algorithm
</ins></a>.</li><li><ins class="diff-chg">
Create
an
empty
array
called
the
</ins><a class="tref" title="list_of_unserialized_labels"><ins class="diff-chg">
list
of
unserialized
labels
</ins></a>.</li><li><ins class="diff-chg">
For
every
</ins><a class="tref internalDFN" title="label" href="#dfn-label">
label
</a>
<ins class="diff-new">in
a
list,
where
the
list
the
</ins><a class="tref internalDFN" title="outgoing_list" href="#dfn-outgoing_list"><ins class="diff-new">
outgoing
list
</ins></a><ins class="diff-new">
if
the
</ins><a class="tref internalDFN" title="direction" href="#dfn-direction"><ins class="diff-new">
direction
</ins></a><ins class="diff-new">
is
</ins><code><ins class="diff-new">
outgoing
direction
</ins></code>
and
<del class="diff-old">store
</del>
<ins class="diff-chg">the
</ins><a class="tref internalDFN" title="incoming_list" href="#dfn-incoming_list"><ins class="diff-chg">
incoming
list
</ins></a><ins class="diff-chg">
otherwise,
if
the
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-chg">
label
</ins></a><ins class="diff-chg">
starts
with
</ins><code><ins class="diff-chg">
_:
</ins></code>,
it
<del class="diff-old">in
"top".
</del>
<ins class="diff-chg">is
the
</ins><dfn title="target_node_label" id="dfn-target_node_label"><ins class="diff-chg">
target
node
label
</ins></dfn>:<ol class="algorithm">
<li>
<del class="diff-old">Split
</del>
<ins class="diff-chg">Look
up
</ins>
the
<del class="diff-old">bnode's
adjacent
bnodes
into
a
</del>
<a class="tref internalDFN" title="target_node_label" href="#dfn-target_node_label">
<ins class="diff-chg">target
node
label
</ins></a><ins class="diff-chg">
in
the
</ins><a class="tref internalDFN" title="processed_labels_map" href="#dfn-processed_labels_map"><ins class="diff-chg">
processed
labels
</ins>
map
</a>
and
<ins class="diff-new">if
</ins>
a
<del class="diff-old">list.
The
map
contains
a
reverse
</del>
mapping
<del class="diff-old">of
serialization
names
to
bnode
labels
for
all
</del>
<ins class="diff-chg">exists,
update
the
</ins><a class="tref internalDFN" title="serialized_labels_map" href="#dfn-serialized_labels_map"><ins class="diff-chg">
serialized
</ins>
labels
<ins class="diff-new">map
</ins></a><ins class="diff-new">
where
the
key
is
the
value
</ins>
in
the
<del class="diff-old">mapping,
</del>
<a class="tref" title="serialization_map">
<ins class="diff-chg">serialization
map
</ins></a><ins class="diff-chg">
and
the
value
is
the
</ins><a class="tref internalDFN" title="target_node_label" href="#dfn-target_node_label"><ins class="diff-chg">
target
node
label
</ins></a>.</li><li><ins class="diff-chg">
Otherwise,
add
the
</ins><a class="tref internalDFN" title="target_node_label" href="#dfn-target_node_label"><ins class="diff-chg">
target
node
label
</ins></a><ins class="diff-chg">
to
</ins>
the
<a class="tref" title="list_of_unserialized_labels">
list
<del class="diff-old">(notMapped)
contains
all
</del>
<ins class="diff-chg">of
unserialized
</ins>
labels
<del class="diff-old">not
in
the
mapping
yet.
</del>
</a>.
</li>
</ol>
</li>
<li>
<del class="diff-old">Save
a
copy
</del>
<ins class="diff-chg">Set
the
</ins><dfn title="maximum_serialization_combinations" id="dfn-maximum_serialization_combinations"><ins class="diff-chg">
maximum
serialization
combinations
</ins></dfn><ins class="diff-chg">
to
</ins><code><ins class="diff-chg">
1
</ins></code><ins class="diff-chg">
or
the
length
</ins>
of
the
<del class="diff-old">mapping.
</del>
<a class="tref" title="list_of_unserialized_labels">
<ins class="diff-chg">list
of
unserialized
labels
</ins></a>,<ins class="diff-chg">
whichever
is
greater.
</ins>
</li>
<li>
<del class="diff-old">Do
SerializeCombos
for
max(1,
notMapped.length)
using
</del>
<ins class="diff-chg">While
</ins>
the
<del class="diff-old">original
mapping
for
</del>
<a class="tref internalDFN" title="maximum_serialization_combinations" href="#dfn-maximum_serialization_combinations">
<ins class="diff-chg">maximum
serialization
combinations
</ins></a><ins class="diff-chg">
is
greater
than
</ins><code><ins class="diff-chg">
0
</ins></code>,<ins class="diff-chg">
perform
</ins>
the
<del class="diff-old">first
call
</del>
<a href="#combinatorial-serialization-algorithm">
<ins class="diff-chg">Combinatorial
Serialization
Algorithm
</ins></a><ins class="diff-chg">
and
decrement
the
</ins><a class="tref internalDFN" title="maximum_serialization_combinations" href="#dfn-maximum_serialization_combinations"><ins class="diff-chg">
maximum
serialization
combinations
</ins></a><ins class="diff-chg">
by
</ins><code><ins class="diff-chg">
1
</ins></code><ins class="diff-chg">
for
each
iteration.
</ins></li></ol></div><div id="serialization-label-generation-algorithm" class="section"><h4><span class="secno"><ins class="diff-chg">
6.11.10
</ins></span><ins class="diff-chg">
Serialization
Label
Generation
Algorithm
</ins></h4><p><ins class="diff-chg">
The
algorithm
generates
a
</ins><a class="tref internalDFN" title="serialization_label" href="#dfn-serialization_label-1"><ins class="diff-chg">
serialization
label
</ins></a><ins class="diff-chg">
given
a
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-chg">
label
</ins></a>
and
a
<del class="diff-old">copy
</del>
<a class="tref" title="mapping_count">
<ins class="diff-chg">mapping
count
</ins></a>.</p><li><ol class="algorithm"><li><ins class="diff-chg">
If
the
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-chg">
label
</ins></a><ins class="diff-chg">
starts
with
the
string
</ins><code><ins class="diff-chg">
_:c14n
</ins></code>,<ins class="diff-chg">
the
</ins><a class="tref internalDFN" title="serialization_label" href="#dfn-serialization_label-1"><ins class="diff-chg">
serialization
label
</ins></a><ins class="diff-chg">
is
the
letter
</ins><code><ins class="diff-chg">
c
</ins></code><ins class="diff-chg">
followed
by
the
number
that
follows
</ins><code><ins class="diff-chg">
_:c14n
</ins></code><ins class="diff-chg">
in
the
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-chg">
label
</ins></a>.</li><li><ins class="diff-chg">
Otherwise,
the
</ins><a class="tref internalDFN" title="serialization_label" href="#dfn-serialization_label-1"><ins class="diff-chg">
serialization
label
</ins></a><ins class="diff-chg">
is
the
letter
</ins><code><ins class="diff-chg">
s
</ins></code><ins class="diff-chg">
followed
by
the
string
value
</ins>
of
<a class="tref" title="mapping_count">
<ins class="diff-new">mapping
count
</ins></a>.<ins class="diff-new">
Increment
</ins>
the
<a class="tref" title="mapping_count">
mapping
<del class="diff-old">for
each
subsequent
call.
</del>
<ins class="diff-chg">count
</ins></a><ins class="diff-chg">
by
</ins><code><ins class="diff-chg">
1
</ins></code><ins class="diff-chg">
ensuring
that
the
value
persists
across
multiple
invocations
of
this
algorithm.
</ins>
</li>
</ol>
</li>
</div>
<div id="combinatorial-serialization-algorithm" class="section">
<h4>
<span class="secno">
<del class="diff-old">5.11.8
</del>
<ins class="diff-chg">6.11.11
</ins>
</span>
Combinatorial
Serialization
Algorithm
</h4>
<p>
<del class="diff-old">SerializeCombos(top,
mapping,
mapped,
notMapped,
dir):
</del>
<ins class="diff-chg">SerializeCombos()
takes
a
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-chg">
label
</ins></a>,<ins class="diff-chg">
a
</ins><a class="tref" title="serialization_map"><ins class="diff-chg">
serialization
map
</ins></a>,<ins class="diff-chg">
a
</ins><a class="tref internalDFN" title="serialization_label" href="#dfn-serialization_label-1"><ins class="diff-chg">
serialization
label
</ins></a>,<ins class="diff-chg">
a
</ins><a class="tref internalDFN" title="processed_labels_map" href="#dfn-processed_labels_map"><ins class="diff-chg">
processed
labels
map
</ins></a>,<ins class="diff-chg">
a
</ins><a class="tref" title="serialization_map"><ins class="diff-chg">
serialization
map
</ins></a>,<ins class="diff-chg">
a
</ins><a class="tref internalDFN" title="serialized_labels_map" href="#dfn-serialized_labels_map"><ins class="diff-chg">
serialized
labels
map
</ins></a>,<ins class="diff-chg">
and
a
</ins><a class="tref" title="list_of_unserialized_labels"><ins class="diff-chg">
list
of
unserialized
labels
</ins></a><ins class="diff-chg">
as
inputs
and
generates
deterministic
serializations
for
all
possible
combinations
of
graphs.
</ins>
</p>
<ol class="algorithm">
<li>
If
<del class="diff-old">notMapped
</del>
<ins class="diff-chg">the
</ins><a class="tref" title="list_of_unserialized_labels"><ins class="diff-chg">
list
of
unserialized
labels
</ins></a>
is
<del class="diff-old">non-empty,
copy
mapped
and
assign
</del>
<ins class="diff-chg">not
empty:
</ins><ol class="algorithm"><li><ins class="diff-chg">
Copy
</ins>
the
<del class="diff-old">next
</del>
<a class="tref" title="serialization_map">
serialization
<del class="diff-old">name
</del>
<ins class="diff-chg">map
</ins></a>
to
<del class="diff-old">its
</del>
<ins class="diff-chg">the
</ins><dfn title="serialization_map_copy" id="dfn-serialization_map_copy"><ins class="diff-chg">
serialization
map
copy
</ins></dfn>.</li><li><ins class="diff-chg">
Remove
the
</ins>
first
<del class="diff-old">bnode,
remove
it
</del>
<a class="tref" title="unserialized_label">
<ins class="diff-chg">unserialized
label
</ins></a>
from
the
<del class="diff-old">list,
</del>
<a class="tref" title="list_of_unserialized_labels">
<ins class="diff-chg">list
of
unserialized
labels
</ins></a>
and
<del class="diff-old">update
mapped.
For
max(1,
notMapped.length)
recurse
into
SerializeCombos
with
</del>
<ins class="diff-chg">create
a
new
</ins><dfn title="new_serialization_label" id="dfn-new_serialization_label"><ins class="diff-chg">
new
serialization
label
</ins></dfn><ins class="diff-chg">
according
to
</ins>
the
<del class="diff-old">original
</del>
<a href="#serialization-label-generation-algorithm">
<ins class="diff-chg">Serialization
Label
Generation
Algorithm
</ins></a><ins class="diff-chg">
passing
the
</ins><a class="tref" title="unserialized_label"><ins class="diff-chg">
unserialized
label
</ins></a><ins class="diff-chg">
and
the
</ins><a class="tref internalDFN" title="mapping_counter" href="#dfn-mapping_counter">
mapping
<del class="diff-old">for
</del>
<ins class="diff-chg">counter
</ins></a><ins class="diff-chg">
as
parameters.
</ins></li><li><ins class="diff-chg">
Create
a
new
key-value
mapping
in
the
</ins><a class="tref internalDFN" title="serialization_map_copy" href="#dfn-serialization_map_copy"><ins class="diff-chg">
serialization
map
copy
</ins></a><ins class="diff-chg">
where
the
key
is
the
</ins><a class="tref internalDFN" title="new_serialization_label" href="#dfn-new_serialization_label"><ins class="diff-chg">
new
serialization
label
</ins></a><ins class="diff-chg">
and
the
value
is
the
</ins><a class="tref" title="unserialized_label"><ins class="diff-chg">
unserialized
label
</ins></a>.</li><li><ins class="diff-chg">
Set
the
</ins><dfn title="maximum_serialization_rotations" id="dfn-maximum_serialization_rotations"><ins class="diff-chg">
maximum
serialization
rotations
</ins></dfn><ins class="diff-chg">
to
</ins><code><ins class="diff-chg">
1
</ins></code><ins class="diff-chg">
or
the
length
of
the
</ins><a class="tref" title="list_of_unserialized_labels"><ins class="diff-chg">
list
of
unserialized
labels
</ins></a>,<ins class="diff-chg">
whichever
is
greater.
</ins></li><li><ins class="diff-chg">
While
the
</ins><a class="tref internalDFN" title="maximum_serialization_rotations" href="#dfn-maximum_serialization_rotations"><ins class="diff-chg">
maximum
serialization
rotations
</ins></a><ins class="diff-chg">
is
greater
than
</ins><code><ins class="diff-chg">
0
</ins></code>:<ol class="algorithm"><li><ins class="diff-chg">
If
this
is
</ins>
the
first
<del class="diff-old">call
</del>
<ins class="diff-chg">iteration
in
the
loop,
perform
the
</ins><a href="#combinatorial-serialization-algorithm"><ins class="diff-chg">
Combinatorial
Serialization
Algorithm
</ins></a><ins class="diff-chg">
passing
in
the
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-chg">
label
</ins></a>,<ins class="diff-chg">
the
</ins><a class="tref internalDFN" title="serialization_map_copy" href="#dfn-serialization_map_copy"><ins class="diff-chg">
serialization
map
copy
</ins></a>,<ins class="diff-chg">
the
</ins><a class="tref internalDFN" title="serialization_label" href="#dfn-serialization_label-1"><ins class="diff-chg">
serialization
label
</ins></a>,<ins class="diff-chg">
the
</ins><a class="tref internalDFN" title="processed_labels_map" href="#dfn-processed_labels_map"><ins class="diff-chg">
processed
labels
map
</ins></a>,<a class="tref internalDFN" title="serialized_labels_map" href="#dfn-serialized_labels_map"><ins class="diff-chg">
serialized
labels
map
</ins></a>,
and
<del class="diff-old">a
</del>
<ins class="diff-chg">the
</ins><a class="tref" title="list_of_unserialized_labels"><ins class="diff-chg">
list
of
unserialized
labels
</ins></a>.</li><li><ins class="diff-chg">
If
this
is
not
the
first
iteration
in
the
loop,
perform
the
</ins><a href="#combinatorial-serialization-algorithm"><ins class="diff-chg">
Combinatorial
Serialization
Algorithm
</ins></a><ins class="diff-chg">
passing
in
the
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-chg">
label
</ins></a>,<ins class="diff-chg">
the
</ins><a class="tref internalDFN" title="serialization_map_copy" href="#dfn-serialization_map_copy"><ins class="diff-chg">
serialization
map
</ins>
copy
</a>,
<ins class="diff-new">the
</ins><a class="tref internalDFN" title="serialization_label" href="#dfn-serialization_label-1"><ins class="diff-new">
serialization
label
</ins></a>,<ins class="diff-new">
and
temporary
copies
</ins>
of
the
<del class="diff-old">mapping
</del>
<a class="tref internalDFN" title="processed_labels_map" href="#dfn-processed_labels_map">
<ins class="diff-chg">processed
labels
map
</ins></a>,<a class="tref internalDFN" title="serialized_labels_map" href="#dfn-serialized_labels_map"><ins class="diff-chg">
serialized
labels
map
</ins></a>,<ins class="diff-chg">
and
the
</ins><a class="tref" title="list_of_unserialized_labels"><ins class="diff-chg">
list
of
unserialized
labels
</ins></a>.</li><li><ins class="diff-chg">
Decrement
the
</ins><a class="tref internalDFN" title="maximum_serialization_rotations" href="#dfn-maximum_serialization_rotations"><ins class="diff-chg">
maximum
serialization
rotations
</ins></a><ins class="diff-chg">
by
</ins><code><ins class="diff-chg">
1
</ins></code>
for
each
<del class="diff-old">subsequent
call.
Rotate
notMapped
on
each
</del>
iteration.
</li>
</ol>
</li>
<li>
If
<del class="diff-old">notMapped
</del>
<ins class="diff-chg">the
</ins><a class="tref" title="list_of_unserialized_labels"><ins class="diff-chg">
list
of
unserialized
labels
</ins></a>
is
<del class="diff-old">empty,
save
</del>
<ins class="diff-chg">empty:
</ins><ol class="algorithm"><li><ins class="diff-chg">
???Save
</ins>
an
entry
mapping
from
the
bnode's
serialization
name
to
the
reverse
mapping
(mapped)
and
its
sorted
keys
then
do
<del class="diff-old">SerializeMapping.
</del>
<ins class="diff-chg">SerializeMapping:
</ins>
<ol class="algorithm">
<li>
<del class="diff-old">If
</del>
<ins class="diff-chg">???If
</ins>
the
serialization
is
lexicographically
less
than
the
current
serialization
or
the
current
serialization
is
null,
then
iterate
over
the
sorted
keys,
get
the
reverse-mapped
adjacent
bnode
and
recursively
call
SerializeNode
on
each
iteration.
</li>
<li>
<del class="diff-old">Do
</del>
<ins class="diff-chg">???Do
</ins>
SerializeMapping
then
if
the
serialization
is
lexicographically
less
than
the
current
serialization
or
the
current
serialization
is
null,
then
set
it
as
the
least
serialization
for
the
bnode
in
the
given
edge
direction
('property'
or
'reference').
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</div>
<div id="mapping-serialization-algorithm" class="section">
<h4>
<span class="secno">
<del class="diff-old">5.11.9
</del>
<ins class="diff-chg">6.11.12
</ins>
</span>
Mapping
Serialization
Algorithm
</h4>
<p>
<a class="tref" title="map_of_all_labels">
<ins class="diff-new">map
of
all
labels
</ins></a>,<a class="tref" title="map_of_all_properties"><ins class="diff-new">
map
of
all
properties
</ins></a>,<dfn title="key_stack" id="dfn-key_stack-1"><ins class="diff-new">
key
stack
</ins></dfn>,<dfn title="serialization_string_" id="dfn-serialization_string_"><ins class="diff-new">
serialization
string
</ins></dfn></p><p>
SerializeMapping(mapping):
(This
function
incrementally
updates
the
relation
serialization
for
a
mapping)
</p>
<ol class="algorithm">
<li>
If
<del class="diff-old">there
</del>
<ins class="diff-chg">the
</ins><a class="tref" title="serialization_keys_stack"><ins class="diff-chg">
serialization
keys
stack
</ins></a>
is
<del class="diff-old">an
entry
on
</del>
<ins class="diff-chg">not
empty
</ins><ol class="algorithm"><li><ins class="diff-chg">
Pop
</ins>
the
<del class="diff-old">mapping's
key
stack,
pop
it
and
iterate
over
every
key.
</del>
<dfn title="list_of_serialization_keys" id="dfn-list_of_serialization_keys">
<ins class="diff-chg">list
of
serialization
keys
</ins></dfn><ins class="diff-chg">
off
of
the
</ins><a class="tref" title="serialization_keys_stack"><ins class="diff-chg">
serialization
keys
stack
</ins></a>.
</li>
<li>
For
each
<del class="diff-old">key,
if
an
entry
for
the
</del>
<dfn title="serialization_key" id="dfn-serialization_key">
<ins class="diff-chg">serialization
</ins>
key
<del class="diff-old">hasn't
been
added
to
</del>
</dfn>
<ins class="diff-chg">in
</ins>
the
<del class="diff-old">mapping
yet,
break
out
</del>
<a class="tref internalDFN" title="list_of_serialization_keys" href="#dfn-list_of_serialization_keys">
<ins class="diff-chg">list
</ins>
of
<del class="diff-old">the
loop.
</del>
<ins class="diff-chg">serialization
keys
</ins></a>:<ol class="algorithm">
<li>
<del class="diff-old">Update
</del>
<ins class="diff-chg">If
</ins>
the
<a class="tref internalDFN" title="serialization_key" href="#dfn-serialization_key">
<ins class="diff-new">serialization
</ins>
key
</a>
<ins class="diff-new">is
not
in
the
???list
of
adjacent
nodes???,
push
the
</ins><a class="tref internalDFN" title="list_of_serialization_keys" href="#dfn-list_of_serialization_keys"><ins class="diff-new">
list
of
serialization
keys
</ins></a><ins class="diff-new">
onto
the
</ins><a class="tref" title="serialization_keys_stack"><ins class="diff-new">
serialization
keys
</ins>
stack
<del class="diff-old">entry's
index.
</del>
</a>
<ins class="diff-chg">and
exit
from
this
loop.
</ins>
</li>
<li>
If
the
<a class="tref internalDFN" title="serialization_key" href="#dfn-serialization_key">
<ins class="diff-new">serialization
</ins>
key
</a>
<ins class="diff-new">is
a
key
in
the
</ins><a class="tref" title="completed_serialization_key_map"><ins class="diff-new">
completed
serialization
key
map
</ins></a>,<ins class="diff-new">
a
cycle
</ins>
has
<del class="diff-old">already
</del>
been
<del class="diff-old">serialized,
output
"'_'
+
key"
</del>
<ins class="diff-chg">detected.
Append
the
concatenation
of
the
</ins><code><ins class="diff-chg">
_
</ins></code><ins class="diff-chg">
character
</ins>
and
<del class="diff-old">continue.
</del>
<ins class="diff-chg">the
</ins><a class="tref internalDFN" title="serialization_key" href="#dfn-serialization_key"><ins class="diff-chg">
serialization
key
</ins></a><ins class="diff-chg">
to
the
</ins><a class="tref internalDFN" title="serialization_string" href="#dfn-serialization_string"><ins class="diff-chg">
serialization
string
</ins></a>.
</li>
<li>
<del class="diff-old">For
each
key,
</del>
<ins class="diff-chg">Otherwise,
</ins>
serialize
<ins class="diff-new">all
outgoing
and
incoming
edges
in
the
graph
by
performing
</ins>
the
<ins class="diff-new">following
steps:
</ins><ol class="algorithm"><li><ins class="diff-new">
Mark
the
</ins><a class="tref internalDFN" title="serialization_key" href="#dfn-serialization_key"><ins class="diff-new">
serialization
</ins>
key
<del class="diff-old">then
its
associated
bnode
properties,
then
its
bnode
references.
The
entire
property
list
is
surrounded
</del>
</a>
<ins class="diff-chg">as
being
processed
</ins>
by
<del class="diff-old">'['
and
']'
</del>
<ins class="diff-chg">adding
a
new
key-value
pair
to
the
</ins><a class="tref" title="completed_serialization_key_map"><ins class="diff-chg">
completed
serialization
key
map
</ins></a><ins class="diff-chg">
where
the
key
is
the
</ins><a class="tref internalDFN" title="serialization_key" href="#dfn-serialization_key"><ins class="diff-chg">
serialization
key
</ins></a>
and
<del class="diff-old">so
</del>
<ins class="diff-chg">the
value
</ins>
is
<code>
<ins class="diff-new">true
</ins></code>.</li><li><ins class="diff-new">
Set
</ins>
the
<del class="diff-old">reference
list.
Individual
properties/references
are
seperated
</del>
<a class="tref" title="serialization_fragment">
<ins class="diff-chg">serialization
fragment
</ins></a><ins class="diff-chg">
to
the
value
of
the
</ins><a class="tref internalDFN" title="serialization_key" href="#dfn-serialization_key"><ins class="diff-chg">
serialization
key
</ins></a>.</li><li><ins class="diff-chg">
Set
the
</ins><a class="tref" title="list_of_adjacent_node_keys"><ins class="diff-chg">
list
of
adjacent
node
keys
</ins></a>
by
<del class="diff-old">'|'.
</del>
<ins class="diff-chg">using
the
</ins><a class="tref internalDFN" title="serialization_key" href="#dfn-serialization_key"><ins class="diff-chg">
serialization
key
</ins></a><ins class="diff-chg">
to
look
up
the
list
in
the
</ins><a class="tref" title="adjacent_node_keys_map"><ins class="diff-chg">
adjacent
node
keys
map
</ins></a>.</li><li><ins class="diff-chg">
Set
the
</ins><a class="tref" title="adjacent_node_label"><ins class="diff-chg">
adjacent
node
label
</ins></a><ins class="diff-chg">
???somehow???.
</ins></li><li>
If
a
<ins class="diff-new">mapping
for
the
</ins><a class="tref" title="adjacent_node_label"><ins class="diff-new">
adjacent
node
label
</ins></a><ins class="diff-new">
exists
in
the
</ins><a class="tref" title="map_of_all_labels"><ins class="diff-new">
map
of
all
labels
</ins></a>:<ol class="algorithm"><li><ins class="diff-new">
Append
the
result
of
the
</ins><a href=""><ins class="diff-new">
Label
Serialization
Algorithm
</ins></a><ins class="diff-new">
to
the
</ins><a class="tref" title="serialization_fragment"><ins class="diff-new">
serialization
fragment
</ins></a>.</li></ol></li></ol></li></ol></li></ol></li></ol></div><div id="label-serialization-algorithm" class="section"><h4><span class="secno"><ins class="diff-new">
6.11.13
</ins></span><ins class="diff-new">
Label
Serialization
Algorithm
</ins></h4><p><a class="tref" title="map_of_properties"><ins class="diff-new">
map
of
properties
</ins></a>,<dfn title="label_serialization" id="dfn-label_serialization"><ins class="diff-new">
label
serialization
</ins></dfn>,<a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-new">
label
</ins></a>,<a class="tref" title="incoming_map"><ins class="diff-new">
incoming
map
</ins></a>,<dfn title="adjacent_node_labels" id="dfn-adjacent_node_labels"><ins class="diff-new">
adjacent
node
labels
</ins></dfn>,<a class="tref internalDFN" title="key_stack" href="#dfn-key_stack-1"><ins class="diff-new">
key
stack
</ins></a>.</p><ol class="algorithm"><li><ins class="diff-new">
Initialize
the
</ins><a class="tref internalDFN" title="label_serialization" href="#dfn-label_serialization"><ins class="diff-new">
label
serialization
</ins></a><ins class="diff-new">
to
an
empty
string.
</ins></li><li><ins class="diff-new">
Append
the
</ins><code><ins class="diff-new">
[
</ins></code><ins class="diff-new">
character
to
the
</ins><a class="tref internalDFN" title="label_serialization" href="#dfn-label_serialization"><ins class="diff-new">
label
serialization
</ins></a>.</li><li><ins class="diff-new">
Append
all
properties
to
the
</ins><a class="tref internalDFN" title="label_serialization" href="#dfn-label_serialization"><ins class="diff-new">
label
serialization
</ins></a><ins class="diff-new">
by
processing
each
key-value
pair
in
the
</ins><a class="tref" title="map_of_properties"><ins class="diff-new">
map
of
properties
</ins></a>,<ins class="diff-new">
excluding
the
</ins><code><ins class="diff-new">
@subject
</ins></code>
property
<ins class="diff-new">???do
the
map
keys
need
to
be
sorted???:
</ins><ol class="algorithm"><li><ins class="diff-new">
Build
a
string
using
the
pattern
</ins><code><</code><strong><ins class="diff-new">
KEY
</ins></strong><code><ins class="diff-new">
>
</ins></code><ins class="diff-new">
where
</ins><strong><ins class="diff-new">
KEY
</ins></strong>
is
<ins class="diff-new">the
current
key.
Append
string
to
the
</ins><a class="tref internalDFN" title="label_serialization" href="#dfn-label_serialization"><ins class="diff-new">
label
serialization
</ins></a>.</li><li><ins class="diff-new">
The
value
may
be
a
single
object
or
</ins>
an
<del class="diff-old">array,
</del>
<ins class="diff-chg">array
of
objects.
Process
</ins>
all
of
the
<del class="diff-old">serializations
</del>
<ins class="diff-chg">objects
that
</ins>
are
<del class="diff-old">concatenated
together
</del>
<ins class="diff-chg">associated
</ins>
with
<del class="diff-old">no
joining
delimiter.
The
'@subject'
property
is
skipped.
The
property
</del>
<ins class="diff-chg">the
key,
building
an
</ins><dfn title="object_string" id="dfn-object_string"><ins class="diff-chg">
object
string
</ins></dfn><ins class="diff-chg">
for
each
item:
</ins><ol class="algorithm"><li><ins class="diff-chg">
If
the
object
contains
an
</ins><code><ins class="diff-chg">
@iri
</ins></code><ins class="diff-chg">
key
with
a
value
that
starts
with
</ins><code><ins class="diff-chg">
_:
</ins></code>,<ins class="diff-chg">
set
the
</ins><a class="tref internalDFN" title="object_string" href="#dfn-object_string"><ins class="diff-chg">
object
string
</ins></a><ins class="diff-chg">
to
the
value
</ins><code><ins class="diff-chg">
_:
</ins></code>.<ins class="diff-chg">
If
the
value
does
not
start
with
</ins><code><ins class="diff-chg">
_:
</ins></code>,<ins class="diff-chg">
build
the
</ins><a class="tref internalDFN" title="object_string" href="#dfn-object_string"><ins class="diff-chg">
object
string
</ins></a><ins class="diff-chg">
using
the
pattern
</ins><code><</code><strong>
IRI
</strong>
<code>
<ins class="diff-new">>
</ins></code><ins class="diff-new">
where
</ins><strong><ins class="diff-new">
IRI
</ins></strong>
is
<del class="diff-old">turtle-serialized.
</del>
<ins class="diff-chg">the
value
associated
with
the
</ins><code><ins class="diff-chg">
@iri
</ins></code><ins class="diff-chg">
key.
</ins></li><li>
If
<ins class="diff-new">the
object
contains
</ins>
a
<del class="diff-old">property
or
reference
</del>
<code>
<ins class="diff-chg">@literal
</ins></code><ins class="diff-chg">
key
and
a
</ins><code><ins class="diff-chg">
@datatype
</ins></code><ins class="diff-chg">
key,
build
the
</ins><a class="tref internalDFN" title="object_string" href="#dfn-object_string">
object
<ins class="diff-new">string
</ins></a><ins class="diff-new">
using
the
pattern
</ins><code><ins class="diff-new">
"
</ins></code><strong><ins class="diff-new">
LITERAL
</ins></strong><code><ins class="diff-new">
"^^
</ins><</code><strong><ins class="diff-new">
DATATYPE
</ins></strong><code><ins class="diff-new">
>
</ins></code><ins class="diff-new">
where
</ins><strong><ins class="diff-new">
LITERAL
</ins></strong>
is
<ins class="diff-new">the
value
associated
with
the
</ins><code><ins class="diff-new">
@literal
</ins></code><ins class="diff-new">
key
and
</ins><strong><ins class="diff-new">
DATATYPE
</ins></strong><ins class="diff-new">
is
the
value
associated
with
the
</ins><code><ins class="diff-new">
@datatype
</ins></code><ins class="diff-new">
key.
</ins></li><li><ins class="diff-new">
If
the
object
contains
</ins>
a
<del class="diff-old">bnode,
it
</del>
<code>
<ins class="diff-chg">@literal
</ins></code><ins class="diff-chg">
key
and
a
</ins><code><ins class="diff-chg">
@language
</ins></code><ins class="diff-chg">
key,
build
the
</ins><a class="tref internalDFN" title="object_string" href="#dfn-object_string"><ins class="diff-chg">
object
string
</ins></a><ins class="diff-chg">
using
the
pattern
</ins><code><ins class="diff-chg">
"
</ins></code><strong><ins class="diff-chg">
LITERAL
</ins></strong><code><ins class="diff-chg">
"@
</ins></code><strong><ins class="diff-chg">
LANGUAGE
</ins></strong><ins class="diff-chg">
where
</ins><strong><ins class="diff-chg">
LITERAL
</ins></strong>
is
<del class="diff-old">serialized
to
'_:',
otherwise
</del>
the
<del class="diff-old">turtle
serialization
</del>
<ins class="diff-chg">value
associated
with
the
</ins><code><ins class="diff-chg">
@literal
</ins></code><ins class="diff-chg">
key
and
</ins><strong><ins class="diff-chg">
LANGUAGE
</ins></strong>
is
<del class="diff-old">used.
</del>
<ins class="diff-chg">the
value
associated
with
the
</ins><code><ins class="diff-chg">
@language
</ins></code><ins class="diff-chg">
key.
</ins>
</li>
<li>
<del class="diff-old">Join
all
of
</del>
<ins class="diff-chg">Otherwise,
</ins>
the
<del class="diff-old">adjacent
keys
and
add
them
to
</del>
<ins class="diff-chg">value
is
a
string.
Build
</ins>
the
<del class="diff-old">serialization.
</del>
<a class="tref internalDFN" title="object_string" href="#dfn-object_string">
<ins class="diff-chg">object
string
</ins></a><ins class="diff-chg">
using
the
pattern
</ins><code><ins class="diff-chg">
"
</ins></code><strong><ins class="diff-chg">
LITERAL
</ins></strong><code><ins class="diff-chg">
"
</ins></code><ins class="diff-chg">
where
</ins><strong><ins class="diff-chg">
LITERAL
</ins></strong><ins class="diff-chg">
is
the
value
associated
with
the
current
key.
</ins>
</li>
<li>
<del class="diff-old">Push
</del>
<ins class="diff-chg">If
this
is
</ins>
the
<del class="diff-old">adjacent
keys
onto
</del>
<ins class="diff-chg">second
iteration
of
</ins>
the
<del class="diff-old">key
stack.
</del>
<ins class="diff-chg">loop,
append
a
</ins><code><ins class="diff-chg">
|
</ins></code><ins class="diff-chg">
separator
character
to
the
</ins><a class="tref internalDFN" title="label_serialization" href="#dfn-label_serialization"><ins class="diff-chg">
label
serialization
</ins></a>.
</li>
<li>
<del class="diff-old">Do
SerializeMapping.
</del>
<ins class="diff-chg">Append
the
</ins><a class="tref internalDFN" title="object_string" href="#dfn-object_string"><ins class="diff-chg">
object
string
</ins></a><ins class="diff-chg">
to
the
</ins><a class="tref internalDFN" title="label_serialization" href="#dfn-label_serialization"><ins class="diff-chg">
label
serialization
</ins></a>.
</li>
</ol>
</li>
<del class="diff-old">5.11.10
Label
Generation
Algorithm
NameNode(bnode):
</del>
</ol>
</li>
<li>
<del class="diff-old">Remove
</del>
<ins class="diff-chg">Append
</ins>
the
<del class="diff-old">first
blank
node
from
</del>
<code>
<ins class="diff-chg">]
</ins></code><ins class="diff-chg">
character
to
</ins>
the
<del class="diff-old">list
of
sorted
blank
nodes.
</del>
<a class="tref internalDFN" title="label_serialization" href="#dfn-label_serialization">
<ins class="diff-chg">label
serialization
</ins></a>.
</li>
<li>
<del class="diff-old">Give
it
</del>
<ins class="diff-chg">Append
</ins>
the
<del class="diff-old">next
canonical
name.
</del>
<code>
<ins class="diff-chg">[
</ins></code><ins class="diff-chg">
character
to
the
</ins><a class="tref internalDFN" title="label_serialization" href="#dfn-label_serialization"><ins class="diff-chg">
label
serialization
</ins></a>.
</li>
<li>
<del class="diff-old">Give
canonical
names
</del>
<ins class="diff-chg">Append
all
incoming
references
for
the
current
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-chg">
label
</ins></a>
to
<del class="diff-old">each
blank
node
key
</del>
<ins class="diff-chg">the
</ins><a class="tref internalDFN" title="label_serialization" href="#dfn-label_serialization"><ins class="diff-chg">
label
serialization
</ins></a><ins class="diff-chg">
by
processing
all
of
the
items
associated
with
the
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-chg">
label
</ins></a>
in
<del class="diff-old">its
</del>
<ins class="diff-chg">the
</ins><a class="tref" title="incoming_map"><ins class="diff-chg">
incoming
map
</ins></a>:<ol class="algorithm"><li><ins class="diff-chg">
Build
a
</ins><dfn title="reference_string" id="dfn-reference_string"><ins class="diff-chg">
reference
string
</ins></dfn><ins class="diff-chg">
using
the
pattern
</ins><code><</code><strong><ins class="diff-chg">
PROPERTY
</ins></strong><code><ins class="diff-chg">
>
</ins></code><code><</code><strong><ins class="diff-chg">
REFERER
</ins></strong><code><ins class="diff-chg">
>
</ins></code><ins class="diff-chg">
where
</ins><strong><ins class="diff-chg">
PROPERTY
</ins></strong><ins class="diff-chg">
is
the
</ins>
property
<del class="diff-old">serialization
mapping
</del>
<ins class="diff-chg">associated
with
the
incoming
reference
and
</ins><strong><ins class="diff-chg">
REFERER
</ins></strong><ins class="diff-chg">
is
either
the
subject
of
the
node
referring
to
the
</ins><a class="tref internalDFN" title="label" href="#dfn-label"><ins class="diff-chg">
label
</ins></a>
in
<del class="diff-old">lexicographical
order.
</del>
<ins class="diff-chg">the
incoming
reference
or
</ins><code><ins class="diff-chg">
_:
</ins></code><ins class="diff-chg">
if
</ins><strong><ins class="diff-chg">
REFERER
</ins></strong><ins class="diff-chg">
begins
with
</ins><code><ins class="diff-chg">
_:
</ins></code>.
</li>
<li>
<del class="diff-old">Give
canonical
names
</del>
<ins class="diff-chg">If
this
is
the
second
iteration
of
the
loop,
append
a
</ins><code><ins class="diff-chg">
|
</ins></code><ins class="diff-chg">
separator
character
</ins>
to
<del class="diff-old">each
blank
node
key
in
its
</del>
<ins class="diff-chg">the
</ins><a class="tref internalDFN" title="label_serialization" href="#dfn-label_serialization"><ins class="diff-chg">
label
serialization
</ins></a>.</li><li><ins class="diff-chg">
Append
the
</ins><a class="tref internalDFN" title="reference_string" href="#dfn-reference_string">
reference
<ins class="diff-new">string
</ins></a><ins class="diff-new">
to
the
</ins><a class="tref internalDFN" title="label_serialization" href="#dfn-label_serialization"><ins class="diff-new">
label
</ins>
serialization
<del class="diff-old">mapping
in
lexicographical
order.
</del>
</a>.
</li>
</ol>
</li>
<li>
<del class="diff-old">Set
</del>
<ins class="diff-chg">Append
the
</ins><code><ins class="diff-chg">
]
</ins></code><ins class="diff-chg">
character
to
the
</ins><a class="tref internalDFN" title="label_serialization" href="#dfn-label_serialization"><ins class="diff-chg">
label
serialization
</ins></a>.</li><li><ins class="diff-chg">
Append
</ins>
all
<del class="diff-old">serializations
containing
newly-named
blank
nodes
</del>
<a class="tref internalDFN" title="adjacent_node_labels" href="#dfn-adjacent_node_labels">
<ins class="diff-chg">adjacent
node
labels
</ins></a>
to
<del class="diff-old">null.
</del>
<ins class="diff-chg">the
</ins><a class="tref internalDFN" title="label_serialization" href="#dfn-label_serialization"><ins class="diff-chg">
label
serialization
</ins></a><ins class="diff-chg">
by
concatenating
the
string
value
for
all
of
them,
one
after
the
other,
to
the
</ins><a class="tref internalDFN" title="label_serialization" href="#dfn-label_serialization"><ins class="diff-chg">
label
serialization
</ins></a>.</li><li><ins class="diff-chg">
Push
the
</ins><a class="tref internalDFN" title="adjacent_node_labels" href="#dfn-adjacent_node_labels"><ins class="diff-chg">
adjacent
node
labels
</ins></a><ins class="diff-chg">
onto
the
</ins><a class="tref internalDFN" title="key_stack" href="#dfn-key_stack-1"><ins class="diff-chg">
key
stack
</ins></a><ins class="diff-chg">
and
append
the
result
of
the
</ins><a href="#mapping-serialization-algorithm"><ins class="diff-chg">
Mapping
Serialization
Algorithm
</ins></a><ins class="diff-chg">
to
the
</ins><a class="tref internalDFN" title="label_serialization" href="#dfn-label_serialization"><ins class="diff-chg">
label
serialization
</ins></a>.
</li>
</ol>
</div>
</div>
<div id="data-round-tripping" class="section">
<h3>
<span class="secno">
<del class="diff-old">5.12
</del>
<ins class="diff-chg">6.12
</ins>
</span>
Data
Round
Tripping
</h3>
<p>
When
normalizing
<strong>
xsd:double
</strong>
values,
implementers
<em class="rfc2119" title="must">
must
</em>
ensure
that
the
normalized
value
is
a
string.
In
order
to
generate
the
string
from
a
<strong>
double
</strong>
value,
output
equivalent
to
the
<code>
printf("%1.6e",
value)
</code>
function
in
C
<em class="rfc2119" title="must">
must
</em>
be
used
where
<strong>
"%1.6e"
</strong>
is
the
string
formatter
and
<strong>
value
</strong>
is
the
value
to
be
converted.
</p>
<p>
To
convert
the
a
double
value
in
JavaScript,
implementers
can
use
the
following
snippet
of
code:
</p>
<pre class="example">
// the variable 'value' below is the JavaScript native double value that is to be converted
(value).toExponential(6).replace(/(e(?:\+|-))([0-9])$/,
'$10$2')
</pre>
<p class="note">
When
data
needs
to
be
normalized,
JSON-LD
authors
should
not
use
values
that
are
going
to
undergo
automatic
conversion.
This
is
due
to
the
lossy
nature
of
<strong>
xsd:double
</strong>
values.
</p>
<p class="issue">
Round-tripping
data
can
be
problematic
if
we
mix
and
match
@coerce
rules
with
JSON-native
datatypes,
like
integers.
Consider
the
following
code
example:
</p>
<pre class="example">
var myObj = { "@context" : { 
                "number" : "http://example.com/vocab#number",
                "@coerce": {
                   "xsd:nonNegativeInteger": "number"
                }
              },
              "number" : 42 };
// Map the language-native object to JSON-LD
var jsonldText = jsonld.normalize(myObj);
// Convert the normalized object back to a JavaScript object
var
myObj2
=
jsonld.parse(jsonldText);
</pre>
<p class="issue">
At
this
point,
myObj2
and
myObj
will
have
different
values
for
the
"number"
value.
myObj
will
be
the
number
42,
while
myObj2
will
be
the
string
"42".
This
type
of
data
round-tripping
error
can
bite
developers.
We
are
currently
wondering
if
having
a
"coerce
validation"
phase
in
the
parsing/normalization
phases
would
be
a
good
idea.
It
would
prevent
data
round-tripping
issues
like
the
one
mentioned
above.
</p>
</div>
<div id="rdf-conversion" class="section">
<h3>
<span class="secno">
<del class="diff-old">5.13
</del>
<ins class="diff-chg">6.13
</ins>
</span>
RDF
Conversion
</h3>
<p>
A
JSON-LD
document
<em class="rfc2119" title="may">
may
</em>
be
converted
to
any
other
RDF-compatible
document
format
using
the
algorithm
specified
in
this
section.
</p>
<p>
The
JSON-LD
Processing
Model
describes
processing
rules
for
extracting
RDF
from
a
JSON-LD
document.
Note
that
many
uses
of
JSON-LD
may
not
require
generation
of
RDF.
</p>
<p>
The
processing
algorithm
described
in
this
section
is
provided
in
order
to
demonstrate
how
one
might
implement
a
JSON-LD
to
RDF
processor.
Conformant
implementations
are
only
required
to
produce
the
same
type
and
number
of
triples
during
the
output
process
and
are
not
required
to
implement
the
algorithm
exactly
as
described.
</p>
<p class="issue">
The
RDF
Conversion
Algorithm
is
a
work
in
progress.
</p>
<div class="informative section" id="overview">
<h4>
<span class="secno">
<del class="diff-old">5.13.1
</del>
<ins class="diff-chg">6.13.1
</ins>
</span>
Overview
</h4>
<p>
<em>
This
section
is
non-normative.
</em>
</p>
<p>
JSON-LD
is
intended
to
have
an
easy
to
parse
grammar
that
closely
models
existing
practice
in
using
JSON
for
describing
object
representations.
This
allows
the
use
of
existing
libraries
for
parsing
JSON
in
a
document-oriented
fashion,
or
can
allow
for
stream-based
parsing
similar
to
SAX.
</p>
<p>
As
with
other
grammars
used
for
describing
<a class="tref internalDFN" title="Linked_Data" href="#dfn-linked_data">
Linked
Data
</a>,
a
key
concept
is
that
of
a
<em>
resource
</em>.
Resources
may
be
of
three
basic
types:
<em>
IRI
</em>
s,
for
describing
externally
named
entities,
<em>
BNodes
</em>,
resources
for
which
an
external
name
does
not
exist,
or
is
not
known,
and
Literals,
which
describe
terminal
entities
such
as
strings,
dates
and
other
representations
having
a
lexical
representation
possibly
including
an
explicit
language
or
datatype.
</p>
<p>
Data
described
with
JSON-LD
may
be
considered
to
be
the
representation
of
a
graph
made
up
of
<a class="tref internalDFN" title="subject" href="#dfn-subject">
subject
</a>
and
<a class="tref internalDFN" title="object" href="#dfn-object">
object
</a>
resources
related
via
a
<a class="tref internalDFN" title="property" href="#dfn-property">
property
</a>
resource.
However,
specific
implementations
may
choose
to
operate
on
the
document
as
a
normal
JSON
description
of
objects
having
attributes.
</p>
</div>
<div id="rdf-conversion-algorithm-terms" class="section">
<h4>
<span class="secno">
<del class="diff-old">5.13.2
</del>
<ins class="diff-chg">6.13.2
</ins>
</span>
RDF
Conversion
Algorithm
Terms
</h4>
<dl>
<dt>
<dfn title="default_graph" id="dfn-default_graph">
default
graph
</dfn>
</dt>
<dd>
the
destination
graph
for
all
triples
generated
by
JSON-LD
markup.
</dd>
</dl>
</div>
<div id="rdf-conversion-algorithm" class="section">
<h4>
<span class="secno">
<del class="diff-old">5.13.3
</del>
<ins class="diff-chg">6.13.3
</ins>
</span>
RDF
Conversion
Algorithm
</h4>
<p>
The
algorithm
below
is
designed
for
in-memory
implementations
with
random
access
to
<del class="diff-old">associative
array
</del>
<a class="tref internalDFN" title="JSON_object" href="#dfn-json_object">
<ins class="diff-chg">JSON
object
</ins></a>
elements.
</p>
<p>
A
conforming
JSON-LD
processor
implementing
RDF
conversion
<em class="rfc2119" title="must">
must
</em>
implement
a
processing
algorithm
that
results
in
the
same
<a class="tref internalDFN" title="default_graph" href="#dfn-default_graph">
default
graph
</a>
that
the
following
algorithm
generates:
</p>
<ol class="algorithm">
<li id="processing-step-default-context">
Create
a
new
<a class="tref internalDFN" title="processor_state" href="#dfn-processor_state">
processor
state
</a>
with
with
the
<a class="tref internalDFN" title="active_context" href="#dfn-active_context">
active
context
</a>
set
to
the
<a class="tref internalDFN" title="initial_context" href="#dfn-initial_context">
initial
context
</a>
and
<a class="tref internalDFN" title="active_subject" href="#dfn-active_subject">
active
subject
</a>
and
<a class="tref internalDFN" title="active_property" href="#dfn-active_property">
active
property
</a>
initialized
to
NULL.
</li>
<li id="processing-step-associative">
If
<del class="diff-old">an
associative
array
</del>
<ins class="diff-chg">a
</ins><a class="tref internalDFN" title="JSON_object" href="#dfn-json_object"><ins class="diff-chg">
JSON
object
</ins></a>
is
detected,
perform
the
following
steps:
<ol class="algorithm">
<li>
If
the
<del class="diff-old">associative
array
</del>
<a class="tref internalDFN" title="JSON_object" href="#dfn-json_object">
<ins class="diff-chg">JSON
object
</ins></a>
has
a
<code>
@context
</code>
key,
process
the
local
context
as
described
in
<a href="#context">
Context
</a>.
</li>
<li>
Create
a
new
<del class="diff-old">associative
array
</del>
<a class="tref internalDFN" title="JSON_object" href="#dfn-json_object">
<ins class="diff-chg">JSON
object
</ins></a>
by
mapping
the
keys
from
the
current
<del class="diff-old">associative
array
</del>
<a class="tref internalDFN" title="JSON_object" href="#dfn-json_object">
<ins class="diff-chg">JSON
object
</ins></a>
using
the
<a class="tref internalDFN" title="active_context" href="#dfn-active_context">
active
context
</a>
to
new
keys
using
the
associated
value
from
the
current
<del class="diff-old">associative
array.
</del>
<a class="tref internalDFN" title="JSON_object" href="#dfn-json_object">
<ins class="diff-chg">JSON
object
</ins></a>.
Repeat
the
mapping
until
no
entry
is
found
within
the
<a class="tref internalDFN" title="active_context" href="#dfn-active_context">
active
context
</a>
for
the
key.
Use
the
new
<del class="diff-old">associative
array
</del>
<a class="tref internalDFN" title="JSON_object" href="#dfn-json_object">
<ins class="diff-chg">JSON
object
</ins></a>
in
subsequent
steps.
</li>
<li>
If
the
<del class="diff-old">associative
array
</del>
<a class="tref internalDFN" title="JSON_object" href="#dfn-json_object">
<ins class="diff-chg">JSON
object
</ins></a>
has
an
<code>
@iri
</code>
key,
set
the
<a class="tref internalDFN" title="active_object" href="#dfn-active_object">
active
object
</a>
by
performing
<a href="#iri-expansion">
IRI
Expansion
</a>
on
the
associated
value.
Generate
a
triple
representing
the
<a class="tref internalDFN" title="active_subject" href="#dfn-active_subject">
active
subject
</a>,
the
<a class="tref internalDFN" title="active_property" href="#dfn-active_property">
active
property
</a>
and
the
<a class="tref internalDFN" title="active_object" href="#dfn-active_object">
active
object
</a>.
Return
the
<a class="tref internalDFN" title="active_object" href="#dfn-active_object">
active
object
</a>
to
the
calling
location.
<p class="issue">
<code>
@iri
</code>
really
just
behaves
the
same
as
<code>
@subject
</code>,
consider
consolidating
them.
</p>
</li>
<li>
If
the
<del class="diff-old">associative
array
</del>
<a class="tref internalDFN" title="JSON_object" href="#dfn-json_object">
<ins class="diff-chg">JSON
object
</ins></a>
has
a
<code>
@literal
</code>
key,
set
the
<a class="tref internalDFN" title="active_object" href="#dfn-active_object">
active
object
</a>
to
a
literal
value
as
follows:
<ol class="algorithm">
<li>
as
a
<a class="tref internalDFN" title="typed_literal" href="#dfn-typed_literal">
typed
literal
</a>
if
the
<del class="diff-old">associative
array
</del>
<a class="tref internalDFN" title="JSON_object" href="#dfn-json_object">
<ins class="diff-chg">JSON
object
</ins></a>
contains
a
<code>
@datatype
</code>
key
after
performing
<a href="#iri-expansion">
IRI
Expansion
</a>
on
the
specified
<code>
@datatype
</code>.
</li>
<li>
otherwise,
as
a
<a class="tref internalDFN" title="plain_literal" href="#dfn-plain_literal">
plain
literal
</a>.
If
the
<del class="diff-old">associative
array
</del>
<a class="tref internalDFN" title="JSON_object" href="#dfn-json_object">
<ins class="diff-chg">JSON
object
</ins></a>
contains
a
<code>
@language
</code>
key,
use
it's
value
to
set
the
language
of
the
plain
literal.
</li>
<li>
Generate
a
triple
representing
the
<a class="tref internalDFN" title="active_subject" href="#dfn-active_subject">
active
subject
</a>,
the
<a class="tref internalDFN" title="active_property" href="#dfn-active_property">
active
property
</a>
and
the
<a class="tref internalDFN" title="active_object" href="#dfn-active_object">
active
object
</a>.
Return
the
<a class="tref internalDFN" title="active_object" href="#dfn-active_object">
active
object
</a>
to
the
calling
location.
</li>
</ol>
</li>
<li id="processing-step-subject">
If
the
<del class="diff-old">associative
array
</del>
<a class="tref internalDFN" title="JSON_object" href="#dfn-json_object">
<ins class="diff-chg">JSON
object
</ins></a>
has
a
<code>
@subject
</code>
key:
<ol class="algorithm">
<li>
If
the
value
is
a
<del class="diff-old">string,
</del>
<a class="tref internalDFN" title="string" href="#dfn-string">
<ins class="diff-chg">string
</ins></a>,
set
the
<a class="tref internalDFN" title="active_object" href="#dfn-active_object">
active
object
</a>
to
the
result
of
performing
<a href="#iri-expansion">
IRI
Expansion
</a>.
Generate
a
triple
representing
the
<a class="tref internalDFN" title="active_subject" href="#dfn-active_subject">
active
subject
</a>,
the
<a class="tref internalDFN" title="active_property" href="#dfn-active_property">
active
property
</a>
and
the
<a class="tref internalDFN" title="active_object" href="#dfn-active_object">
active
object
</a>.
Set
the
<a class="tref internalDFN" title="active_subject" href="#dfn-active_subject">
active
subject
</a>
to
the
<a class="tref internalDFN" title="active_object" href="#dfn-active_object">
active
object
</a>.
</li>
<li>
Create
a
new
<a class="tref internalDFN" title="processor_state" href="#dfn-processor_state">
processor
state
</a>
using
copies
of
the
<a class="tref internalDFN" title="active_context" href="#dfn-active_context">
active
context
</a>,
<a class="tref internalDFN" title="active_subject" href="#dfn-active_subject">
active
subject
</a>
and
<a class="tref internalDFN" title="active_property" href="#dfn-active_property">
active
property
</a>
and
process
the
value
starting
at
<a href="#processing-step-associative">
Step
2
</a>,
set
the
<a class="tref" title="active__subject">
active
subject
</a>
to
the
result
and
proceed
using
the
previous
<a class="tref internalDFN" title="processor_state" href="#dfn-processor_state">
processor
state
</a>.
</li>
</ol>
</li>
<li>
If
the
<del class="diff-old">associative
array
</del>
<a class="tref internalDFN" title="JSON_object" href="#dfn-json_object">
<ins class="diff-chg">JSON
object
</ins></a>
does
not
have
a
<code>
@subject
</code>
key,
set
the
<a class="tref" title="active__object">
active
object
</a>
to
newly
generated
<dfn title="blank_node_identifier" id="dfn-blank_node_identifier">
blank
node
identifier
</dfn>.
Generate
a
triple
representing
the
<a class="tref internalDFN" title="active_subject" href="#dfn-active_subject">
active
subject
</a>,
the
<a class="tref internalDFN" title="active_property" href="#dfn-active_property">
active
property
</a>
and
the
<a class="tref internalDFN" title="active_object" href="#dfn-active_object">
active
object
</a>.
Set
the
<a class="tref internalDFN" title="active_subject" href="#dfn-active_subject">
active
subject
</a>
to
the
<a class="tref" title="active__object">
active
object
</a>.
</li>
<li>
For
each
key
in
the
<del class="diff-old">associative
array
</del>
<a class="tref internalDFN" title="JSON_object" href="#dfn-json_object">
<ins class="diff-chg">JSON
object
</ins></a>
that
has
not
already
been
processed,
perform
the
following
steps:
<ol class="algorithm">
<li>
If
the
key
is
<code>
@type
</code>,
set
the
<a class="tref internalDFN" title="active_property" href="#dfn-active_property">
active
property
</a>
to
<code>
rdf:type
</code>.
</li>
<li>
Otherwise,
set
the
<a class="tref internalDFN" title="active_property" href="#dfn-active_property">
active
property
</a>
to
the
result
of
performing
<a href="#iri-expansion">
IRI
Expansion
</a>
on
the
key.
</li>
<li>
Create
a
new
<a class="tref internalDFN" title="processor_state" href="#dfn-processor_state">
processor
state
</a>
copies
of
the
<a class="tref internalDFN" title="active_context" href="#dfn-active_context">
active
context
</a>,
<a class="tref internalDFN" title="active_subject" href="#dfn-active_subject">
active
subject
</a>
and
<a class="tref internalDFN" title="active_property" href="#dfn-active_property">
active
property
</a>
and
process
the
value
starting
at
<a href="#processing-step-associative">
Step
2
</a>
and
proceed
using
the
previous
<a class="tref internalDFN" title="processor_state" href="#dfn-processor_state">
processor
state
</a>.
</li>
</ol>
</li>
<li>
Return
the
<a class="tref internalDFN" title="active_object" href="#dfn-active_object">
active
object
</a>
to
the
calling
location.
</li>
</ol>
</li>
<li>
If
a
regular
<a class="tref internalDFN" title="array" href="#dfn-array">
array
</a>
is
detected,
process
each
value
in
the
<a class="tref internalDFN" title="array" href="#dfn-array">
array
</a>
by
doing
the
following
returning
the
result
of
processing
the
last
value
in
the
<del class="diff-old">array:
</del>
<a class="tref internalDFN" title="array" href="#dfn-array">
<ins class="diff-chg">array
</ins></a>:
<ol class="algorithm">
<li>
Create
a
new
<a class="tref internalDFN" title="processor_state" href="#dfn-processor_state">
processor
state
</a>
using
copies
of
the
<a class="tref" title="active__context">
active
context
</a>,
<a class="tref internalDFN" title="active_subject" href="#dfn-active_subject">
active
subject
</a>
and
<a class="tref internalDFN" title="active_property" href="#dfn-active_property">
active
property
</a>
and
process
the
value
starting
at
<a href="#processing-step-associative">
Step
2
</a>
then
proceed
using
the
previous
<a class="tref internalDFN" title="processor_state" href="#dfn-processor_state">
processor
state
</a>.
</li>
</ol>
</li>
<li>
If
a
<a class="tref internalDFN" title="string" href="#dfn-string">
string
</a>
is
detected:
<ol class="algorithm">
<li>
If
the
<a class="tref internalDFN" title="active_property" href="#dfn-active_property">
active
property
</a>
is
the
target
of
a
<code>
@iri
</code>
coercion,
set
the
<a class="tref internalDFN" title="active_object" href="#dfn-active_object">
active
object
</a>
by
performing
<a href="#iri-expansion">
IRI
Expansion
</a>
on
the
string.
</li>
<li>
Otherwise,
if
the
<a class="tref internalDFN" title="active_property" href="#dfn-active_property">
active
property
</a>
is
the
target
of
coercion,
set
the
<a class="tref internalDFN" title="active_object" href="#dfn-active_object">
active
object
</a>
by
creating
a
<a class="tref internalDFN" title="typed_literal" href="#dfn-typed_literal">
typed
literal
</a>
using
the
string
and
the
coercion
key
as
the
datatype
IRI.
</li>
<li>
Otherwise,
set
the
<a class="tref internalDFN" title="active_object" href="#dfn-active_object">
active
object
</a>
to
a
<a class="tref internalDFN" title="plain_literal" href="#dfn-plain_literal">
plain
literal
</a>
value
created
from
the
string.
</li>
</ol>
Generate
a
triple
representing
the
<a class="tref internalDFN" title="active_subject" href="#dfn-active_subject">
active
subject
</a>,
the
<a class="tref internalDFN" title="active_property" href="#dfn-active_property">
active
property
</a>
and
the
<a class="tref internalDFN" title="active_object" href="#dfn-active_object">
active
object
</a>.
</li>
<li>
If
a
<a class="tref internalDFN" title="number" href="#dfn-number">
number
</a>
is
detected,
generate
a
<a class="tref internalDFN" title="typed_literal" href="#dfn-typed_literal">
typed
literal
</a>
using
a
string
representation
of
the
value
with
datatype
set
to
either
<code>
xsd:integer
</code>
or
<code>
xsd:double
</code>,
depending
on
if
the
value
contains
a
fractional
and/or
an
exponential
component.
Generate
a
triple
using
the
<a class="tref" title="active__subject">
active
subject
</a>,
<a class="tref internalDFN" title="active_property" href="#dfn-active_property">
active
property
</a>
and
the
generated
typed
literal.
</li>
<li>
Otherwise,
if
<strong>
true
</strong>
or
<strong>
false
</strong>
is
detected,
generate
a
triple
using
the
<a class="tref internalDFN" title="active_subject" href="#dfn-active_subject">
active
subject
</a>,
<a class="tref internalDFN" title="active_property" href="#dfn-active_property">
active
property
</a>
and
a
<a class="tref internalDFN" title="typed_literal" href="#dfn-typed_literal">
typed
literal
</a>
value
created
from
the
string
representation
of
the
value
with
datatype
set
to
<code>
xsd:boolean
</code>.
</li>
</ol>
</div>
</div>
</div>
<div id="experimental-concepts" class="section">
<h2>
<span class="secno">
<del class="diff-old">6.
</del>
<ins class="diff-chg">7.
</ins>
</span>
Experimental
Concepts
</h2>
<p class="issue">
There
are
a
few
advanced
concepts
where
it
is
not
clear
whether
or
not
the
JSON-LD
specification
is
going
to
support
the
complexity
necessary
to
support
each
concept.
The
entire
section
on
Advanced
Concepts
should
be
considered
as
discussion
points;
it
is
merely
a
list
of
possibilities
where
all
of
the
benefits
and
drawbacks
have
not
been
explored.
</p>
<div id="disjoint-graphs" class="section">
<h3>
<span class="secno">
<del class="diff-old">6.1
</del>
<ins class="diff-chg">7.1
</ins>
</span>
Disjoint
Graphs
</h3>
<p>
When
serializing
an
RDF
graph
that
contains
two
or
more
sections
of
the
graph
which
are
entirely
disjoint,
one
must
use
an
<a class="tref internalDFN" title="array" href="#dfn-array">
array
</a>
to
express
the
graph
as
two
graphs.
This
may
not
be
acceptable
to
some
authors,
who
would
rather
express
the
information
as
one
graph.
Since,
by
definition,
disjoint
graphs
require
there
to
be
two
top-level
objects,
JSON-LD
utilizes
a
mechanism
that
allows
disjoint
graphs
to
be
expressed
using
a
single
graph.
</p>
<p>
Assume
the
following
RDF
graph:
</p>
<pre class="example">
&lt;http://example.org/people#john&gt; 
   &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt;
      &lt;http://xmlns.com/foaf/0.1/Person&gt; .
&lt;http://example.org/people#jane&gt; 
   &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt;
&lt;http://xmlns.com/foaf/0.1/Person&gt;
.
</pre>
<p>
Since
the
two
subjects
are
entirely
disjoint
with
one
another,
it
is
impossible
to
express
the
RDF
graph
above
using
a
single
<del class="diff-old">JSON-LD
associative
array.
</del>
<a class="tref internalDFN" title="JSON_object" href="#dfn-json_object">
<ins class="diff-chg">JSON
object
</ins></a>.
</p>
<p>
In
JSON-LD,
one
can
use
the
subject
to
express
disjoint
graphs
as
a
single
graph:
</p>
<pre class="example">
{
<del class="diff-old">  "@coerce": {
    "foaf": "http://xmlns.com/foaf/0.1/"
</del>
<ins class="diff-chg">  "@context": {
    "Person": "http://xmlns.com/foaf/0.1/Person"
</ins>
  },
  "@subject": 
  [
    {
      "@subject": "http://example.org/people#john",
<del class="diff-old">      "@type": "foaf:Person"
</del>
<ins class="diff-chg">      "@type": "Person"
</ins>
    },
    {
      "@subject": "http://example.org/people#jane",
<del class="diff-old">      "@type": "foaf:Person"
</del>
<ins class="diff-chg">      "@type": "Person"
</ins>
    }
  ]
}
</pre>
<p>
A
disjoint
graph
could
also
be
expressed
like
so:
</p>
<pre class="example">
[
  {
    "@subject": "http://example.org/people#john",
    "@type": "http://xmlns.com/foaf/0.1/Person"
  },
  {
    "@subject": "http://example.org/people#jane",
    "@type": "http://xmlns.com/foaf/0.1/Person"
  }
]
</pre>
</div>
<div id="lists" class="section">
<h3>
<span class="secno">
<del class="diff-old">6.2
</del>
<ins class="diff-chg">7.2
</ins>
</span>
Lists
</h3>
<p>
Because
graphs
do
not
describe
ordering
for
links
between
nodes,
multi-valued
properties
in
JSON
do
not
provide
an
ordering
of
the
listed
objects.
For
example,
consider
the
following
simple
document:
</p>
  <pre class="example">
{
...
  "@subject": "http://example.org/people#joebob",
<del class="diff-old">  "foaf:nick": ,
</del>
<ins class="diff-chg">  "nick": <span class="diff">["joe", "bob", "jaybee"]</span>,
</ins>
...
}
</pre>
<p>
This
results
in
three
triples
being
generated,
each
relating
the
subject
to
an
individual
object,
with
no
inherent
order.
To
address
this
issue,
RDF-based
languages,
such
as
[
<cite>
<a class="bibref" rel="biblioentry" href="#bib-TURTLE">
TURTLE
</a>
</cite>
]
use
the
concept
of
an
<code>
rdf:List
</code>
(as
described
in
[
<cite>
<a class="bibref" rel="biblioentry" href="#bib-RDF-SCHEMA">
RDF-SCHEMA
</a>
</cite>
]).
This
uses
a
sequence
of
unlabeled
nodes
with
properties
describing
a
value,
a
null-terminated
next
property.
Without
specific
syntactical
support,
this
could
be
represented
in
JSON-LD
as
follows:
</p>
  <pre class="example">
{
...
  "@subject": "http://example.org/people#joebob",
<del class="diff-old">  "foaf:nick": ,
</del>
<ins class="diff-chg">  "nick": <span class="diff">{</span>,
</ins>
    <span class="diff">"@first": "joe"</span>,
    <span class="diff">"@rest": {</span>
      <span class="diff">"@first": "bob"</span>,
      <span class="diff">"@rest": {</span>
        <span class="diff">"@first": "jaybee"</span>,
        <span class="diff">"@rest": "@nil"</span>
        <span class="diff">}</span>
      <span class="diff">}</span>
    <span class="diff">}</span>
  <span class="diff">}</span>,
...
}
</pre>
<p>
As
this
notation
is
rather
unwieldy
and
the
notion
of
ordered
collections
is
rather
important
in
data
modeling,
it
is
useful
to
have
specific
language
support.
In
JSON-LD,
a
list
may
be
represented
using
the
<code>
@list
</code>
keyword
as
follows:
</p>
  <pre class="example">
{
...
  "@subject": "http://example.org/people#joebob",
  "foaf:nick": <span class="diff">{"@list": ["joe", "bob", "jaybee"]}</span>,
...
}
</pre>
<p>
This
describes
the
use
of
this
<a class="tref internalDFN" title="array" href="#dfn-array">
array
</a>
as
being
ordered,
and
order
is
maintained
through
normalization
and
RDF
conversion.
If
every
use
of
a
given
multi-valued
property
is
a
list,
this
may
be
abbreviated
by
adding
an
<code>
@coerce
</code>
term:
</p>
  <pre class="example">
{
  <span class="diff">"@context": {</span>
    ...
    <span class="diff">"@context": {</span>
      <span class="diff">"@list": ["foaf:nick"]</span>
    <span class="diff">}</span>
  <span class="diff">}</span>,
...
  "@subject": "http://example.org/people#joebob",
  "foaf:nick": <span class="diff">["joe", "bob", "jaybee"]</span>,
...
}
</pre>
<div id="expansion-2" class="section">
<h4 id="list-expansion">
<span class="secno">
<del class="diff-old">6.2.1
</del>
<ins class="diff-chg">7.2.1
</ins>
</span>
Expansion
</h4>
<p class="issue">
TBD.
</p>
</div>
<div id="normalization-2" class="section">
<h4 id="list-normalization">
<span class="secno">
<del class="diff-old">6.2.2
</del>
<ins class="diff-chg">7.2.2
</ins>
</span>
Normalization
</h4>
<p class="issue">
TBD.
</p>
</div>
<div id="rdf-conversion-1" class="section">
<h4 id="list-rdf">
<span class="secno">
<del class="diff-old">6.2.3
</del>
<ins class="diff-chg">7.2.3
</ins>
</span>
RDF
Conversion
</h4>
<p>
To
support
RDF
Conversion
of
lists,
<a href="#rdf-conversion-algorithm">
RDF
Conversion
Algorithm
</a>
is
updated
as
follows:
</p>
<ol class="algorithm update">
<li>
<span class="list-number">
2.4a.
</span>
If
the
<del class="diff-old">associative
array
</del>
<a class="tref internalDFN" title="JSON_object" href="#dfn-json_object">
<ins class="diff-chg">JSON
object
</ins></a>
has
a
<code>
@list
</code>
key
and
the
value
is
an
<a class="tref internalDFN" title="array" href="#dfn-array">
array
</a>
process
the
value
as
a
list
starting
at
<a href="#processing-step-list">
Step
3a
</a>.
</li>
<li>
<span class="list-number">
2.7.3.
</span>
Create
a
new
<a class="tref internalDFN" title="processor_state" href="#dfn-processor_state">
processor
state
</a>
copies
of
the
<a class="tref internalDFN" title="active_context" href="#dfn-active_context">
active
context
</a>,
<a class="tref internalDFN" title="active_subject" href="#dfn-active_subject">
active
subject
</a>
and
<a class="tref internalDFN" title="active_property" href="#dfn-active_property">
active
property
</a>.
<ol class="algorithm">
<li>
If
the
<a class="tref internalDFN" title="active_property" href="#dfn-active_property">
active
property
</a>
is
the
target
of
a
<code>
@list
</code>
coercion,
and
the
value
is
an
<del class="diff-old">array,
</del>
<a class="tref internalDFN" title="array" href="#dfn-array">
<ins class="diff-chg">array
</ins></a>,
process
the
value
as
a
list
starting
at
<a href="#processing-step-list">
Step
3a
</a>.
</li>
<li>
Otherwise,
process
the
value
starting
at
<a href="#processing-step-associative">
Step
2
</a>.
</li>
<li>
Proceed
using
the
previous
<a class="tref internalDFN" title="processor_state" href="#dfn-processor_state">
processor
state
</a>.
</li>
</ol>
</li>
<li id="processing-step-list">
<span class="list-number">
3a.
</span>
Generate
an
RDF
List
by
linking
each
element
of
the
list
using
<code>
rdf:first
</code>
and
<code>
rdf:next
</code>,
terminating
the
list
with
<code>
rdf:nil
</code>
using
the
following
sequence:
<ol class="algorithm">
<li>
If
the
list
has
no
element,
generate
a
triple
using
the
<a class="tref internalDFN" title="active_subject" href="#dfn-active_subject">
active
subject
</a>,
<a class="tref internalDFN" title="active_property" href="#dfn-active_property">
active
property
</a>
and
<code>
rdf:nil
</code>.
</li>
<li>
Otherwise,
generate
a
triple
using
using
the
<a class="tref internalDFN" title="active_subject" href="#dfn-active_subject">
active
subject
</a>,
<a class="tref internalDFN" title="active_property" href="#dfn-active_property">
active
property
</a>
and
a
newly
generated
BNode
identified
as
<em>
first
<dfn title="blank_node_identifier" id="dfn-blank_node_identifier-1">
blank
node
identifier
</dfn>
</em>.
</li>
<li>
For
each
element
other
than
the
last
element
in
the
list:
<ol class="algorithm">
<li>
Create
a
processor
state
using
the
active
context,
<em>
first
<dfn title="blank_node_identifier" id="dfn-blank_node_identifier-2">
blank
node
identifier
</dfn>
</em>
as
the
<a class="tref internalDFN" title="active_subject" href="#dfn-active_subject">
active
subject
</a>,
and
<code>
rdf:first
</code>
as
the
<a class="tref internalDFN" title="active_property" href="#dfn-active_property">
active
property
</a>.
</li>
<li>
Unless
this
is
the
last
element
in
the
list,
generate
a
new
BNode
identified
as
<em>
rest
<dfn title="blank_node_identifier" id="dfn-blank_node_identifier-3">
blank
node
identifier
</dfn>
</em>,
otherwise
use
<code>
rdf:nil
</code>.
</li>
<li>
Generate
a
new
triple
using
<em>
first
<dfn title="blank_node_identifier" id="dfn-blank_node_identifier-4">
blank
node
identifier
</dfn>
</em>,
<code>
rdf:rest
</code>
and
<em>
rest
<dfn title="blank_node_identifier" id="dfn-blank_node_identifier-5">
blank
node
identifier
</dfn>
</em>.
</li>
<li>
Set
<em>
first
<dfn title="blank_node_identifier" id="dfn-blank_node_identifier-6">
blank
node
identifier
</dfn>
</em>
to
<em>
rest
<dfn title="blank_node_identifier" id="dfn-blank_node_identifier-7">
blank
node
identifier
</dfn>
</em>.
</li>
</ol>
</li>
</ol>
</li>
</ol>
</div>
</div>
</div>
<div class="appendix section" id="markup-examples">
<h2>
<span class="secno">
A.
</span>
Markup
Examples
</h2>
<p>
The
JSON-LD
markup
examples
below
demonstrate
how
JSON-LD
can
be
used
to
express
semantic
data
marked
up
in
other
languages
such
as
RDFa,
Microformats,
and
Microdata.
These
sections
are
merely
provided
as
proof
that
JSON-LD
is
very
flexible
in
what
it
can
express
across
different
Linked
Data
approaches.
</p>
<div id="rdfa" class="section">
<h3>
<span class="secno">
A.1
</span>
RDFa
</h3>
<p>
The
following
example
describes
three
people
with
their
respective
names
and
homepages.
</p>
<pre class="example">
&lt;div <span class="diff">prefix="foaf: http://xmlns.com/foaf/0.1/"</span>&gt;
   &lt;ul&gt;
      &lt;li <span class="diff">typeof="foaf:Person"</span>&gt;
        &lt;a <span class="diff">rel="foaf:homepage" href="http://example.com/bob/" property="foaf:name" </span>&gt;Bob&lt;/a&gt;
      &lt;/li&gt;
      &lt;li <span class="diff">typeof="foaf:Person"</span>&gt;
        &lt;a <span class="diff">rel="foaf:homepage" href="http://example.com/eve/" property="foaf:name" </span>&gt;Eve&lt;/a&gt;
      &lt;/li&gt;
      &lt;li <span class="diff">typeof="foaf:Person"</span>&gt;
        &lt;a <span class="diff">rel="foaf:homepage" href="http://example.com/manu/" property="foaf:name" </span>&gt;Manu&lt;/a&gt;
      &lt;/li&gt;
   &lt;/ul&gt;
&lt;/div&gt;
</pre>
<p>
An
example
JSON-LD
implementation
is
described
below,
however,
there
are
other
ways
to
mark-up
this
information
such
that
the
context
is
not
repeated.
</p>
<pre class="example">
{
  "@context": { "foaf": "http://xmlns.com/foaf/0.1/"},
  "@subject": [
   {
     "@subject": "_:bnode1",
     "@type": "foaf:Person",
     "foaf:homepage": "http://example.com/bob/",
     "foaf:name": "Bob"
   },
   {
     "@subject": "_:bnode2",
     "@type": "foaf:Person",
     "foaf:homepage": "http://example.com/eve/",
     "foaf:name": "Eve"
   },
   {
     "@subject": "_:bnode3",
     "@type": "foaf:Person",
     "foaf:homepage": "http://example.com/manu/",
     "foaf:name": "Manu"
   }
  ]
}
</pre>
</div>
<div id="microformats" class="section">
<h3>
<span class="secno">
A.2
</span>
Microformats
</h3>
<p>
The
following
example
uses
a
simple
Microformats
hCard
example
to
express
how
the
Microformat
is
represented
in
JSON-LD.
</p>
<pre class="example">
&lt;div class="vcard"&gt;
 &lt;a class="url fn" href="http://tantek.com/"&gt;Tantek Çelik&lt;/a&gt;
&lt;/div&gt;
</pre>
<p>
The
representation
of
the
hCard
expresses
the
Microformat
terms
in
the
context
and
uses
them
directly
for
the
<code>
url
</code>
and
<code>
fn
</code>
properties.
Also
note
that
the
Microformat
to
JSON-LD
processor
has
generated
the
proper
URL
type
for
<code>
http://tantek.com
</code>.
</p>
<pre class="example">
{
  "@context": 
  {
    "vcard": "http://microformats.org/profile/hcard#vcard",
    "url": "http://microformats.org/profile/hcard#url",
    "fn": "http://microformats.org/profile/hcard#fn",
    "@coerce": { "xsd:anyURI": "url" }
  },
  "@subject": "_:bnode1",
  "@type": "vcard",
  "url": "http://tantek.com/",
  "fn": "Tantek Çelik"
}
</pre>
</div>
<div id="microdata" class="section">
<h3>
<span class="secno">
A.3
</span>
Microdata
</h3>
<p>
The
Microdata
example
below
expresses
book
information
as
a
Microdata
Work
item.
</p>
<pre class="example">
&lt;dl itemscope
    itemtype="http://purl.org/vocab/frbr/core#Work"
    itemid="http://purl.oreilly.com/works/45U8QJGZSQKDH8N"&gt;
 &lt;dt&gt;Title&lt;/dt&gt;
 &lt;dd&gt;&lt;cite itemprop="http://purl.org/dc/terms/title"&gt;Just a Geek&lt;/cite&gt;&lt;/dd&gt;
 &lt;dt&gt;By&lt;/dt&gt;
 &lt;dd&gt;&lt;span itemprop="http://purl.org/dc/terms/creator"&gt;Wil Wheaton&lt;/span&gt;&lt;/dd&gt;
 &lt;dt&gt;Format&lt;/dt&gt;
 &lt;dd itemprop="http://purl.org/vocab/frbr/core#realization"
     itemscope
     itemtype="http://purl.org/vocab/frbr/core#Expression"
     itemid="http://purl.oreilly.com/products/9780596007683.BOOK"&gt;
  &lt;link itemprop="http://purl.org/dc/terms/type" href="http://purl.oreilly.com/product-types/BOOK"&gt;
  Print
 &lt;/dd&gt;
 &lt;dd itemprop="http://purl.org/vocab/frbr/core#realization"
     itemscope
     itemtype="http://purl.org/vocab/frbr/core#Expression"
     itemid="http://purl.oreilly.com/products/9780596802189.EBOOK"&gt;
  &lt;link itemprop="http://purl.org/dc/terms/type" href="http://purl.oreilly.com/product-types/EBOOK"&gt;
  Ebook
 &lt;/dd&gt;
&lt;/dl&gt;
</pre>
<p>
Note
that
the
JSON-LD
representation
of
the
Microdata
information
stays
true
to
the
desires
of
the
Microdata
community
to
avoid
contexts
and
instead
refer
to
items
by
their
full
IRI.
</p>
<pre class="example">
[
  {
    "@subject": "http://purl.oreilly.com/works/45U8QJGZSQKDH8N",
    "@type": "http://purl.org/vocab/frbr/core#Work",
    "http://purl.org/dc/terms/title": "Just a Geek",
    "http://purl.org/dc/terms/creator": "Whil Wheaton",
    "http://purl.org/vocab/frbr/core#realization": 
      ["http://purl.oreilly.com/products/9780596007683.BOOK", "http://purl.oreilly.com/products/9780596802189.EBOOK"]
  },
  {
    "@subject": "http://purl.oreilly.com/products/9780596007683.BOOK",
    "@type": "http://purl.org/vocab/frbr/core#Expression",
    "http://purl.org/dc/terms/type": "http://purl.oreilly.com/product-types/BOOK"
  },
  {
    "@subject": "http://purl.oreilly.com/products/9780596802189.EBOOK",
    "@type": "http://purl.org/vocab/frbr/core#Expression",
    "http://purl.org/dc/terms/type": "http://purl.oreilly.com/product-types/EBOOK"
  }
]
</pre>
</div>
<div class="appendix section" id="mashing-up-vocabularies">
<h3>
<span class="secno">
A.4
</span>
Mashing
Up
Vocabularies
</h3>
<p>
Developers
would
also
benefit
by
allowing
other
vocabularies
to
be
used
automatically
with
their
JSON
API.
There
are
over
200
Vocabulary
Documents
that
are
available
for
use
on
the
Web
today.
Some
of
these
vocabularies
are:
</p>
<ul>
<li>
RDF
-
for
describing
information
about
objects
on
the
semantic
web.
</li>
<li>
RDFS
-
for
expressing
things
like
labels
and
comments.
</li>
<li>
XSD
-
for
specifying
basic
types
like
strings,
integers,
dates
and
times.
</li>
<li>
Dublin
Core
-
for
describing
creative
works.
</li>
<li>
FOAF
-
for
describing
social
networks.
</li>
<li>
Calendar
-
for
specifying
events.
</li>
<li>
SIOC
-
for
describing
discussions
on
blogs
and
websites.
</li>
<li>
CCrel
-
for
describing
Creative
Commons
and
other
types
of
licenses.
</li>
<li>
GEO
-
for
describing
geographic
location.
</li>
<li>
VCard
-
for
describing
organizations
and
people.
</li>
<li>
DOAP
-
for
describing
projects.
</li>
</ul>
<p>
You
can
use
these
vocabularies
in
combination,
like
so:
</p>
<pre class="example">
{
  "<span class="diff">@type</span>": "<span class="diff">foaf:Person</span>",
  "<span class="diff">foaf:name</span>": "Manu Sporny",
  "<span class="diff">foaf:homepage</span>": "http://manu.sporny.org/",
  "<span class="diff">sioc:avatar</span>": "http://twitter.com/account/profile_image/manusporny"
}
</pre>
<p>
Developers
can
also
specify
their
own
Vocabulary
documents
by
modifying
the
<a class="tref internalDFN" title="active_context" href="#dfn-active_context">
active
context
</a>
in-line
using
the
<code>
@context
</code>
keyword,
like
so:
</p>
<pre class="example">
{
  <span class="diff">"@context": { "myvocab": "http://example.org/myvocab#" }</span>,
  "@type": "foaf:Person",
  "foaf:name": "Manu Sporny",
  "foaf:homepage": "http://manu.sporny.org/",
  "sioc:avatar": "http://twitter.com/account/profile_image/manusporny"<span class="diff">,
  "myvocab:personality": "friendly"</span>
}
</pre>
<p>
The
<code>
@context
</code>
keyword
is
used
to
change
how
the
JSON-LD
processor
evaluates
key-value
pairs.
In
this
case,
it
was
used
to
map
one
string
('myvocab')
to
another
string,
which
is
interpreted
as
a
<a class="tref internalDFN" title="IRI" href="#dfn-iri">
IRI
</a>.
In
the
example
above,
the
<code>
myvocab
</code>
string
is
replaced
with
"
<code>
http://example.org/myvocab#
</code>
"
when
it
is
detected.
In
the
example
above,
"
<code>
myvocab:personality
</code>
"
would
expand
to
"
<code>
http://example.org/myvocab#personality
</code>
".
</p>
<p>
This
mechanism
is
a
short-hand
for
RDF,
called
a
<del class="diff-old">CURIE,
</del>
<a class="tref internalDFN" title="CURIE" href="#dfn-curie">
<ins class="diff-chg">CURIE
</ins></a>,
and
provides
developers
an
unambiguous
way
to
map
any
JSON
value
to
RDF.
</p>
<p>
</p>
</div>
<div class="appendix section" id="acknowledgements">
<h3>
<span class="secno">
A.5
</span>
Acknowledgements
</h3>
<p>
The
editors
would
like
to
thank
Mark
Birbeck,
who
provided
a
great
deal
of
the
initial
push
behind
the
JSON-LD
work
via
his
work
on
RDFj,
Dave
Longley,
Dave
Lehn
and
Mike
Johnson
who
reviewed,
provided
feedback,
and
performed
several
implementations
of
the
specification,
and
Ian
Davis,
who
created
RDF/JSON.
Thanks
also
to
Nathan
Rixham,
Bradley
P.
Allen,
Kingsley
Idehen,
Glenn
McDonald,
Alexandre
Passant,
Danny
Ayers,
Ted
Thibodeau
Jr.,
Olivier
Grisel,
Niklas
Lindström,
Markus
Lanthaler,
and
Richard
Cyganiak
for
their
input
on
the
specification.
Another
huge
thank
you
goes
out
to
Dave
Longley
who
designed
many
of
the
algorithms
used
in
this
specification,
including
the
normalization
algorithm
which
was
a
monumentally
difficult
design
challenge.
</p>
</div>
</div>
<div id="references" class="appendix section">
<h2>
<span class="secno">
B.
</span>
References
</h2>
<div id="normative-references" class="section">
<h3>
<span class="secno">
B.1
</span>
Normative
references
</h3>
<dl class="bibliography">
<dt id="bib-BCP47">
[BCP47]
</dt>
<dd>
A.
Phillips,
M.
Davis.
<a href="http://tools.ietf.org/rfc/bcp/bcp47.txt">
<cite>
Tags
for
Identifying
Languages
</cite>
</a>
September
2009.
IETF
Best
Current
Practice.
URL:
<a href="http://tools.ietf.org/rfc/bcp/bcp47.txt">
http://tools.ietf.org/rfc/bcp/bcp47.txt
</a>
</dd>
<dt id="bib-RDF-CONCEPTS">
[RDF-CONCEPTS]
</dt>
<dd>
Graham
Klyne;
Jeremy
J.
Carroll.
<a href="http://www.w3.org/TR/2004/REC-rdf-concepts-20040210">
<cite>
Resource
Description
Framework
(RDF):
Concepts
and
Abstract
Syntax.
</cite>
</a>
10
February
2004.
W3C
Recommendation.
URL:
<a href="http://www.w3.org/TR/2004/REC-rdf-concepts-20040210">
http://www.w3.org/TR/2004/REC-rdf-concepts-20040210
</a>
</dd>
<dt id="bib-RFC3986">
[RFC3986]
</dt>
<dd>
T.
Berners-Lee;
R.
Fielding;
L.
Masinter.
<a href="http://www.ietf.org/rfc/rfc3986.txt">
<cite>
Uniform
Resource
Identifier
(URI):
Generic
Syntax.
</cite>
</a>
January
2005.
Internet
RFC
3986.
URL:
<a href="http://www.ietf.org/rfc/rfc3986.txt">
http://www.ietf.org/rfc/rfc3986.txt
</a>
</dd>
<dt id="bib-RFC3987">
[RFC3987]
</dt>
<dd>
M.
Dürst;
M.
Suignard.
<a href="http://www.ietf.org/rfc/rfc3987.txt">
<cite>
Internationalized
Resource
Identifiers
(IRIs).
</cite>
</a>
January
2005.
Internet
RFC
3987.
URL:
<a href="http://www.ietf.org/rfc/rfc3987.txt">
http://www.ietf.org/rfc/rfc3987.txt
</a>
</dd>
<dt id="bib-RFC4627">
[RFC4627]
</dt>
<dd>
D.
Crockford.
<a href="http://www.ietf.org/rfc/rfc4627.txt">
<cite>
The
application/json
Media
Type
for
JavaScript
Object
Notation
(JSON)
</cite>
</a>
July
2006.
Internet
RFC
4627.
URL:
<a href="http://www.ietf.org/rfc/rfc4627.txt">
http://www.ietf.org/rfc/rfc4627.txt
</a>
</dd>
<dt id="bib-WEBIDL">
[WEBIDL]
</dt>
<dd>
Cameron
McCormack.
<a href="http://www.w3.org/TR/2008/WD-WebIDL-20081219">
<cite>
Web
IDL.
</cite>
</a>
19
December
2008.
W3C
Working
Draft.
(Work
in
progress.)
URL:
<a href="http://www.w3.org/TR/2008/WD-WebIDL-20081219">
http://www.w3.org/TR/2008/WD-WebIDL-20081219
</a>
</dd>
</dl>
</div>
<div id="informative-references" class="section">
<h3>
<span class="secno">
B.2
</span>
Informative
references
</h3>
<dl class="bibliography">
<dt id="bib-ECMA-262">
[ECMA-262]
</dt>
<dd>
<a href="http://www.ecma-international.org/publications/standards/Ecma-262.htm">
<cite>
ECMAScript
Language
Specification,
Third
Edition.
</cite>
</a>
December
1999.
URL:
<a href="http://www.ecma-international.org/publications/standards/Ecma-262.htm">
http://www.ecma-international.org/publications/standards/Ecma-262.htm
</a>
</dd>
<dt id="bib-MICRODATA">
[MICRODATA]
</dt>
<dd>
Ian
Hickson;
et
al.
<a href="http://www.w3.org/TR/microdata/">
<cite>
Microdata
</cite>
</a>
04
March
2010.
W3C
Working
Draft.
URL:
<a href="http://www.w3.org/TR/microdata/">
http://www.w3.org/TR/microdata/
</a>
</dd>
<dt id="bib-MICROFORMATS">
[MICROFORMATS]
</dt>
<dd>
<a href="http://microformats.org">
<cite>
Microformats
</cite>
</a>.
URL:
<a href="http://microformats.org">
http://microformats.org
</a>
</dd>
<dt id="bib-RDF-SCHEMA">
[RDF-SCHEMA]
</dt>
<dd>
Dan
Brickley;
Ramanathan
V.
Guha.
<a href="http://www.w3.org/TR/2004/REC-rdf-schema-20040210">
<cite>
RDF
Vocabulary
Description
Language
1.0:
RDF
Schema.
</cite>
</a>
10
February
2004.
W3C
Recommendation.
URL:
<a href="http://www.w3.org/TR/2004/REC-rdf-schema-20040210">
http://www.w3.org/TR/2004/REC-rdf-schema-20040210
</a>
</dd>
<dt id="bib-RDFA-CORE">
[RDFA-CORE]
</dt>
<dd>
Shane
McCarron;
et
al.
<a href="http://www.w3.org/TR/2011/WD-rdfa-core-20110331">
<cite>
RDFa
Core
1.1:
Syntax
and
processing
rules
for
embedding
RDF
through
attributes.
</cite>
</a>
31
March
2011.
W3C
Working
Draft.
URL:
<a href="http://www.w3.org/TR/2011/WD-rdfa-core-20110331">
http://www.w3.org/TR/2011/WD-rdfa-core-20110331
</a>
</dd>
<dt id="bib-TURTLE">
[TURTLE]
</dt>
<dd>
David
Beckett,
Tim
Berners-Lee.
<a href="http://www.w3.org/TeamSubmission/turtle/">
<cite>
Turtle:
Terse
RDF
Triple
Language.
</cite>
</a>
January
2008.
W3C
Team
Submission.
URL:
<a href="http://www.w3.org/TeamSubmission/turtle/">
http://www.w3.org/TeamSubmission/turtle/
</a>
</dd>
</dl>
</div>
</div>
</body>
</html>
